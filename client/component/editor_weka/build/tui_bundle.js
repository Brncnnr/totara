(()=>{var e={nHbi:(e,t,n)=>{var i={"./Weka":"jMGS","./Weka.vue":"jMGS","./attachments/AudioAttachment":"x9sE","./attachments/AudioAttachment.vue":"x9sE","./attachments/FileAttachment":"XG7o","./attachments/FileAttachment.vue":"XG7o","./attachments/ImageAttachment":"n1eA","./attachments/ImageAttachment.vue":"n1eA","./attachments/VideoAttachment":"yZJe","./attachments/VideoAttachment.vue":"yZJe","./directives":"pkZy","./directives.js":"pkZy","./editing/ActionDropdown":"HCCQ","./editing/ActionDropdown.vue":"HCCQ","./editing/EditImageAltTextModal":"5RZn","./editing/EditImageAltTextModal.vue":"5RZn","./editing/EditLinkModal":"tcZm","./editing/EditLinkModal.vue":"tcZm","./editing/EmojiSelector":"qU2U","./editing/EmojiSelector.vue":"qU2U","./editing/PositionedActionDropdown":"RvTg","./editing/PositionedActionDropdown.vue":"RvTg","./editing/graphics/layout_icons_24/LayoutCol1":"JRrw","./editing/graphics/layout_icons_24/LayoutCol1.vue":"JRrw","./editing/graphics/layout_icons_24/LayoutCol2":"AQC4","./editing/graphics/layout_icons_24/LayoutCol2.vue":"AQC4","./editing/graphics/layout_icons_24/LayoutCol2NarrowLeft":"w6BJ","./editing/graphics/layout_icons_24/LayoutCol2NarrowLeft.vue":"w6BJ","./editing/graphics/layout_icons_24/LayoutCol2NarrowRight":"7zT1","./editing/graphics/layout_icons_24/LayoutCol2NarrowRight.vue":"7zT1","./editing/graphics/layout_icons_24/LayoutCol3":"Xhlp","./editing/graphics/layout_icons_24/LayoutCol3.vue":"Xhlp","./editing/graphics/layout_icons_24/LayoutIconBase":"Nmbj","./editing/graphics/layout_icons_24/LayoutIconBase.vue":"Nmbj","./marks/Link":"l4/9","./marks/Link.vue":"l4/9","./node_menu":"LcYg","./node_menu/":"LcYg","./node_menu/NodeMenu":"cCDf","./node_menu/NodeMenu.vue":"cCDf","./node_menu/NodeMenuActionDropdown":"v7xS","./node_menu/NodeMenuActionDropdown.vue":"v7xS","./node_menu/NodeMenuButton":"KGWr","./node_menu/NodeMenuButton.vue":"KGWr","./node_menu/NodeMenuGroup":"FphW","./node_menu/NodeMenuGroup.vue":"FphW","./node_menu/NodeMenuMoreDropdown":"y8/K","./node_menu/NodeMenuMoreDropdown.vue":"y8/K","./node_menu/index":"LcYg","./node_menu/index.js":"LcYg","./nodes/Attachment":"u5KH","./nodes/Attachment.vue":"u5KH","./nodes/Attachments":"Tmk0","./nodes/Attachments.vue":"Tmk0","./nodes/AudioBlock":"OOfW","./nodes/AudioBlock.vue":"OOfW","./nodes/BaseNode":"Uzaj","./nodes/BaseNode.vue":"Uzaj","./nodes/Emoji":"uoDY","./nodes/Emoji.vue":"uoDY","./nodes/FigureCaption":"isp3","./nodes/FigureCaption.vue":"isp3","./nodes/Hashtag":"g3qL","./nodes/Hashtag.vue":"g3qL","./nodes/ImageBlock":"MlBL","./nodes/ImageBlock.vue":"MlBL","./nodes/LayoutBlock":"TYzV","./nodes/LayoutBlock.vue":"TYzV","./nodes/LayoutColumn":"4Gjm","./nodes/LayoutColumn.vue":"4Gjm","./nodes/LinkBlock":"hI7e","./nodes/LinkBlock.vue":"hI7e","./nodes/LinkMedia":"7vMz","./nodes/LinkMedia.vue":"7vMz","./nodes/Mention":"8tBG","./nodes/Mention.vue":"8tBG","./nodes/VideoBlock":"6a0+","./nodes/VideoBlock.vue":"6a0+","./suggestion/Hashtag":"b2jB","./suggestion/Hashtag.vue":"b2jB","./suggestion/User":"hR3b","./suggestion/User.vue":"hR3b","./toolbar/NodeBar":"bVvI","./toolbar/NodeBar.vue":"bVvI","./toolbar/Toolbar":"ZGde","./toolbar/Toolbar.vue":"ZGde","./toolbar/ToolbarButton":"fd9w","./toolbar/ToolbarButton.vue":"fd9w","./toolbar/ToolbarButtonIcon":"o0F/","./toolbar/ToolbarButtonIcon.vue":"o0F/","./upload/ExtraFileUploadModal":"QT84","./upload/ExtraFileUploadModal.vue":"QT84","./upload/FilePicker":"Qpfd","./upload/FilePicker.vue":"Qpfd"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=a,e.exports=o,o.id="nHbi"},fC82:(e,t,n)=>{var i={"./ComponentView":"b8P3","./ComponentView.js":"b8P3","./Editor":"NBUY","./Editor.js":"NBUY","./WekaValue":"OUqJ","./WekaValue.js":"OUqJ","./api":"cvQ+","./api.js":"cvQ+","./extensions/Base":"8h8O","./extensions/Base.js":"8h8O","./extensions/alignment":"cYZH","./extensions/alignment.js":"cYZH","./extensions/attachment":"RKiH","./extensions/attachment.js":"RKiH","./extensions/emoji":"VIvA","./extensions/emoji.js":"VIvA","./extensions/hashtag":"3N9S","./extensions/hashtag.js":"3N9S","./extensions/layout":"ZSGL","./extensions/layout.js":"ZSGL","./extensions/link":"xZEP","./extensions/link.js":"xZEP","./extensions/list":"0NKw","./extensions/list.js":"0NKw","./extensions/media":"m5uz","./extensions/media.js":"m5uz","./extensions/mention":"RvdS","./extensions/mention.js":"RvdS","./extensions/ruler":"ZpWW","./extensions/ruler.js":"ZpWW","./extensions/text":"Rd9k","./extensions/text.js":"Rd9k","./extensions/util":"E057","./extensions/util.js":"E057","./helpers/ExtrasNodeTracker":"cMqc","./helpers/ExtrasNodeTracker.js":"cMqc","./helpers/editor":"aWHr","./helpers/editor.js":"aWHr","./helpers/file":"Ww+o","./helpers/file.js":"Ww+o","./helpers/media":"/N6l","./helpers/media.js":"/N6l","./helpers/mention":"IjPG","./helpers/mention.js":"IjPG","./helpers/suggestion":"zy7P","./helpers/suggestion.js":"zy7P","./integration":"N6D1","./integration.js":"N6D1","./interface":"26pK","./interface.js":"26pK","./keymap":"2XWw","./keymap.js":"2XWw","./lib/prosemirror_schema_list/schema_list":"wAp3","./lib/prosemirror_schema_list/schema_list.js":"wAp3","./lib/prosemirror_utils/helpers":"uZzl","./lib/prosemirror_utils/helpers.js":"uZzl","./lib/prosemirror_utils/selection":"kAdn","./lib/prosemirror_utils/selection.js":"kAdn","./lib/prosemirror_utils/transforms":"5nM4","./lib/prosemirror_utils/transforms.js":"5nM4","./mixins/attachment_mixin":"lquI","./mixins/attachment_mixin.js":"lquI","./plugins/attachment":"Sgz4","./plugins/attachment.js":"Sgz4","./plugins/cursor_inside_node":"UvVU","./plugins/cursor_inside_node.js":"UvVU","./plugins/emoji":"//CD","./plugins/emoji.js":"//CD","./plugins/hashtag":"ewWi","./plugins/hashtag.js":"ewWi","./plugins/mention":"YVk/","./plugins/mention.js":"YVk/","./plugins/text_placeholder":"8Tor","./plugins/text_placeholder.js":"8Tor","./schema":"7AVa","./schema.js":"7AVa","./toolbar":"895m","./toolbar.js":"895m","./transaction":"ZSGX","./transaction.js":"ZSGX","./util":"zENn","./util.js":"zENn","./utils/list":"TXPb","./utils/list.js":"TXPb","./utils/upload":"eqTj","./utils/upload.js":"eqTj"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=a,e.exports=o,o.id="fC82"},B9Lp:(e,t,n)=>{var i={"./WekaIntegration":"PtUQ","./WekaIntegration.vue":"PtUQ","./fixtures/WekaBasic":"rAqx","./fixtures/WekaBasic.vue":"rAqx","./fixtures/WekaWithLearn":"7Pbl","./fixtures/WekaWithLearn.vue":"7Pbl"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=a,e.exports=o,o.id="B9Lp"},fZmM:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_get_draft_file"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"item_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filename"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"file"},name:{kind:"Name",value:"editor_weka_draft_file"},arguments:[{kind:"Argument",name:{kind:"Name",value:"item_id"},value:{kind:"Variable",name:{kind:"Name",value:"item_id"}}},{kind:"Argument",name:{kind:"Name",value:"filename"},value:{kind:"Variable",name:{kind:"Name",value:"filename"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file_size"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mime_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"force_download"},value:{kind:"BooleanValue",value:!1}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"download_url"},name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"force_download"},value:{kind:"BooleanValue",value:!0}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"media_type"},arguments:[],directives:[]}]}}]}}]}},gQ1V:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_get_repository_data"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"repository_data"},name:{kind:"Name",value:"editor_weka_repository_data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repository_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"max_bytes"},arguments:[],directives:[]}]}}]}}]}},jMGS:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});var i=n("7mX8"),o=n.n(i),a=n("U0bO"),r=n("yQz/"),s=n.n(r),l=n("NBUY");const d=tui.require("tui/components/editor/EditorLoading");var c=n.n(d);const u=tui.require("editor_weka/components/toolbar/Toolbar");var p=n.n(u),m=n("xIDV");const h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_weka"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"variant_name"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_alphaext"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extra_extensions"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"editor"},name:{kind:"Name",value:"editor_weka_editor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"usage_identifier"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"ObjectField",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"extensions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"usage_identifier"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"ObjectField",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"variant_name"},value:{kind:"Variable",name:{kind:"Name",value:"variant_name"}}},{kind:"Argument",name:{kind:"Name",value:"extra_extensions"},value:{kind:"Variable",name:{kind:"Name",value:"extra_extensions"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tuicomponent"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]}]}}]}}]},_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_weka_nosession"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"variant_name"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_alphaext"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extra_extensions"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"editor"},name:{kind:"Name",value:"editor_weka_editor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"usage_identifier"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"ObjectField",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"extensions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"usage_identifier"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"ObjectField",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"variant_name"},value:{kind:"Variable",name:{kind:"Name",value:"variant_name"}}},{kind:"Argument",name:{kind:"Name",value:"extra_extensions"},value:{kind:"Variable",name:{kind:"Name",value:"extra_extensions"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tuicomponent"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]}]}}]}}]};var f=n("Ww+o"),g=n("OUqJ");const v=tui.require("tui/vue_util"),k=(e,t)=>JSON.stringify(t)==JSON.stringify(e),w=e=>(0,v.createImmutablePropWatcher)("Weka",e,k),y={components:{EditorLoading:c(),Toolbar:p()},props:{placeholder:{type:String,default:""},fileItemId:[Number,String],contextId:[Number,String],usageIdentifier:{type:Object,validator:e=>"component"in e&&"area"in e,default:()=>({component:"editor_weka",area:"learn"})},variant:String,options:{type:Object,validator:e=>void 0!==e.extensions},value:g.default,compact:Boolean,stickyToolbar:{type:Boolean,default:!0},isLoggedIn:{type:Boolean,default:!0},extraExtensions:{type:Array,validator:e=>e.every((e=>"string"==typeof e||"name"in e))},disabled:Boolean,ariaLabel:String,ariaLabelledby:String,ariaDescribedby:String,ariaInvalid:String},data:()=>({toolbarItems:[],ready:!1}),computed:{showToolbar(){return!this.compact&&this.toolbarItems.length>0},variantUsageIdentifierCombo(){return[this.variant,this.usageIdentifier]},computedExtraExtensions(){return this.extraExtensions?this.extraExtensions.map((e=>"string"==typeof e?{name:e}:e)):null}},watch:{value(e){this.displayedValue!==e&&(this.displayedValue=e||g.default.empty(),this.editor&&this.editor.setValue(this.displayedValue))},variant:w("variant"),options:w("options"),extraExtensions:w("extraExtensions"),fileItemId(e){this.editor&&this.isLoggedIn&&this.editor.updateFileItemId(e)},disabled(e){this.editor&&(this.editor.setEditable(!e),this.editor.view&&(this.updateToolbar(),this.editor.forceRerenderView()))}},created(){this.updateToolbarThrottled=(0,a.throttle)(this.updateToolbar,100),this.value?this.displayedValue=this.value:this.displayedValue=g.default.empty(),this.finalOptions=null,this.$watch("variantUsageIdentifierCombo",(()=>{this.options||!this.usageIdentifier||this.variant||console.warn('[Weka] Passing usage-identifier without variant (which will construct a variant from usage-identifier) was deprecated in Totara 17. Please update your code to pass a variant explicitly (e.g. variant="standard") as in a future release, variant will default to "standard" even when usage-identifier is passed.')}),{immediate:!0})},mounted(){this.createEditor()},beforeDestroy(){this.editor&&this.editor.destroy()},methods:{async setupOptions(){if(this.options)return void(this.finalOptions=Object.assign({},this.options));const e=await this.$apollo.query({query:this.isLoggedIn?h:_,fetchPolicy:"no-cache",variables:{instance_id:this.usageIdentifier.instanceId,component:this.usageIdentifier.component,area:this.usageIdentifier.area,context_id:this.contextId||void 0,extra_extensions:this.computedExtraExtensions?JSON.stringify(this.computedExtraExtensions):void 0,variant_name:this.variant||`${this.usageIdentifier.component}-${this.usageIdentifier.area}`}});this.finalOptions=Object.assign({},e.data.editor)},async getExtensions(){await this.setupOptions();let e=[];return Array.isArray(this.finalOptions.extensions)&&(e=await Promise.all(this.finalOptions.extensions.map((({tuicomponent:e,options:t})=>{let n={};return null!=t&&(n="object"==typeof t?t:JSON.parse(t)),o().import(e).then((e=>o().defaultExport(e)(n)))})))),e},async createEditor(){if(this.editor)return;let e=s()("weka");const t=await this.getExtensions();let n=new f.default({itemId:this.fileItemId,contextId:this.finalOptions.context_id||null});this.editor=new l.default({value:this.displayedValue,placeholder:this.placeholder,parent:this,extensions:t,fileStorage:n,onUpdate:this.$_onUpdate.bind(this),contextId:this.finalOptions.context_id||null,component:this.usageIdentifier.component||null,area:this.usageIdentifier.area||null,instanceId:this.usageIdentifier.instanceId||null,ariaLabel:this.ariaLabel,ariaLabelledby:this.ariaLabelledby,ariaDescribedby:this.ariaDescribedby,ariaInvalid:this.ariaInvalid,editable:()=>!this.disabled,onTransaction:()=>{this.updateToolbarThrottled()},onFocus:e=>{this.$emit("focus",e)},onBlur:e=>{this.$emit("blur",e)}});const i=this.editor.allVueComponents();await Promise.all([o().loadRequirements({components:i}),(0,m.loadLangStrings)(this.editor.allStrings())]),this.ready=!0,await this.$nextTick(),this.editor.setElements({viewExtras:this.$refs.extras,viewExtrasLive:this.$refs.extrasLive}),this.view=this.editor.createView(this.$refs.editorHost),this.updateToolbar(),e(),this.$emit("ready")},updateToolbar(){this.editor.destroyed||(this.toolbarItems=this.editor.getToolbarItems())},$_onUpdate(e){this.displayedValue=e,this.$emit("input",e)}}};var b=(0,n("wWJ2").Z)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.ready?n("div",{directives:[{name:"focus-within",rawName:"v-focus-within"}],staticClass:"tui-weka no-yui-ids",attrs:{id:e.uid}},[e.showToolbar?n("Toolbar",{attrs:{items:e.toolbarItems,sticky:e.stickyToolbar}}):e._e(),e._v(" "),n("div",{ref:"editorHost",staticClass:"tui-weka__editorHost tui-rendered",attrs:{"data-placeholder":e.placeholder}}),e._v(" "),n("div",{ref:"extras"}),e._v(" "),n("div",{ref:"extrasLive",attrs:{"aria-live":"polite",role:"status"}})],1):n("EditorLoading",{attrs:{id:e.uid,compact:e.compact}})}),[],!1,null,null,null);b.options.__hasBlocks={script:!0,template:!0};const x=b.exports},x9sE:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var i=n("ZkHI"),o=n.n(i),a=n("oFnQ"),r=n.n(a),s=n("VmD8"),l=n.n(s);const d={components:{AttachmentNode:o(),NodeBar:r()},mixins:[l()],props:{enableConvert:{type:Boolean,default:!0}},computed:{actions(){let e=[];return this.enableConvert&&e.push({label:this.$str("display_as_embedded_media","editor_weka"),action:()=>{this.$emit("convert-to-embedded-media")}}),e=e.concat([{label:this.$str("remove","core"),action:()=>{this.$emit("delete")}}]),this.hasDownloadUrl&&e.push({label:this.$str("download","core"),action:()=>{this.$emit("download")}}),e}}},c=function(e){e.options.__langStrings={core:["remove","download"],editor_weka:["display_as_embedded_media","actions_menu_for"]}};var u=(0,n("wWJ2").Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AttachmentNode",{attrs:{filename:e.filename,"file-size":e.fileSize,"item-id":e.draftId,component:"user",area:"draft"}}),e._v(" "),e.disabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)}),[],!1,null,null,null);c(u),u.options.__hasBlocks={script:!0,template:!0};const p=u.exports},XG7o:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var i=n("ZkHI"),o=n.n(i),a=n("oFnQ"),r=n.n(a),s=n("VmD8"),l=n.n(s);const d={components:{AttachmentNode:o(),NodeBar:r()},mixins:[l()],computed:{actions(){let e=[{label:this.$str("remove","core"),action:()=>{this.$emit("delete")}}];return this.hasDownloadUrl&&e.push({label:this.$str("download","core"),action:()=>{this.$emit("download")}}),e}}},c=function(e){e.options.__langStrings={core:["remove","download"],editor_weka:["actions_menu_for"]}};var u=(0,n("wWJ2").Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AttachmentNode",{attrs:{filename:e.filename,"file-size":e.fileSize,"item-id":e.draftId,component:"user",area:"draft"}}),e._v(" "),e.disabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)}),[],!1,null,null,null);c(u),u.options.__hasBlocks={script:!0,template:!0};const p=u.exports},n1eA:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var i=n("ZkHI"),o=n.n(i),a=n("oFnQ"),r=n.n(a),s=n("VmD8"),l=n.n(s);const d={components:{AttachmentNode:o(),NodeBar:r()},mixins:[l()],props:{enableConvert:{type:Boolean,default:!0}},data:()=>({showModal:!1}),computed:{actions(){let e=[];return this.enableConvert&&e.push({label:this.$str("display_as_embedded_media","editor_weka"),action:()=>{this.$emit("convert-to-embedded-media")}}),e=e.concat([{label:this.$str("remove","core"),action:()=>{this.$emit("delete")}}]),this.hasDownloadUrl&&e.push({label:this.$str("download","core"),action:()=>{this.$emit("download")}}),e}}},c=function(e){e.options.__langStrings={core:["download","remove"],editor_weka:["display_as_embedded_media","actions_menu_for"]}};var u=(0,n("wWJ2").Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AttachmentNode",{attrs:{filename:e.filename,"file-size":e.fileSize,component:"user",area:"draft","item-id":e.draftId}}),e._v(" "),e.disabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)}),[],!1,null,null,null);c(u),u.options.__hasBlocks={script:!0,template:!0};const p=u.exports},yZJe:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var i=n("ZkHI"),o=n.n(i),a=n("oFnQ"),r=n.n(a),s=n("VmD8"),l=n.n(s);const d={components:{NodeBar:r(),AttachmentNode:o()},mixins:[l()],props:{enableConvert:{type:Boolean,default:!0}},computed:{actions(){let e=[];return this.enableConvert&&e.push({label:this.$str("display_as_embedded_media","editor_weka"),action:()=>{this.$emit("convert-to-embedded-media")}}),e=e.concat([{label:this.$str("remove","core"),action:()=>{this.$emit("delete")}}]),this.hasDownloadUrl&&e.push({label:this.$str("download","core"),action:()=>{this.$emit("download")}}),e}}},c=function(e){e.options.__langStrings={editor_weka:["display_as_embedded_media","actions_menu_for"],core:["remove","download"]}};var u=(0,n("wWJ2").Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AttachmentNode",{attrs:{filename:e.filename,"file-size":e.fileSize,"item-id":e.draftId,component:"user",area:"draft"}}),e._v(" "),e.disabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)}),[],!1,null,null,null);c(u),u.options.__hasBlocks={script:!0,template:!0};const p=u.exports},HCCQ:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var i=n("3NWB"),o=n.n(i),a=n("DS3U"),r=n.n(a);const s={components:{Dropdown:o(),DropdownButton:r()},props:{position:String,open:Boolean,actions:Array,contextMode:String}};var l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dropdown",{attrs:{position:e.position,open:e.open,"context-mode":e.contextMode},on:{dismiss:function(t){return e.$emit("dismiss")}},scopedSlots:e._u([{key:"trigger",fn:function(t){return[e._t("trigger",null,null,t)]}}],null,!0)},[e._v(" "),e._t("dropdown-items",(function(){return e._l(e.actions,(function(t,i){return n("DropdownButton",{key:i,on:{click:function(e){return e.preventDefault(),t.action()}}},[n("div",{staticClass:"tui-editor_weka-actionDropdown__dropdownItemContent"},[t.iconComponent?n("div",{staticClass:"tui-editor_weka-actionDropdown__dropdownItemIcon"},[n(t.iconComponent,{tag:"component"})],1):e._e(),e._v("\n        "+e._s(t.label)+"\n      ")])])}))}))],2)}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};const d=l.exports},"5RZn":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var i=n("ApK1"),o=n.n(i),a=n("IACo"),r=n.n(a),s=n("GLpC"),l=n.n(s),d=n("IgBQ"),c=n.n(d),u=n("eHBv"),p=n.n(u),m=n("IpiT"),h=n.n(m),_=n("ddQy"),f=n.n(_);const g={components:{Modal:r(),ModalContent:l(),Form:o(),InputText:c(),ButtonGroup:p(),Button:h(),ButtonCancel:f()},props:{value:String},data(){return{innerValue:this.value}},computed:{modalTitle(){return this.value?this.$str("edit_image_alt_text","editor_weka"):this.$str("add_image_alt_text","editor_weka")}},mounted(){this.$nextTick((()=>{this.$refs.altTextRef&&this.$refs.altTextRef.$el&&this.$refs.altTextRef.$el.focus()}))},methods:{confirm(){this.$emit("change",this.innerValue)}}},v=function(e){e.options.__langStrings={editor_weka:["add_image_alt_text","edit_image_alt_text","done","image_alt_help"]}};var k=(0,n("wWJ2").Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"tui-wekaEditImageAltTextModal",attrs:{"aria-labelledby":e.$id("title"),dismissable:{backdropClick:!1}}},[n("ModalContent",{staticClass:"tui-wekaEditImageAltTextModal__content",attrs:{title:e.modalTitle,"title-id":e.$id("title")}},[n("Form",{attrs:{"input-width":"full"},on:{submit:function(t){return t.preventDefault(),e.confirm.apply(null,arguments)}}},[n("div",{staticClass:"tui-wekaEditImageAltTextModal__input"},[n("InputText",{ref:"altTextRef",attrs:{maxlength:120,"char-length":"full",autofocus:!0},model:{value:e.innerValue,callback:function(t){e.innerValue=t},expression:"innerValue"}}),e._v(" "),n("p",{staticClass:"tui-wekaEditImageAltTextModal__input-helpText"},[e._v("\n          "+e._s(e.$str("image_alt_help","editor_weka"))+"\n        ")])],1),e._v(" "),n("ButtonGroup",{staticClass:"tui-wekaEditImageAltTextModal__buttonGroup"},[n("Button",{attrs:{disabled:!e.innerValue,styleclass:{primary:"true"},text:e.$str("done","editor_weka")},on:{click:e.confirm}}),e._v(" "),n("ButtonCancel",{on:{click:function(t){return t.preventDefault(),e.$emit("request-close")}}})],1)],1)],1)],1)}),[],!1,null,null,null);v(k),k.options.__hasBlocks={script:!0,template:!0};const w=k.exports},tcZm:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>S});var i=n("Aely"),o=n.n(i),a=n("ApK1"),r=n.n(a),s=n("2XTD"),l=n.n(s),d=n("IgBQ"),c=n.n(d);const u=tui.require("tui/components/form/Checkbox");var p=n.n(u),m=n("IACo"),h=n.n(m),_=n("GLpC"),f=n.n(_),g=n("IpiT"),v=n.n(g),k=n("ddQy"),w=n.n(k),y=n("eHBv"),b=n.n(y);const x={components:{Form:r(),FormRow:l(),InputText:c(),Checkbox:p(),Modal:h(),ModalContent:f(),Button:v(),ButtonCancel:w(),ButtonGroup:b()},props:{isNew:Boolean,attrs:Object,save:Function,isMedia:Function},data:function(){return{openInNewWindow:this.attrs.open_in_new_window,url:this.attrs.url,text:this.attrs.text,loading:!1,display:this.attrs.type||"link",wasText:!!this.attrs.text,error:null}},computed:{urlIsMedia(){return this.isMedia&&this.isMedia(this.url)},formValue(){return{type:this.display,url:this.url,text:this.text,open_in_new_window:this.openInNewWindow}},formValid(){return!!this.url}},watch:{urlIsMedia(e){this.wasText||(this.display=e?"link_media":"link")},formValue(){this.error=null},openInNewWindow(e){!0===e&&(this.text?this.text=this.$str("opens_in_new_windowx","editor_weka",this.text):this.text=this.$str("opens_in_new_windowx","editor_weka",this.url))}},mounted(){o().nextTick((()=>{this.$refs.url&&this.$refs.url.$el&&this.$refs.url.$el.focus()}))},methods:{close(){this.$emit("request-close")},confirm(){if(this.loading)return;this.loading=!0;const e=this.formValue;e.url=this.fixUrl(e.url),Promise.resolve(this.save(e)).then(this.close).catch((e=>{console.error(e)})).then((()=>this.loading=!1))},updateText(e){this.text=e},fixUrl(e){try{new URL(e)}catch(t){return e.startsWith("/")||e.startsWith("#")?e:`http://${e}`}return e}}},N=function(e){e.options.__langStrings={core:["cancel","ok"],editor:["linkurl"],editor_weka:["done","displayas","display_text","edit_link_label","insert_link_label","error_no_url_info","open_in_new_window","opens_in_new_windowx"]}};var I=(0,n("wWJ2").Z)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{size:"normal","aria-labelledby":e.$id("title"),dismissable:{backdropClick:!1}}},[n("ModalContent",{attrs:{title:e.isNew?e.$str("insert_link_label","editor_weka"):e.$str("edit_link_label","editor_weka"),"title-id":e.$id("title"),"close-button":!0},scopedSlots:e._u([{key:"buttons",fn:function(){return[n("ButtonGroup",[n("Button",{attrs:{styleclass:{primary:"true"},text:e.$str("done","editor_weka"),disabled:!e.formValid||e.loading},on:{click:e.confirm}}),e._v(" "),n("ButtonCancel",{on:{click:e.close}})],1)]},proxy:!0}])},[n("Form",{attrs:{"input-width":"full"},on:{submit:function(t){return t.preventDefault(),e.confirm.apply(null,arguments)}}},[e.error?n("p",[e._v(e._s(e.error))]):e._e(),e._v(" "),n("FormRow",{attrs:{label:e.$str("linkurl","editor")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("InputText",{ref:"url",attrs:{id:i,autofocus:!0},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})]}}])}),e._v(" "),n("FormRow",{attrs:{label:e.$str("display_text","editor_weka")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("InputText",{attrs:{id:i,value:"link"==e.display?e.text:"",disabled:"link"!=e.display},on:{input:e.updateText}})]}}])}),e._v(" "),e.urlIsMedia?e._e():n("FormRow",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("Checkbox",{attrs:{id:i},model:{value:e.openInNewWindow,callback:function(t){e.openInNewWindow=t},expression:"openInNewWindow"}},[e._v("\n          "+e._s(e.$str("open_in_new_window","editor_weka"))+"\n        ")])]}}],null,!1,3837602781)}),e._v(" "),n("input",{style:{display:"none"},attrs:{type:"submit"}})],1)],1)],1)}),[],!1,null,null,null);N(I),I.options.__hasBlocks={script:!0,template:!0};const S=I.exports},qU2U:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var i=n("1+j7"),o=n.n(i),a=n("+Hsq"),r=n.n(a);const s={components:{ButtonIcon:o(),Emoji:r()},props:{emojis:{type:Array,required:!0,validator:e=>e.every((e=>"shortcode"in e))}},methods:{select(e){this.$emit("emoji-selected",e)},fromShortCode:e=>String.fromCodePoint("0x"+e)}};var l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaEmojiSelector"},e._l(e.emojis,(function(t,i){return n("ButtonIcon",{key:i,attrs:{styleclass:{stealth:!0},"aria-label":e.fromShortCode(t.shortcode)},nativeOn:{click:function(n){return e.select(t)}}},[n("Emoji",{staticClass:"tui-wekaEmojiSelector__emoji",attrs:{"short-code":t.shortcode}})],1)})),1)}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};const d=l.exports},RvTg:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("xZv7");const o={components:{ActionDropdown:n.n(i)()},props:{location:{type:Object,validator:e=>"x"in e&&"y"in e},actions:Array},computed:{wrapperStyle(){return{position:"absolute",left:this.location.x+"px",top:this.location.y+"px"}}}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:e.wrapperStyle},[n("ActionDropdown",{attrs:{actions:e.actions,open:!0},on:{dismiss:function(t){return e.$emit("dismiss")}},scopedSlots:e._u([{key:"trigger",fn:function(t){return[e._t("trigger",null,null,t)]}}],null,!0)})],1)}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},JRrw:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("6tNc");const o={components:{LayoutIconBase:n.n(i)()}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(e){var t=e.strokeClass;return[n("rect",{class:t,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}})]}}])})}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},AQC4:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("6tNc");const o={components:{LayoutIconBase:n.n(i)()}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.strokeClass;return[n("rect",{class:i,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}}),e._v(" "),n("line",{class:i,attrs:{x1:"12.5",y1:"4",x2:"12.5",y2:"20"}})]}}])})}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},w6BJ:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("6tNc");const o={components:{LayoutIconBase:n.n(i)()}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.strokeClass,o=t.semiFillClass;return[n("rect",{class:i,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}}),e._v(" "),n("path",{class:[i,o],attrs:{d:"M0.5 6C0.5 5.17157 1.17157 4.5 2 4.5H7.5V19.5H2C1.17157 19.5 0.5 18.8284 0.5 18V6Z"}}),e._v(" "),n("line",{class:i,attrs:{x1:"7.5",y1:"4",x2:"7.5",y2:"20"}})]}}])})}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},"7zT1":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("6tNc");const o={components:{LayoutIconBase:n.n(i)()}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.strokeClass,o=t.semiFillClass;return[n("rect",{class:i,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}}),e._v(" "),n("path",{class:[i,o],attrs:{d:"M16.5 4.5H22C22.8284 4.5 23.5 5.17157 23.5 6V18C23.5 18.8284 22.8284 19.5 22 19.5H16.5V4.5Z"}}),e._v(" "),n("line",{class:i,attrs:{x1:"16.5",y1:"4",x2:"16.5",y2:"20"}})]}}])})}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},Xhlp:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("6tNc");const o={components:{LayoutIconBase:n.n(i)()}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.strokeClass;return[n("rect",{class:i,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}}),e._v(" "),n("line",{class:i,attrs:{x1:"16.5",y1:"4",x2:"16.5",y2:"20"}}),e._v(" "),n("line",{class:i,attrs:{x1:"8.5",y1:"4",x2:"8.5",y2:"20"}}),e._v(" "),n("line",{class:i,attrs:{x1:"8.5",y1:"4",x2:"8.5",y2:"20"}})]}}])})}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},Nmbj:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var i=(0,n("wWJ2").Z)({},(function(){var e=this,t=e.$createElement;return(e._self._c||t)("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"}},[e._t("default",null,{strokeClass:"tui-editor_weka-layoutIcon24Base__stroke",semiFillClass:"tui-editor_weka-layoutIcon24Base__semiFill"})],2)}),[],!1,null,null,null);i.options.__hasBlocks={script:!1,template:!0};const o=i.exports},"l4/9":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var i=n("TVjX"),o=n.n(i),a=n("yQz/"),r=n.n(a);const s={extends:o(),props:{ariaLabel:String},data:()=>({textContent:"",dropdownShown:!1}),mounted(){this.observer=new MutationObserver(this.$_updateTextContent),this.observer.observe(this.$refs.content,{childList:!0,subtree:!0,characterData:!0}),this.$_updateTextContent()},beforeDestroy(){this.observer.disconnect()},methods:{showDropdown(){this.context.showMarkDropdown(this.getRange).then((e=>{this.dropdownShown=!0,e.$on("dismiss",(()=>this.dropdownShown=!1))}))},$_updateTextContent(){const e=r()();setTimeout((()=>{e(),this.textContent=this.$refs.content.textContent}),0)}}};var l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("a",{ref:"content",attrs:{href:e.attrs.href,title:e.attrs.title,target:e.attrs.open_in_new_window?"_blank":null},on:{click:e.showDropdown}})}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};const d=l.exports},cCDf:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const i={directives:{"weka-node-ui":n("pkZy").wekaNodeUI},props:{contextMode:{type:String,required:!0,validator:e=>"contained"===e||"uncontained"===e}},provide(){return{wekaNodeMenuContext:this.wekaNodeMenuContext}},computed:{wekaNodeMenuContext(){return{contextMode:this.contextMode}}}};var o=(0,n("wWJ2").Z)(i,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{directives:[{name:"weka-node-ui",rawName:"v-weka-node-ui"}],staticClass:"tui-editor_weka-nodeMenu",attrs:{contenteditable:"false"}},[e._t("default")],2)}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};const a=o.exports},v7xS:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var i=n("xZv7"),o=n.n(i),a=n("oXL3"),r=n.n(a);const s={components:{ActionDropdown:o(),NodeMenuButton:r()},props:{text:String,ariaLabel:String,title:String,position:String,actions:Array,caret:{type:Boolean,default:!0},buttonAttrs:Object},inject:["wekaNodeMenuContext"],computed:{contextMode(){return this.wekaNodeMenuContext&&this.wekaNodeMenuContext.contextMode}}};var l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ActionDropdown",{attrs:{position:e.position,actions:e.actions,"context-mode":e.contextMode},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,o=t.isOpen;return[n("NodeMenuButton",e._b({attrs:{text:e.text,"aria-expanded":o.toString(),"aria-label":e.ariaLabel,title:e.title,caret:e.caret},on:{click:i},scopedSlots:e._u([e.$scopedSlots.icon?{key:"icon",fn:function(){return[e._t("icon")]},proxy:!0}:null],null,!0)},"NodeMenuButton",e.buttonAttrs,!1))]}}])})}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};const d=l.exports},KGWr:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});const i=tui.require("tui/components/buttons/ButtonAria");var o=n.n(i);const a=tui.require("tui/components/decor/Caret");var r=n.n(a);const s={components:{ButtonAria:o(),Caret:r()},props:{text:String,caret:Boolean},computed:{iconOnly(){return this.$scopedSlots.icon&&!this.text&&!this.caret}},methods:{handleClick(e){this.$emit("click",e)}}};var l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ButtonAria",[n("div",{staticClass:"tui-editor_weka-nodeMenuButton",class:{"tui-editor_weka-nodeMenuButton--iconOnly":e.iconOnly},on:{click:e.handleClick}},[e.$scopedSlots.icon?n("div",{staticClass:"tui-editor_weka-nodeMenuButton__icon"},[e._t("icon")],2):e._e(),e._v("\n    "+e._s(e.text)+"\n    "),e.caret?n("Caret",{staticClass:"tui-editor_weka-nodeMenuButton__caret"}):e._e()],1)])}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};const d=l.exports},FphW:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var i=(0,n("wWJ2").Z)({},(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"tui-editor_weka-nodeMenuGroup"},[e._t("default")],2)}),[],!1,null,null,null);i.options.__hasBlocks={script:!1,template:!0};const o=i.exports},"y8/K":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var i=n("lhYX"),o=n.n(i),a=n("x7h9"),r=n.n(a);const s={components:{NodeMenuActionDropdown:o(),MoreIcon:r()},props:{text:String,position:{type:String,default:"bottom-right"},actions:Array}},l=function(e){e.options.__langStrings={editor_weka:["more_options"]}};var d=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("NodeMenuActionDropdown",{attrs:{position:e.position,actions:e.actions,"aria-label":e.$str("more_options","editor_weka"),title:e.$str("more_options","editor_weka"),caret:!1,"button-attrs":{"data-weka-more":"true"}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("MoreIcon")]},proxy:!0}])})}),[],!1,null,null,null);l(d),d.options.__hasBlocks={script:!0,template:!0};const c=d.exports},u5KH:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var i=n("TVjX"),o=n.n(i),a=n("fZmM"),r=n("/N6l");const s=tui.require("editor_weka/components/attachments/ImageAttachment");var l=n.n(s);const d=tui.require("editor_weka/components/attachments/FileAttachment");var c=n.n(d);const u=tui.require("editor_weka/components/attachments/VideoAttachment");var p=n.n(u);const m=tui.require("editor_weka/components/attachments/AudioAttachment");var h=n.n(m);const _={components:{ImageAttachment:l(),FileAttachment:c(),VideoAttachment:p(),AudioAttachment:h()},extends:o(),apollo:{file:{query:a.Z,variables(){return{item_id:this.itemId,filename:this.filename}}}},data:()=>({file:{}}),computed:{isImage(){return this.file&&this.file.media_type===r.IMAGE},isVideo(){return this.file&&this.file.media_type===r.VIDEO},isAudio(){return this.file&&this.file.media_type===r.AUDIO},itemId(){return this.context.getItemId()},filename(){const e=this.attrs;return e.filename?e.filename:this.$str("unknown_attachment","editor_weka")},option(){return this.attrs.option},hasImageNode(){return this.context.hasImageNode()},hasVideoNode(){return this.context.hasVideoNode()},hasAudioNode(){return this.context.hasAudioNode()},downloadUrl:()=>null},methods:{toImage(){const e={filename:this.filename,alttext:this.option.alttext||null};this.context.convertToImage(this.getRange,e)},updateAltText(e){this.$_updateNode({filename:this.filename,size:this.file?this.file.file_size:this.attrs.size,option:{alttext:e}})},$_updateNode(e){this.context.updateNode(this.getRange,e)},toVideo(){const e={filename:this.filename,mimeType:this.file.mime_type,subtitle:this.option.subtitle||null};this.context.convertToVideo(this.getRange,e)},toAudio(){const e={filename:this.filename,mimeType:this.file.mime_type,transcript:this.option.transcript||null};this.context.convertToAudio(this.getRange,e)},removeNode(){this.context.removeNode(this.getRange)},async download(){window.open(await this.context.getDownloadUrl(this.filename))}}},f=function(e){e.options.__langStrings={editor_weka:["unknown_attachment"]}};var g=(0,n("wWJ2").Z)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaAttachment"},[e.$apollo.loading?e._e():[e.isImage?n("ImageAttachment",{attrs:{"file-size":e.file?e.file.file_size:0,"draft-id":e.itemId,filename:e.filename,"alt-text":e.option.alttext||null,"enable-convert":e.hasImageNode,"has-download-url":!0,disabled:e.editorDisabled},on:{"convert-to-embedded-media":e.toImage,"update-alt-text":e.updateAltText,delete:e.removeNode,download:e.download}}):e.isVideo?n("VideoAttachment",{attrs:{"file-size":e.file?e.file.file_size:0,"draft-id":e.itemId,filename:e.filename,"enable-convert":e.hasVideoNode,"has-download-url":!0,disabled:e.editorDisabled},on:{"convert-to-embedded-media":e.toVideo,delete:e.removeNode,download:e.download}}):e.isAudio?n("AudioAttachment",{attrs:{"file-size":e.file?e.file.file_size:0,"draft-id":e.itemId,filename:e.filename,"enable-convert":e.hasAudioNode,"has-download-url":!0,disabled:e.editorDisabled},on:{"convert-to-embedded-media":e.toAudio,delete:e.removeNode,download:e.download}}):n("FileAttachment",{attrs:{"file-size":e.file?e.file.file_size:0,filename:e.filename,"draft-id":e.itemId,"has-download-url":!0,disabled:e.editorDisabled},on:{delete:e.removeNode,download:e.download}})]],2)}),[],!1,null,null,null);f(g),g.options.__hasBlocks={script:!0,template:!0};const v=g.exports},Tmk0:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const i=tui.require("tui/components/json_editor/nodes/AttachmentNodeCollection"),o={components:{AttachmentNodeCollection:n.n(i)()}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("AttachmentNodeCollection",{staticClass:"tui-wekaAttachments"},[t("div",{ref:"content",staticClass:"tui-wekaAttachments__content"})])}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},OOfW:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});const i=tui.require("tui/components/json_editor/nodes/AudioBlock");var o=n.n(i),a=n("TVjX"),r=n.n(a),s=n("fZmM"),l=n("oFnQ"),d=n.n(l),c=n("EJOt"),u=n.n(c),p=n("9lfe"),m=n.n(p),h=n("IpiT");const _={components:{Button:n.n(h)(),CoreAudioBlock:o(),NodeBar:d(),ModalPresenter:u(),ExtraFileUploadModal:m()},extends:r(),apollo:{file:{query:s.Z,variables(){return{item_id:this.itemId,filename:this.filename}}}},data:()=>({file:{},showModal:!1}),computed:{actions(){return[this.hasAttachmentNode&&{label:this.$str("display_as_attachment","editor_weka"),action:this.$_toAttachment},{label:this.$str("upload_transcript","editor_weka"),action:this.openModal},{label:this.$str("remove","core"),action:this.$_removeNode},{label:this.$str("download","core"),action:this.$_download}].filter(Boolean)},itemId(){return this.context.getItemId()},contextId(){if(!this.context.getContextId)throw new Error("No function 'getContextId' was found from extension");return this.context.getContextId()},filename(){return this.attrs.filename?this.attrs.filename:null},transcriptFilename(){return this.attrs.transcript?this.attrs.transcript.filename:null},transcriptUrl(){return this.attrs.transcript?this.attrs.transcript.url:null},hasAttachmentNode(){return this.context.hasAttachmentNode()},transcriptButtonVisible(){return!this.editorDisabled&&null===this.attrs.transcript}},methods:{$_removeNode(){return this.context.removeNode(this.getRange)},$_toAttachment(){if(!this.context.replaceWithAttachment)return;const e={filename:this.filename,size:this.file.file_size,transcript:this.attrs.transcript||null};this.context.replaceWithAttachment(this.getRange,e)},async $_download(){window.open(await this.context.getDownloadUrl(this.filename))},openModal(){this.showModal=!0},hideModal(){this.showModal=!1},cancel(){null===this.transcriptFilename?this.updateTranscript(""):this.hideModal()},onTranscriptChange(e){this.updateTranscript(e||"")},async updateTranscript(e){if(this.hideModal(),!this.context.updateAudioWithTranscript)return;const t=Object.assign({},this.attrs,{transcript:e});e&&(t.transcript={filename:e.filename,url:e.url}),this.context.updateAudioWithTranscript(this.getRange,t)}}},f=function(e){e.options.__langStrings={core:["remove","download"],editor_weka:["audio_alt_help","display_as_attachment","actions_menu_for","upload_caption_transcript_button","upload_audio_transcript","upload_transcript","transcript_modal_title_help"]}};var g=(0,n("wWJ2").Z)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaAudioBlock"},[e.$apollo.loading?e._e():[n("div",{staticClass:"tui-wekaAudioBlock__inner"},[n("ModalPresenter",{attrs:{open:e.showModal},on:{"request-close":e.cancel}},[n("ExtraFileUploadModal",{attrs:{"item-id":e.itemId,"context-id":e.contextId,"accepted-file-types":[".txt"],"modal-title":e.$str("upload_audio_transcript","editor_weka"),"modal-title-help-text":e.$str("transcript_modal_title_help","editor_weka"),"submit-button-text":e.$str("upload_caption_transcript_button","editor_weka",".txt"),"modal-help-text":e.$str("audio_alt_help","editor_weka"),filename:e.transcriptFilename},on:{change:e.onTranscriptChange}})],1),e._v(" "),n("div",{staticClass:"tui-wekaAudioBlock__positioner"},[e.transcriptButtonVisible?n("Button",{staticClass:"tui-wekaAudioBlock__inner-addtranscriptButton",attrs:{text:e.$str("upload_transcript","editor_weka")},on:{click:e.openModal}}):e._e(),e._v(" "),n("CoreAudioBlock",{attrs:{filename:e.filename,"item-id":e.itemId,url:e.file.url,"mime-type":e.file.mime_type,"transcript-url":e.transcriptUrl}})],1),e._v(" "),e.editorDisabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)]],2)}),[],!1,null,null,null);f(g),g.options.__hasBlocks={script:!0,template:!0};const v=g.exports},Uzaj:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var i=n("pkZy"),o=n("cMqc");const a={directives:{"weka-node-ui":i.wekaNodeUI},props:{nodeInfo:Object,contextInfo:Object,updateAttrs:Function,replaceWith:Function,getPos:Function,getRange:Function,editorDisabled:Boolean,selected:Boolean,cursorInside:Boolean},computed:{node(){return this.nodeInfo.node},attrs(){return this.nodeInfo.node.attrs},context(){return this.contextInfo.context}},updated(){this.$emit("updated")},methods:{trackInExtras(e,t){return new o.default(e,{trackedElAnchor:"top-left",positionedElAnchor:"top-right",...t,trackedEl:t.trackedEl,viewExtrasEl:this.nodeInfo.editor.viewExtrasEl})}}};var r=(0,n("wWJ2").Z)(a,void 0,void 0,!1,null,null,null);r.options.__hasBlocks={script:!0,template:!1};const s=r.exports},uoDY:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var i=n("+Hsq"),o=n.n(i),a=n("TVjX"),r=n.n(a);const s={components:{Emoji:o()},extends:r(),computed:{shortCode(){if(this.attrs.shortcode)return this.attrs.shortcode}}};var l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("Emoji",{staticClass:"tui-wekaEmoji",attrs:{"short-code":e.shortCode}})}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};const d=l.exports},isp3:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("TVjX");const o={extends:n.n(i)()};var a=(0,n("wWJ2").Z)(o,(function(){var e=this.$createElement;return(this._self._c||e)("figcaption",{ref:"content",staticClass:"tui-editor_weka-figureCaption"})}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},g3qL:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var i=n("TVjX"),o=n.n(i);const a=tui.require("tui/components/json_editor/nodes/Hashtag");var r=n.n(a),s=n("3NWB"),l=n.n(s),d=n("DS3U"),c=n.n(d);const u={components:{Hashtag:r(),Dropdown:l(),DropdownButton:c()},extends:o(),computed:{text(){return this.attrs.text},url(){return this.$url("/totara/catalog/index.php",{catalog_fts:this.attrs.text})}},methods:{open(e){window.open(e)}}},p=function(e){e.options.__langStrings={editor_weka:["actions_menu_for","view_search_results","hashtag"]}};var m=(0,n("wWJ2").Z)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dropdown",{staticClass:"tui-wekaHashtag",attrs:{disabled:e.editorDisabled},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle;return t.isOpen,[n("Hashtag",{attrs:{url:e.url,text:e.$str("hashtag","editor_weka",e.text)},nativeOn:{"!click":function(e){return e.preventDefault(),i.apply(null,arguments)}}})]}}])},[e._v(" "),n("DropdownButton",{on:{click:function(t){return e.open(e.url)}}},[e._v("\n    "+e._s(e.$str("view_search_results","editor_weka"))+"\n  ")])],1)}),[],!1,null,null,null);p(m),m.options.__hasBlocks={script:!0,template:!0};const h=m.exports},MlBL:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var i=n("KJgz"),o=n.n(i),a=n("vujW"),r=n.n(a),s=n("jGtd"),l=n.n(s);const d=tui.require("tui/components/loading/ComponentLoading");var c=n.n(d),u=n("EJOt"),p=n.n(u),m=n("nIqm");const h=tui.require("editor_weka/components/editing/EditImageAltTextModal");var _=n.n(h),f=n("TVjX"),g=n.n(f),v=n("fZmM");const k={components:{ImageIcon:r(),ResponsiveImage:l(),ComponentLoading:c(),ModalPresenter:p(),NodeMenu:m.NodeMenu,NodeMenuActionDropdown:m.NodeMenuActionDropdown,NodeMenuButton:m.NodeMenuButton,NodeMenuGroup:m.NodeMenuGroup,NodeMenuMoreDropdown:m.NodeMenuMoreDropdown,EditImageAltTextModal:_()},extends:g(),apollo:{file:{query:v.Z,variables(){return{filename:this.filename,item_id:this.itemId}},batch:!0}},data:()=>({file:null,altTextModalOpen:!1,toolbarPosition:"normal"}),computed:{loading(){return null==this.file},hasAttachmentNode(){return this.context.hasAttachmentNode()},actions(){return[this.hasAttachmentNode&&{label:this.$str("display_as_attachment","editor_weka"),action:this.$_toAttachment},{label:this.$str("remove","core"),action:this.$_removeNode},{label:this.$str("download","core"),action:this.$_download}].filter(Boolean)},altText(){return this.attrs.alttext},filename(){return this.attrs.filename||null},itemId(){return this.context.getItemId()},displaySize(){return this.attrs.display_size},grow(){return null!=this.displaySize},sizeOptions(){return[{label:this.$str("size_original","editor_weka"),size:void 0},{label:this.$str("size_large","editor_weka"),size:"large"},{label:this.$str("size_medium","editor_weka"),size:"medium"},{label:this.$str("size_small","editor_weka"),size:"small"}]},sizeActions(){return this.sizeOptions.map((e=>({label:e.label,action:()=>this.$_setSize(e.size)})))},currentSizeName(){if(null==this.displaySize)return this.$str("size_original","editor_weka");const e=this.sizeOptions.find((e=>e.size===this.displaySize));return e?e.label:null},toolbarDeps(){return{position:this.toolbarPosition,selected:this.selected}}},watch:{toolbarDeps({position:e,selected:t}){if(!this.trackedToolbar)return;const n="floating"===e;this.trackedToolbar.setCaptured(n),n&&this.trackedToolbar.setVisible(t)}},mounted(){this.resizeObserver=new(o())(this.$_handleInnerResize),this.resizeObserver.observe(this.$refs.inner),this.$_handleInnerResize(),this.trackedToolbar=this.trackInExtras(this.$refs.toolbar,{trackedEl:this.$el,trackedElAnchor:"top-start",positionedElAnchor:"top-start"}),"floating"===this.toolbarPosition&&this.trackedToolbar.captureNode()},beforeDestroy(){this.resizeObserver.disconnect(),this.trackedToolbar.destroy()},methods:{$_setSize(e){this.context.updateImage(this.getRange,{display_size:e})},$_toAttachment(){if(!this.context.replaceWithAttachment)return;const e={filename:this.filename,alttext:this.altText,size:this.file.file_size};this.context.replaceWithAttachment(this.getRange,e)},editAltText(){this.altTextModalOpen=!0},updateAltText(e){this.altTextModalOpen=!1,this.context.updateImage(this.getRange,{alttext:e})},$_removeNode(){return this.context.removeNode(this.getRange)},async $_download(){window.open(await this.context.getDownloadUrl(this.filename))},hideAltTextModal(){null===this.altText?this.updateAltText(""):this.altTextModalOpen=!1},focusCaption(){const e={filename:this.filename,alttext:this.altText,size:this.file.file_size};this.context.replaceWithFigure(this.getRange,e)},$_handleInnerResize(){const{inner:e}=this.$refs;this.toolbarPosition=e.offsetWidth>=300&&e.offsetHeight>=70?"normal":"floating"}}},w=function(e){e.options.__langStrings={core:["loadinghelp","remove","download"],editor_weka:["actions_menu_for","alt_text","caption","display_as_attachment","image_size_x","image_size","size_large","size_medium","size_original","size_small"]}};var y=(0,n("wWJ2").Z)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaImageBlock",class:["tui-wekaImageBlock--toolbarPosition-"+e.toolbarPosition,e.displaySize&&["tui-wekaImageBlock--displaySize","tui-wekaImageBlock--displaySize-"+e.displaySize]],attrs:{contenteditable:"false"}},[n("div",{ref:"inner",staticClass:"tui-wekaImageBlock__inner"},[[n("div",{staticClass:"tui-wekaImageBlock__imageWrap"},[e.loading?n("ComponentLoading"):n("ResponsiveImage",{staticClass:"tui-wekaImageBlock__image",attrs:{src:e.file.url,alt:e.altText,grow:e.grow}})],1),e._v(" "),n("div",{ref:"toolbar",class:["tui-wekaImageBlock__toolbar","tui-wekaImageBlock__toolbar--"+e.toolbarPosition]},[e.editorDisabled?e._e():n("NodeMenu",{attrs:{"context-mode":"uncontained"}},[n("NodeMenuGroup",[n("NodeMenuActionDropdown",{attrs:{position:"bottom-left",actions:e.sizeActions,text:e.currentSizeName||e.$str("image_size","editor_weka"),title:e.$str("image_size","editor_weka"),"aria-label":e.currentSizeName?e.$str("image_size_x","editor_weka",e.currentSizeName):e.$str("image_size","editor_weka")},scopedSlots:e._u([{key:"icon",fn:function(){return[n("ImageIcon")]},proxy:!0}],null,!1,3644944271)})],1),e._v(" "),n("NodeMenuGroup",[n("NodeMenuButton",{attrs:{text:e.$str("alt_text","editor_weka")},on:{click:e.editAltText}})],1),e._v(" "),n("NodeMenuGroup",[n("NodeMenuButton",{attrs:{text:e.$str("caption","editor_weka")},on:{click:e.focusCaption}})],1),e._v(" "),n("NodeMenuGroup",[n("NodeMenuMoreDropdown",{attrs:{actions:e.actions}})],1)],1)],1)]],2),e._v(" "),n("ModalPresenter",{attrs:{open:e.altTextModalOpen},on:{"request-close":e.hideAltTextModal}},[n("EditImageAltTextModal",{attrs:{value:e.altText},on:{change:e.updateAltText}})],1)],1)}),[],!1,null,null,null);w(y),y.options.__hasBlocks={script:!0,template:!0};const b=y.exports},TYzV:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var i=n("AQw4"),o=n.n(i),a=n("hd/h"),r=n.n(a),s=n("5TpV"),l=n.n(s),d=n("KTPV"),c=n.n(d),u=n("Pspb"),p=n.n(u),m=n("PWfy"),h=n.n(m),_=n("TVjX"),f=n.n(_),g=n("nIqm"),v=n("xIDV");const k={components:{LayoutIcon:o(),NodeMenu:g.NodeMenu,NodeMenuActionDropdown:g.NodeMenuActionDropdown,NodeMenuButton:g.NodeMenuButton,NodeMenuGroup:g.NodeMenuGroup,NodeMenuMoreDropdown:g.NodeMenuMoreDropdown},extends:f(),computed:{currentVariant(){const e=this.context.getLayoutBlockDetails(this.node);return this.layoutVariantOptions.find((t=>t.columns.length===e.columns.length&&t.columns.every(((t,n)=>this.columnMatches(e.columns[n],t)))))},layoutVariantOptions(){return[{label:this.$str("layout_one_column","editor_weka"),iconComponent:r(),columns:[{}]},{label:this.$str("layout_two_column","editor_weka"),columns:[{},{}],iconComponent:l()},{label:this.$str("layout_narrow_left_column","editor_weka"),columns:(0,v.isRtl)()?[{},{type:"sidebar"}]:[{type:"sidebar"},{}],iconComponent:c()},{label:this.$str("layout_narrow_right_column","editor_weka"),columns:(0,v.isRtl)()?[{type:"sidebar"},{}]:[{},{type:"sidebar"}],iconComponent:p()},{label:this.$str("layout_three_column","editor_weka"),columns:[{},{},{}],iconComponent:h()}]},layoutVariantActions(){return this.layoutVariantOptions.map((e=>({label:e.label,iconComponent:e.iconComponent,action:()=>this.updateLayout({columns:e.columns})})))},actions(){return[{label:this.$str("remove","core"),action:()=>this.deleteLayout()}]},toolbarVisible(){return!this.editorDisabled&&this.cursorInside}},watch:{toolbarVisible(e){this.trackedToolbar.setVisible(e)}},mounted(){this.trackedToolbar=this.trackInExtras(this.$refs.toolbar,{trackedEl:this.$el,trackedElAnchor:"top-end",positionedElAnchor:"bottom-end"}),this.trackedToolbar.captureNode()},beforeDestroy(){this.trackedToolbar.destroy()},methods:{updateLayout(e){this.context.updateLayout(this.getRange,e)},deleteLayout(){this.context.deleteLayout(this.getRange)},columnMatches:(e,t)=>e.type==t.type}},w=function(e){e.options.__langStrings={core:["remove"],editor_weka:["layout","layout_narrow_left_column","layout_narrow_right_column","layout_one_column","layout_settings","layout_three_column","layout_two_column","layout_x"]}};var y=(0,n("wWJ2").Z)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"focus-within",rawName:"v-focus-within"}],staticClass:"tui-editor_weka-layoutBlock",class:{"tui-editor_weka-layoutBlock--cursorInside":e.cursorInside}},[n("div",{ref:"toolbar",staticClass:"tui-editor_weka-layoutBlock__toolbarWrap",attrs:{contenteditable:"false"}},[n("div",{directives:[{name:"weka-node-ui",rawName:"v-weka-node-ui"}],staticClass:"tui-editor_weka-layoutBlock__toolbar"},[n("NodeMenu",{attrs:{"context-mode":"contained"}},[n("NodeMenuActionDropdown",{attrs:{position:"bottom-right",actions:e.layoutVariantActions,text:e.currentVariant?e.currentVariant.label:e.$str("layout","editor_weka"),title:e.$str("layout","editor_weka"),"aria-label":e.currentVariant?e.$str("layout_x","editor_weka",e.currentVariant.label):e.$str("layout","editor_weka")},scopedSlots:e._u([{key:"icon",fn:function(){return[e.currentVariant&&e.currentVariant.iconComponent?n(e.currentVariant.iconComponent,{tag:"component"}):n("LayoutIcon")]},proxy:!0}])}),e._v(" "),n("NodeMenuMoreDropdown",{attrs:{actions:e.actions}})],1)],1)]),e._v(" "),n("div",{ref:"content",staticClass:"tui-editor_weka-layoutBlock__content"})])}),[],!1,null,null,null);w(y),y.options.__hasBlocks={script:!0,template:!0};const b=y.exports},"4Gjm":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("TVjX");const o={extends:n.n(i)(),computed:{isSidebar(){return"sidebar"===this.attrs.type}}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{ref:"content",staticClass:"tui-editor_weka-layoutColumn",class:{"tui-editor_weka-layoutColumn--sidebar":e.isSidebar}})}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},hI7e:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var i=n("TVjX"),o=n.n(i),a=n("1+j7"),r=n.n(a),s=n("3NWB"),l=n.n(s),d=n("DS3U"),c=n.n(d);const u=tui.require("tui/components/json_editor/nodes/LinkBlock");var p=n.n(u),m=n("x7h9"),h=n.n(m);const _={components:{ButtonIcon:r(),Dropdown:l(),DropdownButton:c(),LinkBlockInner:p(),More:h()},extends:o(),methods:{open(){window.open(this.attrs.url)},edit(){this.context.editCard(this.getRange)},toLink(){const e=this.attrs.url;this.context.replaceWithTextLink(this.getRange,{url:e})},remove(){this.$emit("remove")}}},f=function(e){e.options.__langStrings={core:["edit","remove"],editor_weka:["actions_menu_for","display_as_text","go_to_link_label"]}};var g=(0,n("wWJ2").Z)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaLinkBlock",attrs:{"data-url":e.attrs.url}},[n("Dropdown",{attrs:{disabled:e.editorDisabled},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,o=t.isOpen;return[n("div",{on:{"!click":function(e){return e.preventDefault(),i.apply(null,arguments)}}},[n("LinkBlockInner",{attrs:{attrs:e.attrs}})],1),e._v(" "),n("div",{staticClass:"tui-wekaLinkBlock__btn-wrapper"},[e.editorDisabled?e._e():n("ButtonIcon",{staticClass:"tui-wekaLinkBlock__btn",attrs:{styleclass:{small:!0,transparent:!0},"aria-expanded":o.toString(),"aria-label":e.$str("actions_menu_for","editor_weka",e.attrs.title||e.attrs.url)},on:{click:i}},[n("More")],1)],1)]}}])},[e._v(" "),n("DropdownButton",{on:{click:e.open}},[e._v("\n      "+e._s(e.$str("go_to_link_label","editor_weka"))+"\n    ")]),e._v(" "),n("DropdownButton",{on:{click:e.edit}},[e._v("\n      "+e._s(e.$str("edit","core"))+"\n    ")]),e._v(" "),n("DropdownButton",{on:{click:e.toLink}},[e._v("\n      "+e._s(e.$str("display_as_text","editor_weka"))+"\n    ")]),e._v(" "),n("DropdownButton",{on:{click:e.remove}},[e._v("\n      "+e._s(e.$str("remove","core"))+"\n    ")])],1)],1)}),[],!1,null,null,null);f(g),g.options.__hasBlocks={script:!0,template:!0};const v=g.exports},"7vMz":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var i=n("TVjX"),o=n.n(i),a=n("oFnQ"),r=n.n(a);const s=tui.require("tui/components/embeds/ResponsiveEmbedIframe");var l=n.n(s),d=n("jGtd"),c=n.n(d),u=n("/g0d"),p=n.n(u);const m={components:{NodeBar:r(),ResponsiveEmbedIframe:l(),ResponsiveImage:c(),Loading:p()},extends:o(),computed:{pluginMatch(){return this.context.urlPlugin({type:"media",url:this.attrs.url})||{}},pluginKey(){return this.pluginMatch.plugin&&this.pluginMatch.plugin.key},pluginName(){return this.pluginMatch.plugin&&this.pluginMatch.plugin.name},details(){return this.pluginMatch.details||{}},actions(){return[{label:this.$str("go_to_link_label","editor_weka"),action:()=>this.open()},{label:this.$str("edit","core"),action:()=>this.edit()},{label:this.$str("display_as_text","editor_weka"),action:()=>this.toLink()},{label:this.$str("remove","core"),action:()=>this.$emit("remove")}]},iframeUrl(){const{details:e}=this;let t=null;switch(this.pluginKey){case"youtube":t="https://www.youtube.com/embed/"+e.id+"?rel=0";break;case"vimeo":t="https://player.vimeo.com/video/"+e.id+"?portrait=0";break;case"vimeo-private":t="https://player.vimeo.com/video/"+e.id+"?h="+e.privateString+"&portrait=0"}return t},summaryText(){return this.pluginName+" - "+(this.attrs.title||this.attrs.url)}},methods:{open(){window.open(this.attrs.url)},edit(){this.context.editCard(this.getRange)},toLink(){const e=this.attrs.url;this.context.replaceWithTextLink(this.getRange,{url:e})}}},h=function(e){e.options.__langStrings={core:["edit","remove","loading"],editor_weka:["actions_menu_for","display_as_text","go_to_link_label"]}};var _=(0,n("wWJ2").Z)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaLinkMedia",class:{"tui-wekaLinkMedia--intrinsic-width":!e.attrs.loading&&!e.iframeUrl},attrs:{"data-url":e.attrs.url}},[n("div",{staticClass:"tui-wekaLinkMedia__inner"},[e.attrs.loading?n("div",{staticClass:"tui-wekaLinkMedia__loading"},[n("Loading",{attrs:{alt:e.$str("loading","core")}})],1):e.iframeUrl?n("div",{staticClass:"tui-wekaLinkMedia__embed"},[n("ResponsiveEmbedIframe",{attrs:{src:e.iframeUrl,resolution:e.attrs.resolution,title:e.attrs.title||e.attrs.url}})],1):"audio"==e.pluginKey?n("div",[n("audio",{attrs:{controls:"",src:e.attrs.url}})]):"image"==e.pluginKey?n("div",[n("ResponsiveImage",{attrs:{src:e.attrs.url}})],1):n("div",[n("a",{attrs:{href:e.attrs.url}},[e._v(e._s(e.attrs.url))])]),e._v(" "),e.editorDisabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.summaryText)}})],1)])}),[],!1,null,null,null);h(_),_.options.__hasBlocks={script:!0,template:!0};const f=_.exports},"8tBG":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var i=n("TVjX"),o=n.n(i);const a=tui.require("tui/components/json_editor/nodes/Mention"),r={components:{Mention:n.n(a)()},extends:o(),computed:{displayName(){let e=this.attrs;return e.display?e.display:""},userId(){let e=this.attrs;return e.id?e.id:0}}};var s=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"tui-wekaMention"},[n("Mention",{attrs:{"user-id":e.userId,fullname:e.displayName},nativeOn:{click:function(e){e.preventDefault()}}})],1)}),[],!1,null,null,null);s.options.__hasBlocks={script:!0,template:!0};const l=s.exports},"6a0+":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var i=n("TVjX"),o=n.n(i),a=n("IpiT"),r=n.n(a);const s=tui.require("tui/components/json_editor/nodes/VideoBlock");var l=n.n(s),d=n("fZmM"),c=n("oFnQ"),u=n.n(c),p=n("EJOt"),m=n.n(p),h=n("9lfe"),_=n.n(h),f=n("x7Rm");const g={components:{Button:r(),CoreVideoBlock:l(),NodeBar:u(),ModalPresenter:m(),ExtraFileUploadModal:_()},extends:o(),apollo:{file:{query:d.Z,variables(){return{item_id:this.itemId,filename:this.filename}}}},data:()=>({file:{},showModal:!1}),computed:{hasAttachmentNode(){return this.context.hasAttachmentNode()},coreVideoBlockKey(){if(!this.attrs.subtitle)return this.attrs.filename;const{filename:e,subtitle:{filename:t,url:n}}=this.attrs;return`${e}-${t}-${n}`},actions(){return[this.hasAttachmentNode&&{label:this.$str("display_as_attachment","editor_weka"),action:this.$_toAttachment},{label:this.$str("upload_captions","editor_weka"),action:this.openModal},{label:this.$str("remove","core"),action:this.$_removeNode},{label:this.$str("download","core"),action:this.$_download}].filter(Boolean)},itemId(){return this.context.getItemId()},contextId(){if(!this.context.getContextId)throw new Error("No function 'getContextId' was found from extension");return this.context.getContextId()},filename(){return this.attrs.filename?this.attrs.filename:null},subtitleFilename(){return this.attrs.subtitle?this.attrs.subtitle.filename:null},subtitleUrl(){return this.attrs.subtitle?this.attrs.subtitle.url:null},subtitleButtonVisible(){return!this.editorDisabled&&null===this.attrs.subtitle}},methods:{$_toAttachment(){if(!this.context.replaceWithAttachment)return;const e={filename:this.filename,size:this.file.file_size,subtitle:this.attrs.subtitle||null};this.context.replaceWithAttachment(this.getRange,e)},$_removeNode(){this.context.removeNode&&this.context.removeNode(this.getRange)},async $_download(){window.open(await this.context.getDownloadUrl(this.filename))},openModal(){this.showModal=!0},hideModal(){this.showModal=!1},async cancel(){null===this.subtitleFilename?await this.updateSubtitle(""):this.hideModal()},async onSubtitleChange(e){this.updateSubtitle(e||"")},async updateSubtitle(e){if(this.hideModal(),!this.context.updateVideoWithSubtitle)return;let t=Object.assign({},this.attrs),n=null,i=!1;t.subtitle&&(n=t.subtitle.filename),e?(i=n!==e.filename,t.subtitle={filename:e.filename,url:e.url}):t.subtitle=e,this.context.updateVideoWithSubtitle(this.getRange,t),i&&await(0,f.notify)({message:this.$str("upload_caption_confirmation","editor_weka"),type:"success"})}}},v=function(e){e.options.__langStrings={core:["loadinghelp","remove","download"],editor_weka:["display_as_attachment","actions_menu_for","upload_captions","video_alt_help","upload_caption_transcript_button","upload_video_caption","upload_caption_confirmation"]}};var k=(0,n("wWJ2").Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaVideoBlock"},[e.$apollo.loading?[n("p",[e._v("\n      "+e._s(e.$str("loadinghelp","core"))+"\n    ")])]:[n("div",{staticClass:"tui-wekaVideoBlock__inner"},[n("ModalPresenter",{attrs:{open:e.showModal},on:{"request-close":e.cancel}},[n("ExtraFileUploadModal",{attrs:{"item-id":e.itemId,"context-id":e.contextId,"accepted-file-types":[".vtt"],"modal-title":e.$str("upload_video_caption","editor_weka"),"submit-button-text":e.$str("upload_caption_transcript_button","editor_weka",".vtt"),"modal-help-text":e.$str("video_alt_help","editor_weka"),filename:e.subtitleFilename},on:{change:e.onSubtitleChange}})],1),e._v(" "),n("div",{staticClass:"tui-wekaVideoBlock__positioner"},[e.subtitleButtonVisible?n("Button",{staticClass:"tui-wekaVideoBlock__inner-addCaptionButton",attrs:{text:e.$str("upload_captions","editor_weka")},on:{click:e.openModal}}):e._e(),e._v(" "),n("CoreVideoBlock",{key:e.coreVideoBlockKey,attrs:{"mime-type":e.file.mime_type,url:e.file.url,filename:e.filename,"subtitle-url":e.subtitleUrl}})],1),e._v(" "),e.editorDisabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)]],2)}),[],!1,null,null,null);v(k),k.options.__hasBlocks={script:!0,template:!0};const w=k.exports},b2jB:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var i=n("3NWB"),o=n.n(i),a=n("6e83"),r=n.n(a);const s={components:{Dropdown:o(),DropdownItem:r()},props:{contextId:{type:[Number,String]},component:{type:String},area:{type:String},location:{required:!0,type:Object},pattern:{required:!0,type:String}},data:()=>({hashtags:[]}),apollo:{hashtags:{query:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"core_find_hashtags"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pattern"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contextid"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"hashtags"},name:{kind:"Name",value:"core_hashtags_by_pattern"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pattern"},value:{kind:"Variable",name:{kind:"Name",value:"pattern"}}},{kind:"Argument",name:{kind:"Name",value:"contextid"},value:{kind:"Variable",name:{kind:"Name",value:"contextid"}}},{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tag"},arguments:[],directives:[]}]}}]}}]},fetchPolicy:"network-only",variables(){return{pattern:this.pattern,contextid:this.contextId,component:this.component,area:this.area}}}},computed:{showSuggestions(){return this.$apollo.loading||this.hashtags.length>0},positionStyle(){return{left:`${this.location.x}px`,top:`${this.location.y}px`}}},watch:{showSuggestions(e){e||this.$emit("dismiss")}},mounted(){let e=this.$refs.customTrigger;e&&e.click()},methods:{pickTag({id:e,tag:t}){this.$emit("item-selected",{id:e,text:t})},dismiss(){this.open=!1,this.$emit("dismiss")}}},l=function(e){e.options.__langStrings={editor_weka:["matching_hashtags"],core:["loadinghelp"]}};var d=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaHashtagSuggestions",style:e.positionStyle},[n("Dropdown",{attrs:{separator:!1,open:e.showSuggestions,"inline-menu":!0},on:{dismiss:e.dismiss},scopedSlots:e._u([{key:"trigger",fn:function(){return[n("span",{staticClass:"sr-only"},[e._v("\n        "+e._s(e.$str("matching_hashtags","editor_weka"))+":\n      ")])]},proxy:!0}])},[e._v(" "),e.$apollo.loading?[n("DropdownItem",{attrs:{disabled:!0}},[e._v("\n        "+e._s(e.$str("loadinghelp","core"))+"\n      ")])]:e._e(),e._v(" "),e._l(e.hashtags,(function(t,i){return n("DropdownItem",{key:i,on:{click:function(n){return e.pickTag(t)}}},[e._v("\n      "+e._s(t.tag)+"\n    ")])}))],2)],1)}),[],!1,null,null,null);l(d),d.options.__hasBlocks={script:!0,template:!0};const c=d.exports},hR3b:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var i=n("3NWB"),o=n.n(i),a=n("6e83"),r=n.n(a);const s=tui.require("tui/components/profile/MiniProfileCard");var l=n.n(s);const d=tui.require("tui/components/loading/Loader");var c=n.n(d);const u={components:{Dropdown:o(),DropdownItem:r(),MiniProfileCard:l(),Loader:c()},props:{contextId:[Number,String],component:String,area:String,instanceId:[Number,String],location:{required:!0,type:Object},pattern:{required:!0,type:String}},apollo:{users:{query:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_find_users_by_pattern"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pattern"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contextid"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"users"},name:{kind:"Name",value:"editor_weka_users_by_pattern"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pattern"},value:{kind:"Variable",name:{kind:"Name",value:"pattern"}}},{kind:"Argument",name:{kind:"Name",value:"contextid"},value:{kind:"Variable",name:{kind:"Name",value:"contextid"}}},{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"card_display"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_picture_alt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_picture_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_fields"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"associate_url"},arguments:[],directives:[]}]}}]}}]}}]}}]},fetchPolicy:"network-only",variables(){return{pattern:this.pattern,contextid:this.contextId,component:this.component,area:this.area,instance_id:this.instanceId}}}},data:()=>({users:[]}),computed:{positionStyle(){return{left:`${this.location.x}px`,top:`${this.location.y}px`}},mentionOpen(){return this.$apollo.loading||this.users.length>0}},methods:{pickUser({id:e,fullname:t}){this.$emit("item-selected",{id:e,text:t})}}},p=function(e){e.options.__langStrings={editor_weka:["matching_users"]}};var m=(0,n("wWJ2").Z)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.mentionOpen?n("div",{staticClass:"tui-wekaUserSuggestions",style:e.positionStyle},[n("Dropdown",{attrs:{separator:!0,open:e.mentionOpen,"inline-menu":!0},on:{dismiss:function(t){return e.$emit("dismiss")}}},[n("span",{staticClass:"sr-only"},[e._v("\n      "+e._s(e.$str("matching_users","editor_weka"))+":\n    ")]),e._v(" "),e.$apollo.loading?[n("DropdownItem",{attrs:{disabled:!0}},[n("Loader",{attrs:{loading:!0}})],1)]:e._e(),e._v(" "),e._l(e.users,(function(t,i){return n("DropdownItem",{key:i,attrs:{"no-padding":!0},on:{click:function(n){return e.pickUser(t)}}},[n("MiniProfileCard",{attrs:{"no-border":!0,display:t.card_display}})],1)}))],2)],1):e._e()}),[],!1,null,null,null);p(m),m.options.__hasBlocks={script:!0,template:!0};const h=m.exports},bVvI:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var i=n("xZv7"),o=n.n(i),a=n("1+j7"),r=n.n(a),s=n("x7h9"),l=n.n(s);const d={directives:{"weka-node-ui":n("pkZy").wekaNodeUI},components:{ActionDropdown:o(),ButtonIcon:r(),More:l()},props:{actions:{type:Array,required:!0},ariaLabel:String}},c=function(e){e.options.__langStrings={editor_weka:["more_items"]}};var u=(0,n("wWJ2").Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"weka-node-ui",rawName:"v-weka-node-ui"}],staticClass:"tui-wekaNodeBar",attrs:{contenteditable:"false"}},[n("ActionDropdown",{attrs:{position:"bottom-right",actions:e.actions},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,o=t.isOpen;return[n("ButtonIcon",{attrs:{styleclass:{small:!0,transparent:!0},"aria-expanded":o?"true":"false","aria-label":e.ariaLabel?e.ariaLabel:e.$str("more_items","editor_weka"),"data-weka-more":!0},on:{click:i}},[n("More")],1)]}}])})],1)}),[],!1,null,null,null);c(u),u.options.__hasBlocks={script:!0,template:!0};const p=u.exports},ZGde:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});const i=tui.require("tui/dom/focus");var o=n("3NWB"),a=n.n(o),r=n("6e83"),s=n.n(r);const l=tui.require("tui/components/icons/Show");var d=n.n(l),c=n("IpiT"),u=n.n(c),p=n("1+j7"),m=n.n(p);const h=tui.require("editor_weka/components/toolbar/ToolbarButton");var _=n.n(h);const f=tui.require("editor_weka/components/toolbar/ToolbarButtonIcon");var g=n.n(f);const v=tui.require("tui/components/popover/Popover");var k=n.n(v);const w={components:{Dropdown:a(),DropdownItem:s(),ShowIcon:d(),Button:u(),ButtonIcon:m(),ToolbarButton:_(),ToolbarButtonIcon:g(),Popover:k()},props:{items:{type:Array},sticky:Boolean},computed:{activeBlockName(){const e=this.blockItems.find((e=>e.active));return e?e.label.toString():"Block"},blockSelectorEnabled(){return this.blockItems.some((e=>e.enabled))},blockItems(){return this.items.filter((e=>"blocks"==e.group))},itemGroups(){const e=this.items.filter((e=>"blocks"!=e.group)),t={text:[],embeds:[]};return e.forEach((e=>{t[e.group]||(t[e.group]=[]),t[e.group].push(e)})),t}},methods:{itemClick(e){e.enabled&&e.execute&&e.execute()},openChanged(e,t){!t&&e.enabled&&e.reset&&e.reset()},handleButtonKeydown(e){const t=e.currentTarget;switch(e.key){case"ArrowLeft":case"Left":this.$_moveFocus(t,"prev");break;case"ArrowRight":case"Right":this.$_moveFocus(t,"next");break;case"Home":this.$_moveFocus(t,"first");break;case"End":this.$_moveFocus(t,"last");break;default:return}e.stopPropagation(),e.preventDefault()},handleButtonFocus(e){const t=e.currentTarget;this.$_getAllButtons().forEach((e=>{e.tabIndex=e==t?0:-1}))},$_getAllButtons(){return Array.prototype.slice.call(this.$el.querySelectorAll(".tui-wekaToolbar__button"))},$_moveFocus(e,t){const n=(0,i.getFocusableElements)(this.$el),o=this.$_getAllButtons().filter((e=>n.includes(e))),a=o.length-1;let r=0;"prev"==t||"next"==t?(r=o.indexOf(e),-1==r?r="next"==t?a:0:(r+="next"==t?1:-1,r>a?r=0:r<0&&(r=a))):"first"==t?r=0:"last"==t&&(r=a),o[r]&&o[r].focus()}}},y=function(e){e.options.__langStrings={editor_weka:["format_as_blocktype_status","label_toolbar"]}};var b=(0,n("wWJ2").Z)(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaToolbar",class:{"tui-wekaToolbar--sticky":e.sticky},attrs:{role:"toolbar","aria-label":e.$str("label_toolbar","editor_weka")}},[n("div",{staticClass:"tui-wekaToolbar__group"},[n("Dropdown",{attrs:{separator:!1},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,o=t.isOpen;return[n("ToolbarButton",{staticClass:"tui-wekaToolbar__currentBlock tui-wekaToolbar__button",attrs:{text:e.activeBlockName,"aria-expanded":o?"true":"false","aria-label":e.$str("format_as_blocktype_status","editor_weka",e.activeBlockName),disabled:!e.blockSelectorEnabled,caret:""},on:{click:function(e){return i()}},nativeOn:{keydown:function(t){return e.handleButtonKeydown.apply(null,arguments)},focus:function(t){return e.handleButtonFocus.apply(null,arguments)}}})]}}])},[e._v(" "),e._l(e.blockItems,(function(t,i){return n("DropdownItem",{key:i,attrs:{selected:t.active,disabled:!t.active&&!t.enabled},on:{click:function(n){return e.itemClick(t)}}},[e._v("\n        "+e._s(t.label.toString())+"\n      ")])}))],2)],1),e._v(" "),e._l(e.itemGroups,(function(t,i){return n("div",{key:i,staticClass:"tui-wekaToolbar__group"},[e._l(t,(function(t,i){return[t.children?n("Dropdown",{key:i,attrs:{separator:!1,"context-mode":"uncontained"},scopedSlots:e._u([{key:"trigger",fn:function(i){var o=i.toggle;return[n("ToolbarButtonIcon",{staticClass:"tui-wekaToolbar__button",attrs:{text:t.label.toString(),active:t.active,disabled:!t.enabled,caret:""},on:{click:o},nativeOn:{keydown:function(t){return e.handleButtonKeydown.apply(null,arguments)},focus:function(t){return e.handleButtonFocus.apply(null,arguments)}}},[n("template",{slot:"icon"},[n(t.iconComponent,{tag:"component"})],1)],2)]}}],null,!0)},[e._v(" "),e._l(t.children,(function(t,i){return["separator"===t.type?n("div",{key:i,staticClass:"tui-wekaToolbar__dropdownSeparator"}):"button"===t.type?n("div",{key:i,staticClass:"tui-wekaToolbar__dropdownButtonWrap"},[t.iconComponent?n("ButtonIcon",{key:i,attrs:{text:t.label.toString(),"aria-label":t.label.toString(),disabled:!t.enabled},on:{click:function(n){return e.itemClick(t)}}},[n(t.iconComponent,{tag:"component"})],1):n("Button",{key:i,attrs:{text:t.label.toString(),disabled:!t.enabled},on:{click:function(n){return e.itemClick(t)}}})],1):n("DropdownItem",{key:i,attrs:{disabled:!t.enabled,selected:t.active},on:{click:function(n){return e.itemClick(t)}}},[n("div",{staticClass:"tui-wekaToolbar__dropdownItemContent"},[n(t.iconComponent,{tag:"component",staticClass:"tui-wekaToolbar__dropdownItemIcon"}),e._v(e._s(t.label.toString())+"\n            ")],1)])]}))],2):t.popover?n("Popover",{key:i,attrs:{triggers:["click"],title:t.popover.title,"context-mode":"uncontained"},on:{"open-changed":function(n){for(var i=arguments.length,o=Array(i);i--;)o[i]=arguments[i];return e.openChanged.apply(void 0,[t].concat(o))}},scopedSlots:e._u([{key:"trigger",fn:function(i){var o=i.isOpen;return[n("ToolbarButtonIcon",{staticClass:"tui-wekaToolbar__button",attrs:{text:t.label.toString(),selected:t.active,disabled:!t.enabled,"aria-haspopup":"true","aria-expanded":o?"true":"false"},nativeOn:{keydown:function(t){return e.handleButtonKeydown.apply(null,arguments)},focus:function(t){return e.handleButtonFocus.apply(null,arguments)}}},[n("template",{slot:"icon"},[n(t.iconComponent,{tag:"component"})],1)],2)]}},{key:"default",fn:function(e){var i=e.close;return[n(t.popover.component,{tag:"component",on:{close:i}})]}}],null,!0)}):n("ToolbarButtonIcon",{key:i,staticClass:"tui-wekaToolbar__button",attrs:{text:t.label.toString(),selected:t.active,disabled:!t.enabled},on:{click:function(n){return e.itemClick(t)}},nativeOn:{keydown:function(t){return e.handleButtonKeydown.apply(null,arguments)},focus:function(t){return e.handleButtonFocus.apply(null,arguments)}}},[n("template",{slot:"icon"},[n(t.iconComponent,{tag:"component"})],1)],2)]}))],2)}))],2)}),[],!1,null,null,null);y(b),b.options.__hasBlocks={script:!0,template:!0};const x=b.exports},fd9w:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("IpiT");const o={components:{Button:n.n(i)()},props:{text:{type:String,required:!0},selected:{type:Boolean,default:null},caret:Boolean,disabled:Boolean},computed:{ariaPressed(){return null==this.selected?null:this.selected?"true":"false"}}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("Button",{staticClass:"tui-wekaToolbarButton",class:{"tui-wekaToolbarButton--selected":e.selected},attrs:{"aria-label":e.text,"aria-pressed":e.ariaPressed,text:e.text,caret:e.caret,disabled:e.disabled},on:{click:function(t){return e.$emit("click",t)}}})}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},"o0F/":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("1+j7");const o={components:{ButtonIcon:n.n(i)()},props:{text:{type:String,required:!0},selected:{type:Boolean,default:null},iconOnly:Boolean,disabled:Boolean,caret:{type:Boolean,default:!1}},computed:{ariaPressed(){return null!=this.selected&&(this.selected?"true":"false")}}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("ButtonIcon",{staticClass:"tui-wekaToolbarButtonIcon",class:{"tui-wekaToolbarButtonIcon--selected":e.selected,"tui-wekaToolbarButtonIcon--iconOnly":e.iconOnly},attrs:{"aria-label":e.text,"aria-pressed":e.ariaPressed,title:e.text,disabled:e.disabled,caret:e.caret},on:{click:function(t){return e.$emit("click",t)}}},[e._t("icon")],2)}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},QT84:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>F});var i=n("ApK1"),o=n.n(i),a=n("IACo"),r=n.n(a),s=n("GLpC"),l=n.n(s),d=n("eHBv"),c=n.n(d),u=n("IpiT"),p=n.n(u),m=n("ddQy"),h=n.n(m);const _=tui.require("tui/components/form/FieldError");var f=n.n(_);const g=tui.require("tui/components/form/Upload");var v=n.n(g);const k=tui.require("tui/components/icons/files/compute/FileIcon");var w=n.n(k);const y=tui.require("tui/components/buttons/InfoIconButton");var b=n.n(y);const x=tui.require("tui/components/icons/Clear");var N=n.n(x),I=n("1+j7"),S=n.n(I),A=n("/g0d"),C=n.n(A);const T=tui.require("editor_weka/api");var M=n("gQ1V"),$=n("fZmM");const D={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_core_delete_draft_file"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draftid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filename"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"totara_core_delete_draft_file"},arguments:[{kind:"Argument",name:{kind:"Name",value:"draftid"},value:{kind:"Variable",name:{kind:"Name",value:"draftid"}}},{kind:"Argument",name:{kind:"Name",value:"filename"},value:{kind:"Variable",name:{kind:"Name",value:"filename"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},E={components:{Modal:r(),ModalContent:l(),Form:o(),ButtonGroup:c(),Button:p(),ButtonCancel:h(),FieldError:f(),Upload:v(),FileIcon:w(),InfoIconButton:b(),DeleteIcon:N(),ButtonIcon:S(),Loading:C()},props:{itemId:{type:Number,required:!0},contextId:{type:Number,required:!0},acceptedFileTypes:{type:Array,required:!0},filename:String,modalHelpText:{type:String,required:!0},modalTitle:{type:String,required:!0},modalTitleHelpText:String,submitButtonText:{type:String,required:!0}},data:()=>({repositoryData:null,uploadError:"",uploadedFile:null,uploading:!1}),apollo:{uploadedFile:{query:$.Z,variables(){return{item_id:this.itemId,filename:this.filename}},skip(){return!this.filename},update:({file:e})=>e},repositoryData:{query:M.Z,variables(){return{context_id:this.contextId}},update:({repository_data:e})=>({repositoryId:e.repository_id,url:e.url})}},methods:{confirm(){this.$emit("change",this.uploadedFile)},async deleteFile(){if(!this.uploadedFile)return;const{filename:e}=this.uploadedFile;let{data:{result:{success:t}}}=await this.$apollo.mutate({mutation:D,variables:{draftid:this.itemId,filename:e}});t&&(this.uploadedFile=null)},async handleFileLoaded({file:{name:e}}){this.uploadError="",this.uploadedFile=await(0,T.getDraftFile)({itemId:this.itemId,filename:e})},handleError(){this.uploadError=this.$str("meta_upload_generic_error","editor_weka"),this.uploading=!1}}},B=function(e){e.options.__langStrings={totara_core:["filewithname","delete"],editor:["transcript"],editor_weka:["done","meta_upload_generic_error"]}};var O=(0,n("wWJ2").Z)(E,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.repositoryData?n("Modal",{staticClass:"tui-captionUploadModal"},[n("ModalContent",{staticClass:"tui-captionUploadModal__content"},[n("template",{slot:"title"},[n("div",{staticClass:"tui-captionUploadModal__title"},[e._v("\n        "+e._s(e.modalTitle)+"\n        "),e.modalTitleHelpText?n("InfoIconButton",{attrs:{"is-help-for":e.$str("transcript","editor")}},[e._v("\n          "+e._s(e.modalTitleHelpText)+"\n        ")]):e._e()],1)]),e._v(" "),n("Form",{on:{submit:function(t){return t.preventDefault(),e.confirm.apply(null,arguments)}}},[e.uploadedFile?n("div",{staticClass:"tui-captionUploadModal__file"},[n("div",{staticClass:"tui-captionUploadModal__fileContent"},[n("FileIcon",{attrs:{filename:e.uploadedFile.filename,title:e.$str("filewithname","totara_core",e.uploadedFile.filename)}}),e._v("\n          "+e._s(e.uploadedFile.filename)+"\n        ")],1),e._v(" "),n("ButtonIcon",{attrs:{"aria-label":e.$str("delete","totara_core"),styleclass:{transparentNoPadding:!0}},on:{click:e.deleteFile}},[n("DeleteIcon")],1)],1):[n("Upload",{staticClass:"tui-captionUploadModal__upload",attrs:{"repository-id":e.repositoryData.repositoryId,"item-id":e.itemId,href:e.repositoryData.url,"accepted-types":e.acceptedFileTypes,overwrite:!0,"one-file":!0,"context-id":e.contextId},on:{load:e.handleFileLoaded,"upload-finished":function(t){e.uploading=!1},progress:function(t){e.uploading=!0},error:e.handleError},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.selectEvents,o=t.inputEvents;return n("div",{},[n("input",e._g({directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"inputFile",attrs:{accept:e.acceptedFileTypes,type:"file"}},o)),e._v(" "),e.uploading?n("ButtonIcon",{attrs:{"aria-label":e.submitButtonText,text:e.submitButtonText,disabled:!0}},[n("Loading")],1):n("Button",e._g({attrs:{"aria-label":e.submitButtonText,text:e.submitButtonText}},i))],1)}}],null,!1,4060194065)}),e._v(" "),e.uploadError?n("FieldError",{staticClass:"tui-captionUploadModal__errorHandler",attrs:{error:e.uploadError}}):e._e()],e._v(" "),n("p",{staticClass:"tui-captionUploadModal__helpText"},[e._v("\n        "+e._s(e.modalHelpText)+"\n      ")]),e._v(" "),n("ButtonGroup",{staticClass:"tui-captionUploadModal__buttonGroup"},[n("Button",{attrs:{styleclass:{primary:"true"},text:e.$str("done","editor_weka")},on:{click:e.confirm}}),e._v(" "),n("ButtonCancel",{on:{click:function(t){return t.preventDefault(),e.$emit("request-close")}}})],1)],2)],2)],1):e._e()}),[],!1,null,null,null);B(O),O.options.__hasBlocks={script:!0,template:!0};const F=O.exports},Qpfd:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const i={props:{autoTrigger:{type:Boolean,default:!1},maxFiles:{type:[String,Number]}},computed:{multiple(){return 1!=this.maxFiles}},mounted(){this.autoTrigger&&(this.$_click(),this.$window.document.addEventListener("keyup",this.$_dismiss))},beforeDestroy(){this.$window.document.removeEventListener("keyup",this.$_dismiss)},methods:{$_pickFile(e){let t=[];e&&e.target&&e.target.files&&(t=e.target.files),this.$emit("picked-files",t),this.$emit("dismiss")},$_click(){this.$refs.fileInput&&this.$refs.fileInput.click()},$_dismiss(e){e&&"Escape"===e.key&&this.$emit("dismiss")}}};var o=(0,n("wWJ2").Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"fileInput",attrs:{type:"file",multiple:e.multiple},on:{change:e.$_pickFile}})])}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};const a=o.exports},PtUQ:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});const i=tui.require("tui/components/errors/ErrorPageRender");var o=n.n(i),a=n("N6D1"),r=n("xIDV");const s={components:{ErrorPageRender:o()},props:{params:Object},data:()=>({errorMessage:null,error:null}),created(){try{(0,a.setupTextarea)(this.params)}catch(e){let t;t="TEXTAREA_NOT_FOUND"===e.code?(0,r.langString)("error_textarea_not_found","editor_weka"):(0,r.langString)("error_failed_to_initialise","editor_weka"),(0,r.loadLangStrings)([t]).then((()=>{this.errorMessage=t.toString(),this.error=e}))}}};var l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.errorMessage?n("ErrorPageRender",{attrs:{message:e.errorMessage,error:e.error}}):e._e()}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};const d=l.exports},rAqx:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n("x4c5");const o={components:{Weka:n.n(i)()},props:{contextId:[Number,String]}};var a=(0,n("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-fixture-wekaBasic"},[n("Weka",{attrs:{"usage-identifier":{component:"editor_weka",area:"behat"},variant:"standard","extra-extensions":["mention","hashtag"],"context-id":e.contextId}})],1)}),[],!1,null,null,null);a.options.__hasBlocks={script:!0,template:!0};const r=a.exports},"7Pbl":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var i=n("ApK1"),o=n.n(i),a=n("2XTD"),r=n.n(a),s=n("x4c5"),l=n.n(s);const d=tui.require("editor_weka/WekaValue");var c=n.n(d),u=n("eHBv"),p=n.n(u),m=n("IgBQ"),h=n.n(m);const _=tui.require("tui/components/buttons/Submit");var f=n.n(_),g=n("IpiT"),v=n.n(g);const k={components:{Form:o(),FormRow:r(),Weka:l(),ButtonGroup:p(),InputText:h(),Submit:f(),Button:v()},props:{defaultDoc:{type:String,default:""},instanceId:[String,Number],sesskey:{type:String,required:!0}},data(){return{content:null,itemId:this.instanceId}},computed:{documentValue(){return this.content?JSON.stringify(this.content.getDoc()):""},jsonPretty(){return this.content?JSON.stringify(this.content.getDoc(),void 0,2):""}},watch:{defaultDoc:{immediate:!0,handler(e){e&&(this.content=c().fromDoc(JSON.parse(e)))}},content(e){e&&(this.itemId=e.fileStorageItemId)}}},w=function(e){e.options.__langStrings={editor_weka:["pluginname"],core:["cancel"]}};var y=(0,n("wWJ2").Z)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaWithLearn"},[n("h3",{staticClass:"tui-wekaWithLearn__title"},[e._v("\n    "+e._s(e.$str("pluginname","editor_weka"))+"\n  ")]),e._v(" "),n("Form",{staticClass:"tui-wekaWithLearn__form",attrs:{method:"POST",action:e.$url("/lib/editor/weka/tests/fixtures/weka_with_learn.php",{sesskey:e.sesskey}),"input-width":"full",vertical:!0}},[n("FormRow",{staticClass:"tui-wekaWithLearn__formRow",attrs:{label:e.$str("pluginname","editor_weka")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("Weka",{attrs:{id:i,"usage-identifier":{component:"editor_weka",area:"learn"},variant:"full","instance-id":e.instanceId,"file-item-id":e.instanceId},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})]}}])}),e._v(" "),n("FormRow",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"tui-wekaWithLearn__formRow",attrs:{hidden:!0},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("InputText",{attrs:{id:i,name:"json_content",value:e.documentValue,hidden:!0}})]}}])}),e._v(" "),n("FormRow",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"tui-wekaWithLearn__formRow",attrs:{hidden:!0},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("InputText",{attrs:{id:i,name:"item_id",value:e.itemId,hidden:!0}})]}}])}),e._v(" "),n("ButtonGroup",{staticClass:"tui-wekaWithLearn__buttonGroup"},[n("Submit"),e._v(" "),n("Button",{attrs:{type:"submit",name:"cancel",value:"1",text:e.$str("cancel","core")}})],1)],1),e._v(" "),n("hr"),e._v(" "),n("pre",{staticClass:"tui-wekaWithLearn__code"},[e._v(e._s(e.jsonPretty))])],1)}),[],!1,null,null,null);w(y),y.options.__hasBlocks={script:!0,template:!0};const b=y.exports},Md1s:()=>{},pkZy:(e,t,n)=>{"use strict";function i(e){e.wekaIgnore=!0}n.r(t),n.d(t,{wekaNodeUI:()=>o});const o={bind(e){e.addEventListener("keydown",i),e.addEventListener("keypress",i),e.addEventListener("keyup",i),e.addEventListener("mousedown",i),e.addEventListener("mouseup",i),e.addEventListener("click",i)},unbind(e){e.removeEventListener("keydown",i),e.removeEventListener("keypress",i),e.removeEventListener("keyup",i),e.removeEventListener("mousedown",i),e.removeEventListener("mouseup",i),e.removeEventListener("click",i)}}},LcYg:(e,t,n)=>{"use strict";n.r(t),n.d(t,{NodeMenu:()=>o(),NodeMenuActionDropdown:()=>r(),NodeMenuButton:()=>l(),NodeMenuGroup:()=>c(),NodeMenuMoreDropdown:()=>p()});const i=tui.require("editor_weka/components/node_menu/NodeMenu");var o=n.n(i),a=n("lhYX"),r=n.n(a),s=n("oXL3"),l=n.n(s);const d=tui.require("editor_weka/components/node_menu/NodeMenuGroup");var c=n.n(d);const u=tui.require("editor_weka/components/node_menu/NodeMenuMoreDropdown");var p=n.n(u)},b8P3:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var i=n("Aely"),o=n.n(i),a=n("zENn");const r={selectedNode:"ProseMirror-selectednode"};class s{constructor(e,{editor:t,node:n,view:i,getPos:o,parent:a,context:r}){this.component=e,this.editor=t,this.node=n,this.view=i,this.parent=a,this.context=r,this.isNode=!!this.node.marks,this.isMark=!this.isNode,this.getPos=this.isNode?o:null,this.selected=!1,this.cursorInside=!1,this.activeClasses={},this.createVue(),this.dom=this.vm.$el,this.contentDOM=this.vm.$refs.content}createVue(){const e=o().extend(this.component),t={nodeInfo:this.getNodeInfo(),contextInfo:this.getContextInfo(),updateAttrs:e=>this.updateAttrs(e),replaceWith:e=>this.replaceWith(e),getPos:this.getPos,getRange:this.getRange.bind(this),editorDisabled:!this.view.editable,selected:this.selected,cursorInside:this.cursorInside};this.vm=new e({parent:this.parent,propsData:t}).$mount(),this.vm.$on("updated",this.applyClasses.bind(this)),this.vm.$on("remove",this.remove.bind(this))}getNodeInfo(){const e={node:this.node,editor:this.editor};return Object.preventExtensions(e),e}getContextInfo(){const e={context:this.context};return Object.preventExtensions(e),e}update(e,t){return e.type===this.node.type&&(e===this.node&&this.decorations===t||(this.node=e,this.updateComponentProps({nodeInfo:this.getNodeInfo(),editorDisabled:!this.view.editable})),!0)}updateComponentProps(e){if(!this.vm._props)return;const t=o().config.silent;o().config.silent=!0,Object.entries(e).forEach((([e,t])=>{this.vm._props[e]=t})),o().config.silent=t}updateAttrs(e){if(!this.view.editable)return;const{state:t}=this.view,{type:n}=this.node,i=this.getPos(),o=Object.assign({},this.node.attrs,e),a=this.isMark?t.tr.removeMark(i.from,i.to,n).addMark(i.from,i.to,n.create(o)):t.tr.setNodeMarkup(i,null,o);this.view.dispatch(a)}replaceWith(e){const t=e(this.view.state.schema);if(void 0===t)return;const n=this.getRange(),i=this.view.state.tr.replaceWith(n.from,n.to,t);this.view.dispatch(i)}remove(){const e=this.view.state.tr,t=this.getRange(),n=e.delete(t.from,t.to);this.view.dispatch(n)}getSize(){return this.node.nodeSize}getRange(){if(this.isNode){const e=this.getPos();return{from:e,to:e+this.getSize()}}if(this.isMark){const e=this.view.posAtDOM(this.dom),t=this.view.state.doc.resolve(e);return(0,a.getMarkRange)(t,this.node.type)}}destroy(){this.vm.$destroy()}ignoreMutation(e){return!this.contentDOM&&"selection"!==e.type||!(!this.node.isLeaf&&!this.node.isAtom)||"selection"!==e.type&&(!(!this.contentDOM||"selection"===e.type||this.contentDOM.contains(e.target))||(this.dom===e.target||this.contentDOM===e.target)&&"attributes"===e.type)}selectNode(){this.updateSelection(!0)}deselectNode(){this.updateSelection(!1)}setCursorInside(e){this.cursorInside=e,this.updateComponentProps({cursorInside:e})}updateSelection(e){this.selected=e,this.setClassEnabled("selectedNode",e),!this.contentDOM&&this.node.type.spec.draggable||(e?this.dom.draggable=!0:this.dom.removeAttribute("draggable")),this.updateComponentProps({selected:e})}setClassEnabled(e,t){this.activeClasses[e]=t;const n=r[e];t?this.dom.classList.add(n):this.dom.classList.remove(n)}applyClasses(){Object.entries(r).forEach((([e,t])=>{this.activeClasses[e]?this.dom.classList.add(t):this.dom.classList.remove(t)}))}stopEvent(e){return!!e.wekaIgnore}}},NBUY:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var i=n("Xz/0"),o=n("QxjF");const a=tui.require("ext_prosemirror/keymap");var r=n("sqie"),s=n("wQtR");const l=tui.require("ext_prosemirror/dropcursor"),d=tui.require("ext_prosemirror/gapcursor");var c=n("R3Ws"),u=n("51FK"),p=n("2XWw"),m=n("7AVa"),h=n("b8P3"),_=(n("ZSGX"),n("8Tor")),f=n("OUqJ"),g=n("U0bO"),v=n("x7Rm"),k=n("xIDV"),w=n("XdLR"),y=n("UvVU");class b{constructor(e={}){this.uid=(0,g.uniqueId)(),this._options=e,this._parent=e.parent,this.viewExtrasEl=e.viewExtrasEl||null,this.viewExtrasLiveEl=e.viewExtrasLiveEl||null,this._editable=!("editable"in e)||e.editable,this.destroyed=!1,this.view=null,this.state=null,this._extensions=e.extensions||[],this.fileStorage=e.fileStorage,this._extensions.forEach((e=>e.setEditor(this)));const t={};this._nodeViews={};const n={};this._markViews={},this._allVueComponents=[],this._extensions.forEach((e=>{this._extractExtensionSchema(e,"node","nodes",t,this._nodeViews),this._extractExtensionSchema(e,"mark","marks",n,this._nodeViews)})),this.schema=(0,m.createSchema)({nodes:t,marks:n}),this._plugins=[],this._extensions.forEach((e=>{const t=e.plugins();t&&t.forEach((e=>this._plugins.push(e)))})),this._toolbarItemInstances=this._extensions.reduce(((e,t)=>t.toolbarItems?e.concat(t.toolbarItems()):e),[]),this._toolbarItems=this._toolbarItemInstances.map((e=>e.getDef())),this._mapKeys=this._extensions.map((e=>e.keymap&&e.keymap.bind(e))).filter(Boolean),this._inputRules=this._extensions.reduce(((e,t)=>t.inputRules?e.concat(t.inputRules()):e),[]),this.dispatch=this.dispatch.bind(this),this.execute=this.execute.bind(this),this.getFileStorageItemId=this.getFileStorageItemId.bind(this),this.setValue(e.value||f.default.empty())}updateFileItemId(e){this.fileStorage.updateFileItemId(e)}_extractExtensionSchema(e,t,n,i,o){const a=e[n]&&e[n]();if(a)for(const e in a){const n=a[e];i[e]&&console.warn(`[editor_weka] ${t} "${e}" was redefined`),i[e]=n.schema,n.component&&(this._allVueComponents.push(n.component),o[e]=this._componentNodeView.bind(this,n.component,n.componentContext)),n.view&&(o[e]=n.view)}}setValue(e){if(!e.inflated(this))if(e.hasHtml()){const t=document.createElement("div");t.innerHTML=e.getHtml();const n=i.EditorState.create({...this._editorConfig(),doc:u.DOMParser.fromSchema(this.schema).parse(t)});e.inflate(this,n)}else{const t=i.EditorState.create({...this._editorConfig(),doc:this._docFromJson(this.schema,e.getDoc(!1))});e.inflate(this,t)}this._value=e,this.state=e.getState(this),this.view&&this.view.updateState(this.state)}_docFromJson(e,t){return t?(t=JSON.parse(JSON.stringify(t)),this._execSerializedVisitors(t,"load"),this._rewriteUnknownNodes(e,t),u.Node.fromJSON(e,t)):null}_rewriteUnknownNodes(e,t){(0,w.X)(t,{any:t=>{const{content:n}=t;if(n)for(let i=0;i<n.length;i++){let o=n[i];if(!e.nodes[o.type]){const a=e.nodes[t.type]&&e.nodes[t.type].spec.content;let r=null;"doc"===t.type||/^block[+*]?$/.test(a)?r="unknown_block":/^inline[+*]?$/.test(a)&&(r="unknown_inline"),r?(o.attrs={type:o.type,attrs:o.attrs,content:o.content},o.type=r,delete o.content):(n.splice(i,1),i--,o=null)}o&&this._rewriteUnknownNodeMarks(e,o,t)}}})}_rewriteUnknownNodeMarks(e,t,n){const{marks:i}=t;if(i)for(let o=0;o<i.length;o++){const a=i[o];if(!e.marks[a.type]){const r=e.nodes["text"===t.type?n.type:t.type],s=r&&r.spec.marks;"_"===s||null==s&&r.inlineContent?(a.attrs={type:a.type,attrs:a.attrs},a.type="unknown"):(i.splice(o,1),o--)}}}_editorConfig(){return{schema:this.schema,plugins:this._createPlugins()}}setElements({viewExtras:e,viewExtrasLive:t}){this.viewExtrasEl=e,this.viewExtrasLiveEl=t}createView(e){const t=this._options;let n={class:"tui-weka-editor",role:"textbox","aria-multiline":"true","aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,"aria-describedby":t.ariaDescribedby,"aria-invalid":t.ariaInvalid};return n["aria-label"]||n["aria-labelledby"]||(n["aria-label"]=t.placeholder||(0,k.langString)("pluginname","editor_weka")),this.view=new o.EditorView(e,{state:this.state,dispatchTransaction:this.dispatch,nodeViews:this._nodeViews,attributes:Object.entries(n).reduce(((e,[t,n])=>(null!=n&&(e[t]=n),e)),{}),editable:()=>(0,g.result)(this._editable)}),this.view.dom.addEventListener("focus",(e=>{this._options.onFocus&&this._options.onFocus(e)})),this.view.dom.addEventListener("blur",(e=>{this._options.onBlur&&this._options.onBlur(e)})),this.view}allVueComponents(){return this._allVueComponents}allStrings(){const e=[];return this._toolbarItems.forEach((function t(n){n.children&&n.children.forEach(t),n.label&&e.push(n.label)})),e.concat([(0,k.langString)("pluginname","editor_weka")])}getParent(){return this._parent}_componentNodeView(e,t,n,i,o){return new h.default(e,{editor:this,node:n,view:i,getPos:o,parent:this._parent,context:t})}dispatch(e){const t=this.state.apply(e);this.view&&!this.destroyed&&this.view.updateState(t),this.state=t,this._value=f.default.fromState(t,this),this._options.onTransaction&&this._options.onTransaction({value:this._value,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this._options.onUpdate&&this._options.onUpdate(this._value)}forceRerenderView(){if(!this.view)return;const e=i.EditorState.create(Object.assign({},this._editorConfig()));this.view.updateState(e),this.view.updateState(this.state)}getFileStorageItemId(){return this.fileStorage.getFileStorageItemId()}_createPlugins(){let e=[];return Array.isArray(this._plugins)&&(e=this._plugins),e.concat((0,y.default)(),(0,_.default)(this._options.placeholder),(0,c.inputRules)({rules:this._inputRules}),(0,a.keymap)((0,p.buildKeymap)(this.schema,this._mapKeys)),(0,a.keymap)(s.baseKeymap),(0,l.dropCursor)(),(0,d.gapCursor)(),(0,r.history)())}getToolbarItems(){return this._toolbarItemInstances.map((e=>e.update(this))),this._toolbarItems}execute(e){try{return e(this.state,this.dispatch,this.view)}catch(e){console.error("[Weka] Failed to execute command."),console.error(e);const t=(0,k.langString)("error_failed_to_execute","editor_weka");return(0,k.loadLangStrings)([t]).then((()=>(0,v.notify)({type:"error",message:t.toString()}))),!1}}canExecute(e){return e(this.state,null,null)}hasNode(e){return e in this.state.schema.nodes}destroy(){this.view&&this.view.destroy(),this.destroyed=!0}get identifier(){return{contextId:this._options.contextId||null,component:this._options.component||null,area:this._options.area||null,instanceId:this._options.instanceId||null}}get extensionFormatters(){return this._extensions.map((e=>e.applyFormatters.bind(e)))}setEditable(e){this._editable=e,this.view&&this.view.setProps({editable:()=>(0,g.result)(this._editable)})}getEditable(){return this._editable}_execSerializedVisitors(e,t){const n=[];this._extensions.forEach((e=>{const i=t+"SerializedVisitor";e[i]&&n.push(e[i]())})),n.length>0&&n.forEach((t=>(0,w.X)(e,t)))}}},OUqJ:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a}),n("Xz/0");var i=n("aWHr"),o=n("XdLR");class a{constructor(){this._editor=null,this._state=null,this._doc=null,this._html=null,this._map=null,Object.preventExtensions(this)}static fromState(e,t){const n=new a;return n._editor=t,n._state=e,n}static fromDoc(e){const t=new a;return t._doc=e,t}static fromHtml(e){const t=new a;return t._html=e,t}static empty(){return a.fromDoc((0,i.getDefaultDocument)())}inflated(e){return this._editor==e||this._map&&!!this._map[e.uid]}inflate(e,t){this._editor?(this._map||(this._map={}),this._map[e.uid]=t):(this._editor=e,this._state=t)}getState(e=null){return e?this._editor===e?this._state:this._map&&this._map[e.uid]?this._map[e.uid]:null:this._state}toJSON(){return this.getDoc(!0)}getDoc(e=!0){return e&&(this.applyFormatters(),this._doc=null),this._doc||(this._doc=JSON.parse(JSON.stringify(this._state.toJSON().doc)),this._reverseUnknownTransform(this._doc),this._doc&&this._editor&&this._editor._execSerializedVisitors(this._doc,"save")),this._doc}_reverseUnknownTransform(){(0,o.X)(this._doc,{any(e){"unknown_block"!==e.type&&"unknown_inline"!==e.type||(e.type=e.attrs.type,e.content=e.attrs.content,e.attrs=e.attrs.attrs),Array.isArray(e.marks)&&e.marks.forEach((e=>{"unknown"===e.type&&(e.type=e.attrs.type,e.attrs=e.attrs.attrs)}))}})}applyFormatters(){this._editor&&this._state&&this._editor.extensionFormatters.forEach((e=>{this._state=e(this._state)}))}hasHtml(){return!!this._html}getHtml(){return this._html}__isEmpty(){return this.isEmpty}get isEmpty(){if(this._state){const{doc:e}=this._state;return 0===e.childCount||1===e.childCount&&Boolean(e.firstChild.isTextblock)&&0===e.firstChild.content.size}if(this._doc){if(0===r(this._doc))return!0;if(1===r(this._doc)){const e=this._doc.content[0];return"paragraph"==e.type&&0===r(e)}return!1}return!0}get fileStorageItemId(){return this._editor?this._editor.getFileStorageItemId():null}}function r(e){return e&&e.content?e.content.length:0}},"cvQ+":(e,t,n)=>{"use strict";n.r(t),n.d(t,{getDraftFile:()=>p,getLinkMetadata:()=>l,getMediaType:()=>u,getRepositoryData:()=>d,prepareDraftFileArea:()=>c});const i=tui.require("tui/apollo_client");var o=n.n(i),a=n("gQ1V");const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"core_get_linkmetadata"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_url"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"link"},name:{kind:"Name",value:"core_get_linkmetadata"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"videoheight"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"videowidth"},arguments:[],directives:[]}]}}]}}]};var s=n("fZmM");async function l(e){return(await o().query({query:r,variables:{url:e}})).data.link}async function d(e){const{data:{repository_data:t}}=await o().query({query:a.Z,variables:{context_id:e},fetchPolicy:"no-cache"});return t}async function c(e=null){return console.warn("[editor_weka] The function prepareDraftFileArea had been deprecated, ","please use getRepositoryData instead"),d(e)}async function u({itemId:e,filename:t}){console.warn("[editor_weka] getMediaType had been deprecated, please use getDraftFile instead");const{media_type:n,mime_type:i}=await p({itemId:e,filename:t});return{mediaType:n,mimeType:i}}async function p({itemId:e,filename:t}){const{data:{file:n}}=await o().query({query:s.Z,variables:{item_id:e,filename:t},batch:!0});return n}},"8h8O":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var i=n("Aely"),o=n.n(i),a=n("7mX8"),r=n.n(a),s=n("EJOt"),l=n.n(s);const d=tui.require("editor_weka/components/editing/PositionedActionDropdown");var c=n.n(d),u=(n("51FK"),n("NBUY"),n("xIDV")),p=n("yQz/"),m=n.n(p);class h{constructor(e){this.editor=null,this.options=Object.assign({},e)}setEditor(e){this.editor=e}nodes(){return{}}marks(){return{}}plugins(){return[]}toolbarItems(){return[]}keymap(e){}inputRules(){return[]}getSchema(){return this.editor.schema}applyFormatters(e){return e}get doc(){return this.editor.state.doc}async showModal(e,t){const n=document.createElement("span");this.editor.viewExtrasEl.appendChild(n);const i={component:e,props:t};Object.preventExtensions(i),await r().loadRequirements(e);const o=new _({parent:this.editor.getParent(),propsData:{container:i}});return o.$mount(n),new Promise((e=>{o.$on("close-complete",(t=>{o.$destroy(),e(t)})),o.show()}))}showComponent(e,t){const n=document.createElement("span"),i=o().extend(e);this.editor.viewExtrasEl.appendChild(n);const a=new i(Object.assign({parent:this.editor.getParent()},t));return a.$mount(n),a}async showActionDropdown(e,{actions:t}){const n=this.editor.view.coordsAtPos(e),i=this.editor.viewExtrasEl.offsetParent.getBoundingClientRect();await(e=>{const t=m()("sleep");return new Promise((e=>setTimeout((()=>{t(),e()}),0)))})(),await(0,u.loadLangStrings)(t.map((e=>e.label)));const o=this.showComponent(c(),{propsData:{location:{x:n.left-i.left,y:n.bottom-i.top},actions:t}});return o.$on("dismiss",(()=>{o.$destroy(),o.$el.remove()})),o}removeNode(e){this.editor.execute(((t,n)=>{const i=t.tr,o=e();i.delete(o.from,o.to),n(i)}))}}const _=o().extend({props:{container:{type:Object}},data:()=>({result:null,open:!1}),methods:{show(){this.open=!0},requestClose(e){this.result=e,this.open=!1},closeComplete(){this.$emit("close-complete",this.result)}},render(e){return e(l(),{props:{open:this.open},on:{"request-close":this.requestClose,"close-complete":this.closeComplete}},[e(this.container.component,{props:this.container.props})])}})},cYZH:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var i=n("8h8O"),o=n("895m");const a=tui.require("tui/components/icons/AlignLeft");var r=n.n(a);const s=tui.require("tui/components/icons/AlignCenter");var l=n.n(s);const d=tui.require("tui/components/icons/AlignRight");var c=n.n(d);function u(e,t){return Boolean(e.spec.attrs&&e.spec.attrs[t])}function p(e,t,n,i){const o=function(e,t,n,i){let o=[];return e.nodesBetween(t,n,(e=>{if(!u(e.type,i))return;const t=e.attrs[i];o.includes(t)||o.push(t)})),o}(e,t,n,i);return!(o.length>1||0===o.length)&&o[0]}function m(e,t,n,i){return!!u(t.type,"align")&&e.setNodeMarkup(n,t.type,{...t.attrs,align:i})}var h=n("xIDV");class _ extends i.default{setAlignment(e,t){const{state:n}=e,{tr:i,selection:o}=n;this.editor.view.focus();const a=o.$from.blockRange(o.$to);if(!a)return!1;const r=a.$from.start(a.depth);return a.parent.nodesBetween(a.$from.pos-r,a.$to.pos-r,((e,n)=>{"right"===t&&(0,h.isRtl)()||"left"===t&&!(0,h.isRtl)()?m(i,e,n,void 0):m(i,e,n,t)}),r),!!i.docChanged&&(this.editor.dispatch(i),!0)}isAlignmentActive(e,t){const{state:n}=e,{selection:i}=n,o=p(n.doc,i.from,i.to,"align");return!(void 0!==o||!("left"===t&&!(0,h.isRtl)()||"right"===t&&(0,h.isRtl)()))||o===t}getAlignmentIcon(e){const{state:t}=e,{selection:n}=t;switch(p(t.doc,n.from,n.to,"align")){case"center":return l();case"right":return c();case"left":return r()}return(0,h.isRtl)()?c():r()}canSetAlignment(e){const{state:t}=e,{selection:n}=t;let i=!1;const o=n.$from.blockRange(n.$to);if(!o)return!1;const a=o.$from.start(o.depth);return o.parent.nodesBetween(o.$from.pos-a,o.$to.pos-a,(e=>{u(e.type,"align")&&(i=!0)}),a),i}toolbarItems(){return[new o.ToolbarItem({group:"text",label:(0,h.langString)("alignment","editor"),getIconComponent:this.getAlignmentIcon,enabled:e=>this.canSetAlignment(e),children:[new o.ToolbarItem({group:"text",label:(0,h.langString)("left","editor"),iconComponent:r(),execute:e=>this.setAlignment(e,"left"),active:e=>this.isAlignmentActive(e,"left")}),new o.ToolbarItem({group:"text",label:(0,h.langString)("centre","editor"),iconComponent:l(),execute:e=>this.setAlignment(e,"center"),active:e=>this.isAlignmentActive(e,"center")}),new o.ToolbarItem({group:"text",label:(0,h.langString)("right","editor"),iconComponent:c(),execute:e=>this.setAlignment(e,"right"),active:e=>this.isAlignmentActive(e,"right")})]})]}}const f=e=>new _(e)},RKiH:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>k});var i=n("8h8O");const o=tui.require("editor_weka/components/nodes/Attachment");var a=n.n(o);const r=tui.require("editor_weka/components/nodes/Attachments");var s=n.n(r);const l=tui.require("tui/components/icons/Attachment");var d=n.n(l),c=n("895m"),u=n("xIDV"),p=n("Sgz4"),m=n("E057"),h=n("Xz/0"),_=n("eqTj"),f=n("x7Rm"),g=n("MERh");class v extends i.default{constructor(e){void 0===e&&(e={}),super(e),this.acceptTypes=e.accepttypes||[]}nodes(){return{attachment:{schema:{inline:!0,atom:!0,attrs:{filename:{default:void 0},size:{default:void 0},option:{default:void 0},url:{default:void 0}},parseDOM:[{tag:"div.tui-wekaNodeAttachment",getAttrs:m.getJsonAttrs}],toDOM:e=>["div",{class:"tui-wekaNodeAttachment","data-attrs":JSON.stringify({filename:e.attrs.filename,option:e.attrs.option,url:e.attrs.url})}]},component:a(),componentContext:{convertToImage:this._convertToImage.bind(this),convertToVideo:this._convertToVideo.bind(this),convertToAudio:this._convertToAudio.bind(this),updateNode:this._updateNode.bind(this),hasImageNode:this._hasImageNode.bind(this),hasVideoNode:this._hasVideoNode.bind(this),removeNode:this.removeNode.bind(this),hasAudioNode:this._hasAudioNode.bind(this),getItemId:this._getItemId.bind(this),getDownloadUrl:this._getDownloadUrl.bind(this)}},attachments:{schema:{group:"block",allowGapCursor:!0,content:"attachment*",parseDOM:[{tag:"div.tui-wekaNodeAttachments"}],toDOM:()=>["div",{class:"tui-wekaNodeAttachments"},0]},component:s()}}}toolbarItems(){return this.editor.fileStorage.enabled?[new c.ToolbarItem({group:"embeds",label:(0,u.langString)("attachment","editor_weka"),iconComponent:d(),execute:e=>{(0,_.pickFiles)(e).then((e=>{this.startUploadingFiles(e)}))}})]:[]}plugins(){return this.editor.fileStorage.enabled?[(0,p.attachment)({onDrop:this._onDropEvent.bind(this),onKeyDown:this._onKeyDownEvent.bind(this)})]:[]}_findAttachmentCollectionBlock(e){const t=e.selection.$from,n=t.parent;if(!n||"attachments"!==n.type.name)return null;let i=t.pos;return e.selection.empty||(i+=1),{from:t.before(),to:t.after(),insertPoint:i,node:n}}async startUploadingFiles(e){try{const t=await this.editor.fileStorage.uploadFiles(e,this.acceptTypes);if(0===t.length)return;const n=this.editor.state.schema,i=this.editor.view;let o=i.state.tr,a=this._findAttachmentCollectionBlock(o);const r=t.map((({filename:e,url:t,file_size:i})=>n.node("attachment",{filename:e,url:t,size:i,option:{}})));if(a)o.insert(a.insertPoint,r),i.dispatch(o);else{const e=n.node("attachments",null,r),t=o.selection.$from.pos;i.dispatch(o.replaceWith(t,t,e))}}catch(e){console.error(e);const t=(0,u.langString)("error_upload_failed","editor_weka");(0,u.loadLangStrings)([t]).then((()=>(0,f.notify)({type:"error",message:t.toString()})))}}_onKeyDownEvent({view:e,event:t}){const{tr:n}=e.state,i=this._findAttachmentCollectionBlock(n);if(!i)return!1;if("Enter"===t.key){const t=e.state.schema.nodes.paragraph.createAndFill();return n.insert(i.to,t),n.setSelection(new h.TextSelection(n.doc.resolve(i.to+1))),e.dispatch(n),!0}if("Backspace"===t.key){if(!n.selection.$from.nodeBefore)return!1;if(1===i.node.content.size)return n.delete(i.from,i.to),e.dispatch(n),!0}return!1}_onDropEvent({event:e}){return!!(e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length)&&(e.preventDefault(),this.startUploadingFiles(e.dataTransfer.files),!0)}async _convertToImage(e,{filename:t,alttext:n}){const i=await this._getFileInfo(t);this.editor.execute(((o,a)=>{const r=o.schema.node("image",{filename:t,url:i.url,alttext:n});this._doConvertToMedia(r,o.tr,a,e)}))}async _convertToVideo(e,{filename:t,mimeType:n,subtitle:i}){const o=await this._getFileInfo(t);this.editor.execute(((a,r)=>{let s={filename:t,url:o.url,mime_type:n,subtitle:i};const l=a.schema.node("video",s);this._doConvertToMedia(l,a.tr,r,e)}))}async _updateNode(e,{filename:t,option:n,size:i,transcript:o}){const a=await this._getFileInfo(t);this.editor.execute(((r,s)=>{const l=r.tr,d=e();let c={filename:t,url:a.url,option:n,size:i};o&&(c.transcript={url:o.url,filename:o.filename}),s(l.replaceWith(d.from,d.to,r.schema.node("attachment",c))),this.editor.view.focus()}))}_hasImageNode(){return this.editor.hasNode("image")}_hasVideoNode(){return this.editor.hasNode("video")}_hasAudioNode(){return this.editor.hasNode("audio")}removeNode(e){this.editor.execute(((t,n)=>{const i=e();let o=t.tr;const a=(0,g.findParentNodeOfTypeClosestToPos)(o.doc.resolve(i.from),this.editor.schema.nodes.attachments);let r;r=1===a.node.content.size?h.NodeSelection.create(o.doc,a.pos):h.NodeSelection.create(o.doc,i.from),r.replace(o),n(o)}))}async _convertToAudio(e,{filename:t,mimeType:n,transcript:i}){let o={filename:t,url:(await this._getFileInfo(t)).url,mime_type:n,transcript:i};this.editor.execute(((t,n)=>{const i=t.schema.node("audio",o);this._doConvertToMedia(i,t.tr,n,e)}))}_doConvertToMedia(e,t,n,i){const o=i(),a=(0,g.findParentNodeOfTypeClosestToPos)(t.doc.resolve(o.from),this.editor.schema.nodes.attachments);let r;r=1===a.node.content.size?h.NodeSelection.create(t.doc,a.pos):h.NodeSelection.create(t.doc,o.from),r.replaceWith(t,e),n(t)}async _getFileInfo(e){return this.editor.fileStorage.getFileInfo(e)}async _getDownloadUrl(e){return(await this._getFileInfo(e)).download_url}_getItemId(){return this.editor.fileStorage.getFileStorageItemId()}}const k=e=>new v(e)},VIvA:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var i=n("8h8O"),o=n("895m"),a=n("xIDV");const r=tui.require("editor_weka/components/editing/EmojiSelector");var s=n.n(r);const l=tui.require("editor_weka/components/nodes/Emoji");var d=n.n(l);const c=tui.require("tui/components/icons/Emoji");var u=n.n(c),p=n("Aely"),m=n.n(p),h=n("//CD"),_=n("E057");class f extends i.default{constructor(e){super(e),void 0===e&&(e={}),this.emojis=e.emojis||[];let t=this.emojis.map((e=>e.pattern));this.charArray=t.toString().split(""),this.charArray=this.charArray.filter(((e,t)=>this.charArray.indexOf(e)===t))}nodes(){return{emoji:{schema:{group:"inline",inline:!0,attrs:{shortcode:{default:""}},parseDOM:[{tag:"span.tui-wekaNodeEmoji",getAttrs:_.getJsonAttrs}],toDOM:e=>["span",{class:"tui-wekaNodeEmoji","data-attrs":JSON.stringify({shortcode:e.attrs.shortcode})},String.fromCodePoint("0x"+e.attrs.shortcode)]},component:d()}}}plugins(){return[(0,h.default)(this.editor,this.emojis,this.charArray)]}toolbarItems(){return[new o.ToolbarItem({group:"embeds",popover:{title:"",component:this.getEmojiPopover()},label:(0,a.langString)("insertemoji","editor"),iconComponent:u(),enabled:e=>!!e.view.editable&&e.view.state.selection.$head.pos>0,reset:e=>{e.view.focus()}})]}getEmojiPopover(){return m().extend({data:()=>({insertEmoji:this.insertEmoji.bind(this),emojiData:this.emojis}),methods:{emojiSelected(e){this.$emit("close"),this.insertEmoji(e)}},render(e){return e(s(),{props:{emojis:this.emojiData},on:{"emoji-selected":this.emojiSelected}})}})}insertEmoji({shortcode:e}){this.editor.execute(((t,n)=>{const i=t.schema.node("emoji",{shortcode:e}),{from:o,to:a}=t.selection;n(t.tr.replaceWith(o,a,i)),this.editor.view.focus()}))}}const g=e=>new f(e)},"3N9S":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var i=n("8h8O"),o=n("ewWi");const a=tui.require("editor_weka/components/nodes/Hashtag");var r=n.n(a);const s=tui.require("editor_weka/helpers/suggestion");var l=n.n(s);n("Xz/0");class d extends i.default{nodes(){return{hashtag:{schema:{group:"inline",inline:!0,atom:!0,attrs:{text:{default:""}},parseDOM:[{tag:"span.tui-wekaNodeHashtag",getAttrs(e){try{return{text:e.textContent.trim().slice(1)}}catch(e){return{}}}}],toDOM:e=>["span",{class:"tui-wekaNodeHashtag"},"#"+e.attrs.text]},component:r()}}}plugins(){return[(0,o.default)(this.editor)]}applyFormatters(e){const t=new(l())(this.editor);let n=e.tr;return e.doc.nodesBetween(0,e.doc.nodeSize-2,((i,a)=>{if(i.isText){o.REGEX.lastIndex=0;let i=e.doc.resolve(a),r=t.matcher(o.REGEX,i);for(;r;)n=n.replaceWith(n.mapping.map(r.range.from),n.mapping.map(r.range.to),e.schema.node("hashtag",{text:r.text.slice(1)})),r=t.matcher(o.REGEX,i)}})),n.docChanged?(this.editor.dispatch(n),this.editor.state):e}}const c=e=>new d(e)},ZSGL:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>F});const i=tui.require("editor_weka/toolbar");var o=n("xIDV"),a=n("Xz/0"),r=n("51FK"),s=n("wQtR"),l=n("8h8O");const d=tui.require("editor_weka/lib/prosemirror_utils/helpers");var c=n("MERh"),u=n("ASUJ");const p=tui.require("editor_weka/components/nodes/LayoutBlock");var m=n.n(p);const h=tui.require("editor_weka/components/nodes/LayoutColumn");var _=n.n(h);const f=tui.require("tui/components/icons/Add");var g=n.n(f),v=n("AQw4"),k=n.n(v),w=n("hd/h"),y=n.n(w),b=n("5TpV"),x=n.n(b),N=n("KTPV"),I=n.n(N),S=n("Pspb"),A=n.n(S),C=n("PWfy"),T=n.n(C);class M extends l.default{nodes(){return{layout_block:{schema:{group:"rootblock",content:"layout_column+",isolating:!0,defining:!0,parseDOM:[{tag:"div.jsoneditor-layout-block"}],toDOM:()=>["div",{class:"jsoneditor-layout-block"},0]},component:m(),componentContext:{getLayoutBlockDetails:B,updateLayout:this.updateLayout.bind(this),deleteLayout:this.deleteLayout.bind(this)}},layout_column:{schema:{content:"block+",isolating:!0,defining:!0,attrs:{type:{default:void 0}},parseDOM:[{tag:"div.jsoneditor-layout-column--sidebar",attrs:{type:"sidebar"}},{tag:"div.jsoneditor-layout-column",attrs:{type:void 0}}],toDOM(e){const t=["jsoneditor-layout-column"];return"sidebar"===e.attrs.type&&t.push("jsoneditor-layout-column--sidebar"),["div",{class:t.join(" ")},0]}},component:_()}}}getLayoutOptions(){return[{label:(0,o.langString)("layout_one_column","editor_weka"),iconComponent:y(),columns:[{}]},{label:(0,o.langString)("layout_two_column","editor_weka"),columns:[{},{}],iconComponent:x()},{label:(0,o.langString)("layout_narrow_left_column","editor_weka"),columns:(0,o.isRtl)()?[{},{type:"sidebar"}]:[{type:"sidebar"},{}],iconComponent:I()},{label:(0,o.langString)("layout_narrow_right_column","editor_weka"),columns:(0,o.isRtl)()?[{type:"sidebar"},{}]:[{},{type:"sidebar"}],iconComponent:A()},{label:(0,o.langString)("layout_three_column","editor_weka"),columns:[{},{},{}],iconComponent:T()}]}toolbarItems(){return[new i.ToolbarItem({group:"layout",label:(0,o.langString)("layout","editor"),iconComponent:k(),children:[(0,i.cmdItem)(E,{label:(0,o.langString)("add_layout","editor_weka"),iconComponent:g(),type:"button"}),new i.ToolbarItem({type:"separator"}),...this.getLayoutOptions().map(O)]})]}updateLayout(e,{columns:t}){const n=this.editor.state,i=e(),o=D({columns:t},n.doc.nodeAt(i.from));let r=n.tr;r.replaceWith(i.from,i.to,o),r.setSelection(a.Selection.near(r.doc.resolve(i.from+2))),this.editor.dispatch(r),this.editor.view.focus()}deleteLayout(e){this.editor.execute(((t,n)=>{const i=e();n(t.tr.delete(i.from,i.to))}))}}function $({columns:e}){return(t,n)=>{if(e.length<1)return!1;if(!n)return!0;const{selection:i}=t,{layout_block:o,layout_column:r}=t.schema.nodes,s=o.create(null,e.map((e=>r.createAndFill({type:e.type}))));let l=t.tr;l.insert(i.to,s);const c=l.mapping.maps.length;let p=(0,u.getInsertedPos)(l);if(null!=p){if(!i.empty){const e=p+2;l.replace(e,e+s.content.child(0).content.size,t.doc.slice(i.from,i.to)),l.delete(i.from,i.to)}if(i.empty&&(0,d.isEmptyParagraph)(i.$from.parent)){const e=l.mapping.map(i.$from.before());l.delete(e,e+i.$from.parent.nodeSize)}p=l.mapping.slice(c).map(p);const e=l.doc.nodeAt(p+1).content.size;l.setSelection(a.Selection.near(l.doc.resolve(p+2+e),-1))}return n(l),!0}}function D({columns:e},t){const{layout_block:n,layout_column:i}=t.type.schema.nodes,o=e.length;return n.create(null,e.map(((e,n)=>{const a={type:e.type},s=t.maybeChild(n);let l=s?s.content:r.Fragment.empty;if(n===o-1)for(let e=n+1;e<t.childCount;e++){const n=t.child(e);1===n.childCount&&(0,d.isEmptyParagraph)(n.child(0))||(l=l.append(n.content))}return i.createAndFill(a,l)||i.create(a)})))}function E(e,t){const n=(0,c.findParentNodeOfTypeClosestToPos)(e.selection.$from,e.schema.nodes.layout_block);return $(n?B(n.node):{columns:[{},{}]})(e,t)}function B(e){const t=[];return e.forEach((e=>{t.push({...e.attrs})})),{columns:t}}function O(e){const t=(0,s.chainCommands)(function(e){return(t,n)=>{const i=(0,c.findParentNodeOfTypeClosestToPos)(t.selection.$from,t.schema.nodes.layout_block);if(!i)return!1;if(n){const o=D(e,i.node),r=t.tr;r.replaceWith(i.pos,i.pos+i.node.nodeSize,o),r.setSelection(a.Selection.near(r.doc.resolve(i.pos+2))),n(r)}return!0}}(e),$(e));return(0,i.cmdItem)(t,{label:e.label,iconComponent:e.iconComponent})}const F=e=>new M(e)},xZEP:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>E});var i=n("8h8O"),o=n("E057");const a=tui.require("editor_weka/components/nodes/LinkBlock");var r=n.n(a);const s=tui.require("editor_weka/components/nodes/LinkMedia");var l=n.n(s);const d=tui.require("editor_weka/components/marks/Link");var c=n.n(d);const u=tui.require("editor_weka/components/editing/EditLinkModal");var p=n.n(u);const m=tui.require("tui/components/icons/Link");var h=n.n(m),_=n("Xz/0"),f=n("51FK"),g=n("xIDV"),v=n("895m"),k=n("cvQ+"),w=n("ZSGX"),y=n("zENn"),b=n("U0bO"),x=n("x7Rm");const N=/\bhttps?:\/\/[-a-zA-Z0-9@:%._+~#=]+\b(?:[-a-zA-Z0-9@:%_+.~#?&//=]*)/g,I=/\b[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?/g,S=["link_block","link_media"];class A extends i.default{constructor(e){super(e),this.isMedia=this.isMedia.bind(this),this._convertPastedUrl=this._convertPastedUrl.bind(this),this._convertPastedEmail=this._convertPastedEmail.bind(this),this._getSelectionRange=this._getSelectionRange.bind(this)}nodes(){return{link_media:{schema:{group:"block",atom:!0,attrs:{url:{},loading:{default:void 0},type:{default:void 0},image:{default:void 0},title:{default:void 0},description:{default:void 0},siteName:{default:void 0},resolution:{default:void 0}},parseDOM:[{tag:".tui-wekaNodeLinkMedia",getAttrs:o.getJsonAttrs}],toDOM:e=>["a",{class:"tui-wekaNodeLinkMedia","data-attrs":JSON.stringify(e.attrs),href:e.attrs.url},e.attrs.url]},component:l(),componentContext:{urlPlugin:this.urlPlugin.bind(this),editCard:this.editCard.bind(this),replaceWithTextLink:this.replaceWithTextLink.bind(this)}},link_block:{schema:{group:"block",atom:!0,attrs:{url:{},type:{default:void 0},image:{default:void 0},title:{default:void 0},description:{default:void 0},siteName:{default:void 0},open_in_new_window:{default:void 0}},parseDOM:[{tag:".tui-wekaNodeLinkBlock",getAttrs:e=>{let t=(0,o.getJsonAttrs)(e);return t.open_in_new_window=!!e.getAttribute("target"),t.target=void 0,t}}],toDOM:e=>["a",{class:"tui-wekaNodeLinkBlock","data-attrs":JSON.stringify(e.attrs),href:e.attrs.url,target:e.attrs.open_in_new_window?"_blank":null},e.attrs.url]},component:r(),componentContext:{editCard:this.editCard.bind(this),replaceWithTextLink:this.replaceWithTextLink.bind(this)}}}}marks(){return{link:{schema:{attrs:{href:{},title:{default:void 0},open_in_new_window:{default:void 0}},inclusive:!1,parseDOM:[{tag:"a[href]:not([class*=tui-weka])",getAttrs:e=>({href:e.getAttribute("href"),title:e.getAttribute("title"),open_in_new_window:!!e.getAttribute("target")})}],toDOM(e){let{href:t,title:n}=e.attrs;return["a",{href:t,title:n,target:e.attrs.open_in_new_window?"_blank":void 0},0]}},component:c(),componentContext:{showMarkDropdown:this.showMarkDropdown.bind(this)}}}}plugins(){return[new _.Plugin({props:{transformPasted:e=>{let t=M(e.content,{convert:this._convertPastedUrl},N);return t=M(t,{convert:this._convertPastedEmail},I),new f.Slice(t,e.openStart,e.openEnd)}}})]}toolbarItems(){return[new v.ToolbarItem({group:"embeds",label:(0,g.langString)("link","editor_weka"),iconComponent:h(),execute:()=>{this.editLink()}})]}loadSerializedVisitor(){return{link_media:e=>{delete e.attrs.loading,Array.isArray(e.attrs.resolution)&&delete e.attrs.resolution}}}saveSerializedVisitor(){return{link_media:e=>{delete e.attrs.loading}}}editLink(){const e=this.getSchema().marks.link,t=this._getSelectionRange();if(t.from===t.to){const n=(0,y.getMarkRange)(this.doc.resolve(t.from),e);if(n)return void this._editMarkAt((()=>n))}const n=this.doc.textBetween(t.from,t.to);this.showModal(p(),{isNew:!0,isMedia:this.isMedia,attrs:{url:"",text:n,open_in_new_window:void 0},save:async e=>{const t=await this._prepareLinkUpdate(e);this._updateLink({type:null,getRange:this._getSelectionRange},t),this.editor.view.focus()}})}replaceWithTextLink(e,{url:t}){this.editor.execute(((n,i)=>{let o=t;t.startsWith("mailto:")&&(o=t.substring("mailto:".length));const a=n.schema.text(o,[n.schema.mark("link",{href:t})]),r=e();i(n.tr.replaceWith(r.from,r.to,a))}))}urlPlugin(e){return this._findLinkPlugin(e)}isMedia(e){return!!this._findLinkPlugin({type:"media",url:e})}editCard(e){const t=this.doc.nodeAt(e().from),n=t.type.name;S.includes(n)&&this.showModal(p(),{isMedia:this.isMedia,attrs:{type:n,url:t.attrs.url,open_in_new_window:t.attrs.open_in_new_window},save:async t=>{const i=await this._prepareLinkUpdate(t);this._updateLink({type:n,getRange:e},i),this.editor.view.focus()}})}showMarkDropdown(e){const t=this._getLinkMark(e);if(!t)return;const n=t&&this.isMedia(t.attrs.href),i=t&&t.attrs.href.startsWith("mailto:"),o=[{label:(0,g.langString)("go_to_link_label","editor_weka"),action:()=>this._openLinkMarkAt(e)},{label:(0,g.langString)("edit","core"),action:()=>this._editMarkAt(e)}];return i||o.push({label:n?(0,g.langString)("display_as_embedded_media","editor_weka"):(0,g.langString)("display_as_card","editor_weka"),action:()=>this._markToCardAt(n?"link_media":"link_block",e)}),o.push({label:(0,g.langString)("delete","editor_weka"),action:()=>this._removeMarkAt(e)}),"link"==t.type.name&&o.push({label:(0,g.langString)("remove_link_target","editor_weka"),action:()=>{this._removeLink(e)}}),this.showActionDropdown(e().from,{actions:o})}_findLinkPlugin({type:e,url:t}){for(let n=0;n<T.length;n++){const i=T[n];if(!e||i.type===e)for(let e=0;e<i.matches.length;e++){const n=i.matches[e],o=n.match.exec(t);if(o)return{plugin:i,details:n.details?n.details(o):{}}}}return null}_updateLink(e,t){e||(e={type:null,getRange:this._getSelectionRange});let n=null;if("link"===e.type||null===e.type){const t=e.getRange();n=this.doc.textBetween(t.from,t.to)}this.editor.execute(((i,o)=>{const a=(0,y.expandContentResolvedRange)(y.ResolvedRange.resolve(this.doc,e.getRange()));if("link"==t.type){const r=i.schema.marks.link,s=t.text||t.url,l=r.create({href:t.url,open_in_new_window:t.open_in_new_window});let d;d="link"==e.type&&n&&s===n?i.tr.removeMark(a.$from.pos,a.$to.pos,r).addMark(a.$from.pos,a.$to.pos,l):i.tr.replaceWith(a.$from.pos,a.$to.pos,s?i.schema.text(s,[l]):f.Fragment.empty),o(d)}else S.includes(t.type)&&o(i.tr.replaceWith(a.$from.pos,a.$to.pos,t.content))}))}async _prepareLinkUpdate(e){let{type:t,url:n,text:i,open_in_new_window:o}=e;if(n.startsWith("mailto:"))return this._createEmailLinkUpdate(e);if(S.includes(t)){const e=this.editor.state.schema,i=(!t||"link_media"==t)&&this._findLinkPlugin({type:"media",url:n});if(i){let o;if(i.plugin.nodeAttrs)try{o=await i.plugin.nodeAttrs({url:n})}catch(e){o={},console.error(e)}return new C({type:t,url:n,content:e.node("link_media",Object.assign({url:n},o))})}{let i;try{i=null===(a=await(0,k.getLinkMetadata)(n))?null:$((0,b.pick)(a,["url","image","title","description"])),i||(i={}),i.open_in_new_window=o}catch(e){console.error(e),i={}}return new C({type:t,url:n,content:e.node("link_block",Object.assign({url:n},i))})}}var a;return new C({type:"link",url:n,text:i,open_in_new_window:o})}_createEmailLinkUpdate({url:e,text:t}){return t||(t=e.substring("mailto:".length)),new C({type:"link",url:e,text:t})}_convertPastedEmail(e){return this._convertPastedUrl(`mailto:${e}`)}_convertPastedUrl(e){const t=this.getSchema().marks.link,n=this.getSchema().nodes.link_media,i=this._findLinkPlugin({type:"media",url:e});if(i){const t={url:e};i.plugin.nodeAttrs&&(t.loading=!0);const o=n.create(t);return t.loading&&i.plugin.nodeAttrs({url:e}).then((t=>{this._updatePastedMedia(e,t)})).catch((t=>{console.error(t),this._updatePastedMedia(e,{})})),o}return t.create({href:e})}_updatePastedMedia(e,t){const n=this.getSchema().nodes.link_media;let i=this.editor.state.tr;this.editor.state.doc.descendants(((o,a)=>{if(o.type==n&&o.attrs.loading&&o.attrs.url===e){const e=Object.assign({},o.attrs,{loading:!1},t);i=(0,w.setAttrs)(a,e)(i)}})),i.setMeta("addToHistory",!1),this.editor.dispatch(i)}_getSelectionRange(){return(0,b.pick)(this.editor.state.selection,["from","to"])}_getLinkMark(e){return(0,y.getMark)(this.doc.resolve(e().from),this.getSchema().marks.link)}_openLinkMarkAt(e){const t=this._getLinkMark(e);t&&window.open(t.attrs.href)}_editMarkAt(e){const t=e(),n=this._getLinkMark(e);if(!n)return;const i=n.attrs.href;let o=this.doc.textBetween(t.from,t.to);i===o&&(o=null),this.showModal(p(),{isMedia:this.isMedia,attrs:{url:i,text:o,open_in_new_window:n.attrs.open_in_new_window},save:async t=>{const n=await this._prepareLinkUpdate(t);this._updateLink({type:"link",getRange:e},n),this.editor.view.focus()}})}async _markToCardAt(e,t){const n=this._getLinkMark(t);if(!n)return;let i;try{i=await this._prepareLinkUpdate({type:e,url:n.attrs.href,open_in_new_window:n.attrs.open_in_new_window})}catch(e){return void async function(){const e=(0,g.langString)("error_no_url_info","editor_weka");await(0,g.loadLangStrings)([e]),(0,x.notify)({type:"error",message:e.toString()})}()}this._updateLink({type:"link",getRange:t},i),this.editor.view.focus()}_removeLink(e){this.editor.execute(((t,n)=>{const i=e(),o=this.doc.resolve(i.from).nodeAfter;let a=t.schema.text(o.text);n(t.tr.replaceWith(i.from,i.to,a))}))}_removeMarkAt(e){this.editor.execute(((t,n)=>{const i=(0,y.expandContentResolvedRange)(y.ResolvedRange.resolve(this.doc,e()));n(t.tr.delete(i.$from.pos,i.$to.pos))})),this.editor.view.focus()}keymap(e){e("Mod-k",(()=>(this.editLink(),!0)))}}class C{constructor(e){Object.assign(this,e)}}const T=[{key:"youtube",type:"media",name:"YouTube",matches:[{match:/^https?:\/\/(?:www\.)?youtube.com\/watch\?v=([a-zA-Z0-9_-]+)/,details:e=>({id:e[1]})},{match:/^https?:\/\/(?:www\.)?youtu.be\/([a-zA-Z0-9_-]+)/,details:e=>({id:e[1]})}],nodeAttrs:async({url:e})=>D(await(0,k.getLinkMetadata)(e))},{key:"vimeo-private",type:"media",name:"Vimeo private",matches:[{match:/^https?:\/\/(?:www\.)?vimeo.com\/([0-9]+)\/([0-9a-zA-Z]+)/,details:e=>({id:e[1],privateString:e[2]})}],nodeAttrs:async({url:e})=>D(await(0,k.getLinkMetadata)(e))},{key:"vimeo",type:"media",name:"Vimeo",matches:[{match:/^https?:\/\/(?:www\.)?vimeo.com\/([0-9]+)/,details:e=>({id:e[1]})}],nodeAttrs:async({url:e})=>D(await(0,k.getLinkMetadata)(e))},{key:"image",type:"media",name:"Image",matches:[{match:/\.(png|jpe?g|gif|webp|avif)$/}]},{key:"audio",type:"media",name:"Audio",matches:[{match:/\.(aac|flac|m4a|mp3|ogg|opus|wav|wma)$/}]}];function M(e,t,n){const i=[];return e.forEach((function(e){if(e.isText){const o=e.text;let a,r=0;for(n.lastIndex=0;a=n.exec(o);){const n=a.index,s=n+a[0].length;n>0&&i.push(e.cut(r,n));const l=o.slice(n,s),d=t.convert(l);d instanceof f.Node?i.push(d):d instanceof f.Mark?i.push(e.cut(n,s).mark(d.addToSet(e.marks))):i.push(e.cut(n,s)),r=s}r<o.length&&i.push(e.cut(r))}else i.push(e.copy(M(e.content,t,n)))})),f.Fragment.fromArray(i)}const $=e=>{const t={};for(const n in e)null!=e[n]&&(t[n]=e[n]);return t};function D(e){if(null===e)return null;const t=$((0,b.pick)(e,["url","image","title","description"])),n=Number(e.videowidth),i=Number(e.videoheight);return t.resolution=isNaN(n)||isNaN(i)?void 0:{width:n,height:i},t}const E=e=>new A(e)},"0NKw":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var i=n("8h8O"),o=n("xIDV"),a=n("895m"),r=n("TXPb"),s=n("wAp3"),l=n("R3Ws");const d=tui.require("tui/components/icons/ListOrdered");var c=n.n(d);const u=tui.require("tui/components/icons/ListUnordered");var p=n.n(u);const m=["ol",0],h=["ul",0],_=["li",0];class f extends i.default{nodes(){return{bullet_list:{schema:{content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>h}},ordered_list:{schema:{content:"list_item+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?+e.getAttribute("start"):1})}],toDOM:e=>1==e.attrs.order?m:["ol",{start:e.attrs.order},0]}},list_item:{schema:{content:"paragraph block*",parseDOM:[{tag:"li"}],toDOM:()=>_,defining:!0,draggable:!1}}}}toolbarItems(){const{bullet_list:e,ordered_list:t,list_item:n}=this.getSchema().nodes,i=[e,t];return[(0,a.cmdItem)((0,r.toggleList)(e,n,i),{group:"text",label:(0,o.langString)("bulletlist","editor"),iconComponent:p(),active:t=>(0,r.isListActive)(t.state,e)}),(0,a.cmdItem)((0,r.toggleList)(t,n,i),{group:"text",label:(0,o.langString)("numberedlist","editor"),iconComponent:c(),active:e=>(0,r.isListActive)(e.state,t)})]}keymap(e){const{bullet_list:t,ordered_list:n,list_item:i}=this.getSchema().nodes,o=[t,n];e("Shift-Ctrl-8",(0,r.toggleList)(t,i,o)),e("Shift-Ctrl-9",(0,r.toggleList)(n,i,o)),e("Enter",(0,s.splitListItem)(i)),e("Shift-Tab",(0,s.liftListItem)(i)),e("Tab",(0,s.sinkListItem)(i))}inputRules(){const{bullet_list:e,ordered_list:t}=this.getSchema().nodes;return[(n=e,(0,l.wrappingInputRule)(/^\s*([-+*])\s$/,n)),g(t)];var n}}function g(e){return(0,l.wrappingInputRule)(/^(\d+)\.\s$/,e,(e=>({order:+e[1]})),((e,t)=>t.childCount+t.attrs.order==+e[1]))}const v=e=>new f(e)},m5uz:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>C});var i=n("8h8O"),o=n("895m"),a=n("xIDV"),r=n("eqTj");const s=tui.require("editor_weka/components/nodes/ImageBlock");var l=n.n(s);const d=tui.require("editor_weka/components/nodes/VideoBlock");var c=n.n(d);const u=tui.require("editor_weka/components/nodes/AudioBlock");var p=n.n(u);const m=tui.require("editor_weka/components/nodes/FigureCaption");var h=n.n(m),_=n("vujW"),f=n.n(_),g=n("/N6l"),v=n("E057"),k=n("x7Rm"),w=n("Xz/0"),y=n("51FK");const b=tui.require("editor_weka/transaction");var x=n("U0bO");const N=tui.require("editor_weka/lib/prosemirror_utils/transforms"),I=new w.PluginKey("figure");class S extends i.default{constructor(e){super(e),this.acceptTypes=e.accept_types||[]}nodes(){return{figure:{schema:{content:"image? figure_caption",group:"block",parseDOM:[{tag:"figure"}],toDOM:()=>["figure",0],atom:!1,isolating:!0,defining:!0,selectable:!1,allowGapCursor:!1}},figure_caption:{schema:{content:"inline*",parseDOM:[{tag:"figcaption"}],toDOM:()=>["figcaption",0],selectable:!1,draggable:!1,atom:!1},component:h()},image:{schema:{atom:!0,group:"block",inline:!1,selectable:!0,attrs:{filename:{},url:{default:void 0},alttext:{default:void 0},display_size:{default:void 0}},parseDOM:[{tag:"div.tui-wekaNodeImageBlock",getAttrs:v.getJsonAttrs},{tag:"div.tui-imageBlock",getAttrs:v.getJsonAttrs}],toDOM:e=>["div",{class:"tui-wekaNodeImageBlock","data-attrs":JSON.stringify((0,x.pick)(e.attrs,["filename","alttext","url","display_size"]))}]},component:l(),componentContext:{replaceWithAttachment:this._replaceImageWithAttachment.bind(this),replaceWithFigure:this._replaceImageWithFigure.bind(this),updateImage:this._updateImage.bind(this),hasAttachmentNode:this._hasAttachmentsNode.bind(this),removeNode:this.removeNode.bind(this),getItemId:this._getItemId.bind(this),getDownloadUrl:this._getDownloadUrl.bind(this)}},video:{schema:{atom:!0,group:"block",inline:!1,attrs:{filename:{default:void 0},url:{default:void 0},mime_type:{default:void 0},subtitle:{default:void 0}},parseDOM:[{tag:"div.tui-wekaNodeVideoBlock",getAttrs:v.getJsonAttrs},{tag:"div.tui-videoBlock",getAttrs:v.getJsonAttrs}],toDOM(e){let t={filename:e.attrs.filename,url:e.attrs.url,mime_type:e.attrs.mime_type,subtitle:e.attrs.subtitle};return["div",{class:"tui-wekaNodeVideoBlock","data-attrs":JSON.stringify(t)}]}},component:c(),componentContext:{replaceWithAttachment:this._replaceVideoWithAttachment.bind(this),hasAttachmentNode:this._hasAttachmentNode.bind(this),removeNode:this.removeNode.bind(this),getFileUrl:()=>null,getItemId:this._getItemId.bind(this),getDownloadUrl:this._getDownloadUrl.bind(this),getContextId:this._getContextId.bind(this),updateVideoWithSubtitle:this._updateVideoWithSubtitle.bind(this)}},audio:{schema:{atom:!0,group:"block",inline:!1,attrs:{filename:{default:void 0},url:{default:void 0},mime_type:{default:void 0},transcript:{default:void 0}},parseDOM:[{tag:"div.tui-wekaNodeAudioBlock",getAttrs:v.getJsonAttrs},{tag:"div.tui-audioBlock",getAttrs:v.getJsonAttrs}],toDOM:e=>["div",{class:"tui-wekaNodeAudioBlock","data-attrs":JSON.stringify({filename:e.attrs.filename,url:e.attrs.url,mime_type:e.attrs.mime_type,transcript:e.attrs.transcript})}]},component:p(),componentContext:{hasAttachmentNode:this._hasAttachmentNode.bind(this),replaceWithAttachment:this._replaceAudioWithAttachment.bind(this),removeNode:this.removeNode.bind(this),getFileUrl:()=>null,getItemId:this._getItemId.bind(this),getDownloadUrl:this._getDownloadUrl.bind(this),getContextId:this._getContextId.bind(this),updateAudioWithTranscript:this._updateAudioWithTranscript.bind(this)}}}}plugins(){return[new w.Plugin({key:I,props:{handleKeyDown(e,t){if("Enter"!==t.key)return;const{state:n}=e,{selection:i,doc:o}=n;if(0===i.$from.depth)return;if("figure_caption"!==o.nodeAt(i.$from.before()).type.name)return;const a=n.tr,r=o.resolve(i.$from.before()),s=e.state.schema.nodes.paragraph.createAndFill();return a.insert(r.after(),s),a.setSelection(new w.TextSelection(a.doc.resolve(r.after()+1))),e.dispatch(a),!0}},appendTransaction(e,t,n){let{selection:i,doc:o}=n,a=null;const r=()=>(a||(a=n.tr),a);return o.nodesBetween(0,o.nodeSize-2,((s,l)=>{if("figure"!==s.type.name){if("figure_caption"===s.type.name){const e=o.resolve(l);if(0!==s.childCount)return;if(i.head>=e.start()&&i.head<=e.end())return;const t=e.start();a=A(r,o,a?a.mapping.map(t):t)||a}}else{if(2===s.childCount)return;if(r(),e[0]&&e[0].meta&&e[0].meta.paste){let i=w.NodeSelection.create(t.doc,a.mapping.map(l)).node,o=e[0].steps[0].slice.content.content[0].textContent.length,r=w.NodeSelection.create(a.doc,a.mapping.map(l)),d=n.schema.node(i.type,i.attrs,s.content.content[0].content);r.replaceWith(a,d);let c=w.TextSelection.create(a.doc,a.mapping.map(l)+o+1);return void a.setSelection(c)}a.delete(a.mapping.map(l),a.mapping.map(l+s.nodeSize))}})),a}})]}toolbarItems(){return this.editor.fileStorage.enabled?[new o.ToolbarItem({group:"embeds",label:(0,a.langString)("embedded_media","editor_weka"),iconComponent:f(),execute:e=>{(0,r.pickFiles)(e).then((async e=>{e&&this._startUploading(e)}))}})]:[]}async _startUploading(e){try{const t=await this.editor.fileStorage.uploadFiles(e,this.acceptTypes);if(0===t.length)return;const n=this.editor.state.schema,i=await Promise.all(t.map((({filename:e,url:t,media_type:i,mime_type:o})=>g.IMAGE===i?n.node("image",{filename:e,alttext:null,url:t}):g.VIDEO===i?n.node("video",{filename:e,url:t,mime_type:o,subtitle:null}):n.node("audio",{url:t,filename:e,mime_type:o,transcript:null}))));this.editor.execute(((e,t)=>{let n=e.tr;n=(0,N.safeInsert)(i.length>1?y.Fragment.fromArray(i):i[0])(n),t(n),this.editor.view.focus()}))}catch(e){if(console.error(e),e instanceof r.UploadError)(0,k.notify)({type:"error",message:e.message});else{const e=(0,a.langString)("error_upload_failed","editor_weka");(0,a.loadLangStrings)([e]).then((()=>(0,k.notify)({type:"error",message:e.toString()})))}}}async _replaceImageWithAttachment(e,{filename:t,alttext:n,size:i}){const o=await this._getFileInfo(t);this.editor.execute(((a,r)=>{let s=e();const l=this.editor.state.doc.resolve(s.from),d=l.parent;let c=a.tr;if(d&&d.type&&"figure"===d.type.name){const e=l.before();c=A((()=>c),c.doc,e)||c,s={from:e,to:e+d.nodeSize}}let u=a.schema.node("attachment",{filename:t,url:o.url,size:i,option:{alttext:n}});r(c.replaceWith(s.from,s.to,a.schema.node("attachments",null,[u])))}))}async _replaceFigureWithImage(e){this.editor.execute(((t,n)=>{const i=e();let o=A((()=>t.tr),t.doc,i.from)||!1;o&&n(o)}))}async _replaceImageWithFigure(e){this.editor.execute(((t,n)=>{const{tr:i,doc:o,schema:a}=t,r=e(),s=o.resolve(r.from),l=s.parent;if(l&&l.type&&"figure"===l.type.name){const e=o.nodeAt(r.from+s.nodeAfter.nodeSize);return i.setSelection(w.TextSelection.between(o.resolve(r.from+1),o.resolve(r.from+1+e.nodeSize))),n(i),void this.editor.view.focus()}const d=o.nodeAt(r.from),c=a.node("figure_caption",null,[]),u=a.node("figure",null,[d,c]);if(!s.parent.canReplaceWith(s.index(),s.index()+1,u.type))return;i.replaceWith(r.from,r.to,u);const p=r.from+u.nodeSize-c.nodeSize;i.setSelection(w.TextSelection.create(i.doc,p,p)),n(i.scrollIntoView()),this.editor.view.focus()}))}async _replaceVideoWithAttachment(e,{filename:t,size:n,subtitle:i}){const o=await this._getFileInfo(t);this.editor.execute(((a,r)=>{const s=a.tr,l=e();let d={filename:t,url:o.url,size:n,option:{}};i&&(d.option.subtitle={url:i.url,filename:i.filename});let c=a.schema.node("attachment",d);r(s.replaceWith(l.from,l.to,a.schema.node("attachments",null,[c])))}))}async _updateVideoWithSubtitle(e,{filename:t,url:n,mime_type:i,subtitle:o}){this.editor.execute(((a,r)=>{const s=a.tr,l=e();let d={filename:t,url:n,mime_type:i};d.subtitle=o?{filename:o.filename,url:o.url}:o;const c=a.schema.node("video",d);r(s.replaceWith(l.from,l.to,c))}))}async _updateImage(e,t){this.editor.execute(((n,i)=>{const o=n.tr,a=e().from,r=n.doc.nodeAt(a);i((0,b.setAttrs)(a,{...r.attrs,...t})(o))}))}async _replaceAudioWithAttachment(e,{filename:t,size:n,transcript:i}){const o=await this._getFileInfo(t);this.editor.execute(((a,r)=>{const s=a.tr,l=e();let d={filename:t,url:o.url,size:n,option:{}};i&&(d.option.transcript={url:i.url,filename:i.filename});let c=a.schema.node("attachment",d);r(s.replaceWith(l.from,l.to,a.schema.node("attachments",null,[c])))}))}async _updateAudioWithTranscript(e,{filename:t,url:n,mime_type:i,transcript:o}){this.editor.execute(((a,r)=>{const s=a.tr,l=e();let d={filename:t,url:n,mime_type:i};o&&(d.transcript={filename:o.filename,url:o.url});let c=a.schema.node("audio",d);r(s.replaceWith(l.from,l.to,c))}))}_hasAttachmentNode(){return this.editor.hasNode("attachment")}_hasAttachmentsNode(){return this.editor.hasNode("attachments")}async _getFileInfo(e){return this.editor.fileStorage.getFileInfo(e)}async _getDownloadUrl(e){return(await this._getFileInfo(e)).download_url}_getItemId(){return this.editor.fileStorage.getFileStorageItemId()}_getContextId(){return this.editor.identifier.contextId}}function A(e,t,n){const i=t.resolve(n),o=i.parent;if("figure"!==o.type.name)return!1;const a=t.nodeAt(n),r=i.before(),s=t.resolve(r);return!!s.parent.canReplaceWith(s.index(),s.indexAfter(),a.type)&&e().replaceWith(r,r+o.nodeSize,a)}const C=e=>new S(e)},RvdS:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});const i=tui.require("editor_weka/components/nodes/Mention");var o=n.n(i),a=n("8h8O"),r=n("YVk/");class s extends a.default{nodes(){return{mention:{schema:{group:"inline",inline:!0,attrs:{type:{default:void 0},id:{default:void 0},display:{default:""}},parseDOM:[{tag:"span.tui-wekaNodeMention",getAttrs(e){try{return{type:JSON.parse(e.getAttribute("data-type")),id:JSON.parse(e.getAttribute("data-id")),display:e.textContent.trim().slice(1)}}catch(e){return{}}}}],toDOM:e=>["span",{class:"tui-wekaNodeMention","data-type":JSON.stringify(e.attrs.type),"data-id":JSON.stringify(e.attrs.id)},"@"+e.attrs.display]},component:o()}}}plugins(){return[(0,r.default)(this.editor)]}}const l=e=>new s(e)},ZpWW:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var i=n("8h8O"),o=n("895m"),a=n("xIDV");const r=tui.require("tui/components/icons/HorizontalRule");var s=n.n(r);class l extends i.default{nodes(){return{ruler:{schema:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]}}}}toolbarItems(){return[new o.ToolbarItem({group:"embeds",label:(0,a.langString)("horizontalrule","editor"),iconComponent:s(),execute:e=>{e.execute(((t,n)=>{let i=t.schema.nodes.ruler;n(t.tr.replaceSelectionWith(i.create())),e.view.focus()}))}})]}keymap(e){const{ruler:t}=this.getSchema().nodes;e("Mod-_",((e,n)=>(n(e.tr.replaceSelectionWith(t.create()).scrollIntoView()),!0)))}}const d=e=>new l(e)},Rd9k:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>y});var i=n("8h8O"),o=n("xIDV"),a=n("895m"),r=n("wQtR"),s=n("R3Ws");const l=tui.require("tui/components/icons/TextBold");var d=n.n(l);const c=tui.require("tui/components/icons/TextItalic");var u=n.n(c);const p=tui.require("tui/components/icons/TextUnderline");var m=n.n(p);const h=["blockquote",0],_=["em",0],f=["strong",0],g=["u",0],v=["h4","h5"];class k extends i.default{nodes(){return{blockquote:{schema:{group:"block",content:"block+",parseDOM:[{tag:"blockquote"}],toDOM:()=>h}},heading:{schema:{attrs:{level:{default:1},align:{default:void 0}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(e){let t=e.attrs.align;const n={};return t&&(n.style=`text-align: ${t};`),["h"+e.attrs.level,n,0]}},view(e){const t=Math.max(e.attrs.level,1)-1,n=v[t]||v[v.length-1],i=document.createElement(n);return e.attrs.align&&(i.style.textAlign=e.attrs.align),{dom:i,contentDOM:i}}},hard_break:{schema:{group:"inline",parseDOM:[{tag:"br"}],toDOM:()=>["br"],inline:!0,selectable:!1}}}}marks(){return{em:{schema:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>_}},strong:{schema:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!=e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>f}},underline:{schema:{parseDOM:[{tag:"u"},{style:"text-decoration=underline"}],toDOM:()=>g}}}}toolbarItems(){const{paragraph:e,heading:t}=this.getSchema().nodes,{strong:n,em:i,underline:r}=this.getSchema().marks;return[(0,a.blockTypeItem)(e,{ignoreAttrs:["align"]},{group:"blocks",label:(0,o.langString)("paragraph","editor")}),(0,a.blockTypeItem)(t,{attrs:{level:1},ignoreAttrs:["align"]},{group:"blocks",label:(0,o.langString)("heading","editor")}),(0,a.blockTypeItem)(t,{attrs:{level:2},ignoreAttrs:["align"]},{group:"blocks",label:(0,o.langString)("subheading","editor")}),(0,a.markItem)(n,{group:"text",label:(0,o.langString)("bold","editor"),iconComponent:d()}),(0,a.markItem)(i,{group:"text",label:(0,o.langString)("italic","editor"),iconComponent:u()}),(0,a.markItem)(r,{group:"text",label:(0,o.langString)("underline","editor"),iconComponent:m()})]}keymap(e){const{paragraph:t,blockquote:n,heading:i,hard_break:o}=this.getSchema().nodes,{strong:a,em:s,underline:l}=this.getSchema().marks;e("Shift-Ctrl-0",(0,r.setBlockType)(t)),e("Ctrl->",(0,r.wrapIn)(n));for(let t=1;t<=6;t++)e("Shift-Ctrl-"+t,(0,r.setBlockType)(i,{level:t}));e("Shift-Enter",((e,t)=>(t(e.tr.replaceSelectionWith(o.create()).scrollIntoView()),!0))),e("Mod-b",(0,r.toggleMark)(a)),e("Mod-B",(0,r.toggleMark)(a)),e("Mod-i",(0,r.toggleMark)(s)),e("Mod-I",(0,r.toggleMark)(s)),e("Mod-u",(0,r.toggleMark)(l)),e("Mod-U",(0,r.toggleMark)(l))}inputRules(){const{blockquote:e,heading:t}=this.getSchema().nodes;return[s.ellipsis,(n=e,(0,s.wrappingInputRule)(/^\s*>\s$/,n)),w(t,6)];var n}}function w(e,t){return(0,s.textblockTypeInputRule)(new RegExp("^(#{1,"+t+"})\\s$"),e,(e=>({level:e[1].length})))}const y=e=>new k(e)},E057:(e,t,n)=>{"use strict";function i(e){try{return JSON.parse(e.getAttribute("data-attrs"))}catch(e){return{}}}function o(e){return t=>{const n={};return e.forEach((e=>{const i=t.getAttribute(e);n[e]=null==i?void 0:i})),n}}n.r(t),n.d(t,{attrGetter:()=>o,getJsonAttrs:()=>i})},cMqc:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var i=n("eQKp"),o=n("IjKw"),a=n("dMpG"),r=n("xIDV"),s=n("KJgz"),l=n.n(s);const d={start:"left",end:"right"},c={start:"right",end:"left"};class u{constructor(e,t){this._el=e,this._trackedEl=t.trackedEl,this._trackedElAnchor=t.trackedElAnchor,this._positionedElAnchor=t.positionedElAnchor,this._viewExtrasEl=t.viewExtrasEl,this._captured=!1,this._shown=!1,this._destroyed=!1,this._scrollableContainers=null,this._handleDOMUpdate=this._handleDOMUpdate.bind(this)}captureNode(){if(!this._captured&&!this._destroyed){if(this._el.parentNode&&this._el.parentNode!=this._viewExtrasEl){const e=document.createComment("captured node");this._el.parentNode.insertBefore(e,this._el),this._el.prevLocationMarker=e,this._el.remove()}this._captured=!0}}releaseNode(){this._captured&&!this._destroyed&&(this._hide(),this._el.prevLocationMarker?(this._el.prevLocationMarker.parentNode.replaceChild(this._el,this._el.prevLocationMarker),delete this._el.prevLocationMarker):this._el.remove(),this._captured=!1)}getCaptured(){return this._captured}setCaptured(e){e?this.captureNode():this.releaseNode()}getVisible(){return this._shown}setVisible(e){e?this._show():this._hide()}_show(){if(this._shown||!this._captured||this._destroyed)return;this._viewExtrasEl.appendChild(this._el),this._resizeOberver=new(l())(this._handleDOMUpdate),this._resizeOberver.observe(this._el),this._resizeOberver.observe(this._trackedEl),this._scrollableContainers=[];let e=(0,o.getClosestScrollable)(this._trackedEl);for(;e;)this._scrollableContainers.push(e),e.addEventListener("scroll",this._handleDOMUpdate),e=(0,o.getClosestScrollable)(e.parentNode);this._shown=!0,this._handleDOMUpdate()}_hide(){this._shown&&!this._destroyed&&(this._resizeOberver.disconnect(),this._resizeOberver=null,this._scrollableContainers&&(this._scrollableContainers.forEach((e=>e.removeEventListener("scroll",this._handleDOMUpdate))),this._scrollableContainers=null),this._el.remove(),Object.assign(this._el.style,{left:null,top:null,width:null}),this._shown=!1)}destroy(){this.releaseNode(),this._destroyed=!0}_handleDOMUpdate(){this._updatePosition()}_updatePosition(){if(!this._shown)return;if(!this._viewExtrasEl.offsetParent)return void(this._el.style.display="none");const e=(0,i.getBoundingClientRect)(this._viewExtrasEl.offsetParent).getPosition(),t=(0,i.getBoundingClientRect)(this._trackedEl).sub(e),[n,o]=this._trackedElAnchor.split("-"),r=new a.Point(t[this._logicalSideToPhysical(o)],t[n]),s=this._scrollableContainers.every((t=>(0,i.getBoundingClientRect)(t).sub(e).contains(r)));if(this._el.style.display=s?"":"none",!s)return;const l=(0,i.getBox)(this._el),[d,c]=this._positionedElAnchor.split("-");let u=r.sub(new a.Point("right"===this._logicalSideToPhysical(c)?l.marginBox.width:0,"bottom"===d?l.marginBox.height:0));this._el.style.left=u.x+"px",this._el.style.top=u.y+"px";const p=document.documentElement.clientWidth;this._el.style.width=null,e.x+u.x+l.marginBox.width>p&&(this._el.style.width=p-(e.x+u.x))}_logicalSideToPhysical(e){return((0,r.isRtl)()?c:d)[e]}}},aWHr:(e,t,n)=>{"use strict";function i(){return{type:"doc",content:[{type:"paragraph"}]}}n.r(t),n.d(t,{getDefaultDocument:()=>i})},"Ww+o":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var i=n("cvQ+"),o=n("eqTj"),a=n("xIDV");const r=tui.require("tui/file");var s=n("x7Rm");class l{constructor({contextId:e,itemId:t}){this.repositoryData=null,this.files={},this.itemId=null,t&&(this.itemId=t),this.contextId=e}get enabled(){return!!this.itemId}updateFileItemId(e){this.itemId=e}getContextId(){return this.contextId}setRepositoryData({repository_id:e,url:t,max_bytes:n}){this.repositoryData||(this.repositoryData={repositoryId:e,url:t,maxBytes:parseInt(n)})}async _fetchRepositoryData(){if(this.repositoryData)return;const{repository_id:e,url:t,max_bytes:n}=await(0,i.getRepositoryData)(this.contextId);this.setRepositoryData({repository_id:e,url:t,max_bytes:n})}getRepositoryData(){return this.repositoryData}getFileStorageItemId(){return this.itemId}addFile(){console.warn("[editor_weka] FileStorage.addFile had been deprecated and no longer used.")}async getFile(){return console.warn("[editor_weka] FileStorage.getFile had been deprecated ","please use FileStorage.getFileInfo instead"),null}async uploadFile(e,t){await this._fetchRepositoryData();const{repositoryId:n,url:i}=this.repositoryData,r=await(0,o.upload)({file:e,itemId:this.itemId,contextId:this.contextId,acceptTypes:t,repositoryId:n,url:i});if(r.id&&r.file)return await this.getFileInfo(r.file);if("fileexists"===r.event){const{newfile:{filename:e}}=r;return await this.getFileInfo(e)}let s=(0,a.langString)("invalid_response","editor_weka");throw await(0,a.loadLangStrings)([s]),new Error(s.toString())}async uploadFiles(e,t){if(0===(e=(0,o.parseFiles)(e)).length)return[];if(await this.checkFilesSizeExceed(e)){const e=await(0,r.getReadableSize)(this.repositoryData.maxBytes),t=(0,a.langString)("file_size_exceed","editor_weka",e);return await(0,a.loadLangStrings)([t]),await(0,s.notify)({type:"error",message:t.toString()}),[]}return Promise.all(e.map((e=>this.uploadFile(e,t))))}async checkFilesSizeExceed(e){if(await this._fetchRepositoryData(),!this.repositoryData.maxBytes)return!0;const{maxBytes:t}=this.repositoryData;return e.some((({size:e})=>e>t))}async getFileInfo(e){return(0,i.getDraftFile)({itemId:this.itemId,filename:e})}}},"/N6l":(e,t,n)=>{"use strict";n.r(t),n.d(t,{AUDIO:()=>a,IMAGE:()=>i,VIDEO:()=>o});const i="IMAGE",o="VIDEO",a="AUDIO"},IjPG:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createMentionContent:()=>o});const i=tui.require("editor_weka/helpers/editor");function o({fullname:e,userId:t}){let n=(0,i.getDefaultDocument)();return n.content[0]={type:"paragraph",content:[{type:"mention",attrs:{id:t,display:e}},{type:"text",text:" "}]},n}},zy7P:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var i=n("51FK"),o=n("Aely"),a=n.n(o),r=n("IjKw");const s=tui.require("tui/lib/popover");var l=n("dMpG"),d=n("eQKp"),c=n("KJgz"),u=n.n(c),p=n("xIDV");const m=tui.require("tui/i18n_vue_plugin");class h{constructor(e){this._instance=null,this._editor=e,this._updatePosition=this._updatePosition.bind(this)}matcher(e,t){if(!(t&&t instanceof i.ResolvedPos))return null;const n=t.doc.textBetween(t.start(),t.pos,"\n","\0");if(""===n)return null;let o=e.exec(n);if(!o)return null;let a=o.index+t.start();return{range:{from:a,to:a+o[0].length},text:o[0]}}destroyInstance(){this._scrollableContainers&&(this._scrollableContainers.forEach((e=>e.removeEventListener("scroll",this._updatePosition))),this._scrollableContainers=null),window.removeEventListener("resize",this._updatePosition),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),null!==this._instance&&(this._instance.$destroy(),document.body.removeChild(this._instance.$el),this._instance=null)}resetComponent(){return console.warn("[editor_weka] The function Suggestion.resetComponent() had been deprecated, ","please do not use"),{apply:!1,text:"",from:0,to:0}}async showList({view:e,component:t,state:{range:n,text:i},callback:o}){o&&console.warn("[editor_weka] The fourth parameter of function Suggestion.showList(), ","had been deprecated, and no longer used"),null!==this._instance&&this.destroyInstance(),await(0,p.loadStrings)((0,m.collectStrings)(t.component));const s=document.createElement("span");document.body.appendChild(s),this._view=e,this._range=n,this._location=a().observable(this._getLocation());const l=t.props?Object.assign({},t.props,{location:this._location}):void 0;this._instance=new(a().extend(t.component))({parent:this._editor.getParent(),propsData:l||{location:this._location,pattern:i,area:this._editor.identifier.area||void 0,contextId:this._editor.identifier.contextId||void 0,component:this._editor.identifier.component||void 0,instanceId:this._editor.identifier.instanceId||void 0}}),this._instance.$mount(s),this._scrollableContainers=[];let d=(0,r.getClosestScrollable)(this._editor.viewExtrasLiveEl);for(;d;)this._scrollableContainers.push(d),d.addEventListener("scroll",this._updatePosition),d=(0,r.getClosestScrollable)(d.parentNode);this._scrollableContainers.push(document),document.addEventListener("scroll",this._updatePosition),window.addEventListener("resize",this._updatePosition),this._resizeObserver=new(u())(this._updatePosition),this._resizeObserver.observe(this._instance.$el),this._instance.$on("item-selected",(({id:i,text:o})=>{this.destroyInstance();const a=this.getNode(e.state,t.name,t.attrs(i,o));this.convertToNode(n,a)})),this._instance.$on("dismiss",(()=>{this.destroyInstance(),this._editor.view.focus()})),a().nextTick(this._updatePosition)}_updatePosition(){Object.assign(this._location,this._getLocation())}_getLocation(){const e=document.documentElement,t=(0,d.getBoundingClientRect)(document.body),n=this._view.coordsAtPos(this._range.from),i=l.Rect.fromPositions({left:n.left,top:n.top,right:n.right+1,bottom:n.bottom}).sub(t.getPosition()),o=new l.Rect(0,0,e.clientWidth,e.clientHeight).sub(t.getPosition()),a=(0,s.position)({position:["bottom","left"],ref:i,viewport:o,size:this._instance?new l.Size(this._instance.$el.offsetWidth,this._instance.$el.offsetHeight):new l.Size(50,50),padding:0});return{x:a.location.x,y:a.location.y}}getNode(e,t,n){return e.schema.node(t,n)}convertToNode(e,t){this._editor.execute(((n,i)=>{i(this.createTransaction(n,e,t)),this._editor.view.focus()}))}createTransaction(e,t,n){let i=e.tr;return i=i.replaceWith(t.from,t.to,n),i}apply(e,t,n,i){i&&console.warn("[editor_weka] The fourth parameter of function Suggestion.apply() had been deprecated ","and no longer needed. Please update all calls");const{selection:o}=e;let a=Object.assign({},t);if(o.from===o.to){const e=this.matcher(n,o.$from);if(e)return a.active=!0,a.range=e.range,a.text=e.text,a}return a.active=!1,a.range={},a.text=null,a}}},N6D1:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupTextarea:()=>d});var i=n("7mX8"),o=n.n(i),a=n("U0bO"),r=n("x4c5"),s=n.n(r),l=n("OUqJ");function d({id:e,extensions:t,showtoolbar:n,file_item_id:i,context_id:o,files:a}){const r=document.getElementById(e);if(!r){const e=new Error("Textarea not found");throw e.code="TEXTAREA_NOT_FOUND",e}new c(e,r,{extensions:t,showtoolbar:n,context_id:o,files:a,file_item_id:i})}class c{constructor(e,t,n){this.id=e,this.textareaEl=t,t.style.display="none",t.setAttribute("data-enhanced",!0),this.wrapper=document.createElement("div");const i=document.createElement("div");this.wrapper.appendChild(i),this.textareaEl.parentNode.insertBefore(this.wrapper,this.textareaEl.nextSibling);let r=this.getWekaValue();this.wekaValue=r;const l=()=>{if(this.wekaValue){let e=(0,a.createNewEvent)("change");this.textareaEl.value=JSON.stringify(this.wekaValue.getDoc()),this.textareaEl.dispatchEvent(e)}},d=(0,a.throttle)(l,250);o().mount(s(),{props:{variant:"full",value:r,options:n,fileItemId:n.file_item_id?n.file_item_id:void 0},on:{input:e=>{this.wekaValue=e,d()},blur:l,ready:()=>{this.wekaValue.hasHtml()&&l()}}},i)}getWekaValue(){let e=this.textareaEl.value;if(e){if(!this.looksLikeJson(e))return l.default.fromHtml(e);try{const t=JSON.parse(e);return l.default.fromDoc(t)}catch(e){console.error("[editor_weka] Error parsing JSON"),console.error(e)}}return l.default.empty()}looksLikeJson(e){return"{"===e.slice(0,1)&&"}"===e.slice(e.length-1)}}},"26pK":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});const i=tui.require("tui/editor");var o=n("x4c5"),a=n.n(o),r=n("OUqJ");const s={getComponent:()=>a(),getProps:({contextId:e,config:t,fileItemId:n,placeholder:i,compact:o,usageIdentifer:a,extraExtensions:r,disabled:s,ariaLabel:l,ariaLabelledby:d,ariaDescribedby:c,ariaInvalid:u,stickyToolbar:p})=>({fileItemId:n,usageIdentifer:a,extraExtensions:r,options:{context_id:e,extensions:t.extensions,files:null,repository_data:null,showtoolbar:t.showtoolbar},placeholder:i,compact:o,disabled:s,ariaLabel:l,ariaLabelledby:d,ariaDescribedby:c,ariaInvalid:u,stickyToolbar:p}),rawToValue(e){if(!e)return r.default.empty();try{return r.default.fromDoc(JSON.parse(e))}catch(t){return console.error("Failed to parse Weka document"),console.log(e),console.error(t),r.default.empty()}},valueToRaw:e=>JSON.stringify(e.getDoc()),isContentEmpty:e=>e.isEmpty,getValueFormat:()=>i.Format.JSON_EDITOR,getPreferredFormat:()=>i.Format.JSON_EDITOR,forceRecreate:!0,supportsFormat:e=>i.Format.JSON_EDITOR===e}},XdLR:(e,t,n)=>{"use strict";function i(e,t){t[e.type]&&t[e.type](e),t.any&&t.any(e),Array.isArray(e.content)&&e.content.forEach((e=>i(e,t)))}n.d(t,{X:()=>i})},"2XWw":(e,t,n)=>{"use strict";n.r(t),n.d(t,{buildKeymap:()=>s});var i=n("wQtR"),o=n("sqie"),a=n("R3Ws");const r="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function s(e,t){let n={};function s(e,t){n[e]=t}s("Mod-z",o.undo),s("Shift-Mod-z",o.redo),s("Backspace",a.undoInputRule),r||s("Mod-y",o.redo),s("Alt-ArrowUp",i.joinUp),s("Alt-ArrowDown",i.joinDown),s("Mod-BracketLeft",i.lift),s("Escape",i.selectParentNode);const l={schema:e,isMac:r};return t.forEach((e=>{e(s,l)})),n}},wAp3:(e,t,n)=>{"use strict";n.r(t),n.d(t,{liftListItem:()=>s,sinkListItem:()=>l,splitListItem:()=>r,wrapInList:()=>a});var i=n("lqu/"),o=n("51FK");function a(e,t){return function(n,a){let{$from:r,$to:s}=n.selection,l=r.blockRange(s),d=!1,c=l;if(!l)return!1;if(l.depth>=2&&r.node(l.depth-1).type.compatibleContent(e)&&0==l.startIndex){if(0==r.index(l.depth-1))return!1;let e=n.doc.resolve(l.start-2);c=new o.NodeRange(e,e,l.depth),l.endIndex<l.parent.childCount&&(l=new o.NodeRange(r,n.doc.resolve(s.end(l.depth)),l.depth)),d=!0}let u=(0,i.findWrapping)(c,e,t,l);return!!u&&(a&&a(function(e,t,n,a,r){let s=o.Fragment.empty;for(let e=n.length-1;e>=0;e--)s=o.Fragment.from(n[e].type.create(n[e].attrs,s));e.step(new i.ReplaceAroundStep(t.start-(a?2:0),t.end,t.start,t.end,new o.Slice(s,0,0),n.length,!0));let l=0;for(let e=0;e<n.length;e++)n[e].type==r&&(l=e+1);let d=n.length-l,c=t.start+n.length-(a?2:0),u=t.parent;for(let n=t.startIndex,o=t.endIndex,a=!0;n<o;n++,a=!1)!a&&(0,i.canSplit)(e.doc,c,d)&&(e.split(c,d),c+=2*d),c+=u.child(n).nodeSize;return e}(n.tr,l,u,d,e).scrollIntoView()),!0)}}function r(e){return function(t,n){let{$from:a,$to:r,node:s}=t.selection;if(s&&s.isBlock||a.depth<2||!a.sameParent(r))return!1;let l=a.node(-1);if(l.type!=e)return!1;if(0==a.parent.content.size){if(2==a.depth||a.node(-3).type!=e||a.index(-2)!=a.node(-2).childCount-1)return!1;if(n){let i=o.Fragment.empty,r=a.index(-1)>0;for(let e=a.depth-(r?1:2);e>=a.depth-3;e--)i=o.Fragment.from(a.node(e).copy(i));i=i.append(o.Fragment.from(e.createAndFill()));let s=t.tr.replace(a.before(r?null:-1),a.after(-3),new o.Slice(i,r?3:2,2));s.setSelection(t.selection.constructor.near(s.doc.resolve(a.pos+(r?3:2)))),n(s.scrollIntoView())}return!0}let d=r.pos==a.end()?l.contentMatchAt(0).defaultType:null,c=t.tr.delete(a.pos,r.pos),u=d&&[null,{type:d}];return!!(0,i.canSplit)(c.doc,a.pos,2,u)&&(n&&n(c.split(a.pos,2,u).scrollIntoView()),!0)}}function s(e){return function(t,n){let{$from:a,$to:r}=t.selection,s=a.blockRange(r,(t=>t.childCount&&t.firstChild.type==e));return!!s&&(!n||(a.node(s.depth-1).type==e?function(e,t,n,a){let r=e.tr,s=a.end,l=a.$to.end(a.depth);return s<l&&(r.step(new i.ReplaceAroundStep(s-1,l,s,l,new o.Slice(o.Fragment.from(n.create(null,a.parent.copy())),1,0),1,!0)),a=new o.NodeRange(r.doc.resolve(a.$from.pos),r.doc.resolve(l),a.depth)),t(r.lift(a,(0,i.liftTarget)(a)).scrollIntoView()),!0}(t,n,e,s):function(e,t,n){let a=e.tr,r=n.parent;for(let e=n.end,t=n.endIndex-1,i=n.startIndex;t>i;t--)e-=r.child(t).nodeSize,a.delete(e-1,e+1);let s=a.doc.resolve(n.start),l=s.nodeAfter,d=0==n.startIndex,c=n.endIndex==r.childCount,u=s.node(-1),p=s.index(-1);if(!u.canReplace(p+(d?0:1),p+1,l.content.append(c?o.Fragment.empty:o.Fragment.from(r))))return!1;let m=s.pos,h=m+l.nodeSize;return a.step(new i.ReplaceAroundStep(m-(d?1:0),h+(c?1:0),m+1,h-1,new o.Slice((d?o.Fragment.empty:o.Fragment.from(r.copy(o.Fragment.empty))).append(c?o.Fragment.empty:o.Fragment.from(r.copy(o.Fragment.empty))),d?0:1,c?0:1),d?0:1)),t(a.scrollIntoView()),!0}(t,n,s)))}}function l(e){return function(t,n){let{$from:a,$to:r}=t.selection,s=a.blockRange(r,(t=>t.childCount&&t.firstChild.type==e));if(!s)return!1;let l=s.startIndex;if(0==l)return!1;let d=s.parent,c=d.child(l-1);if(c.type!=e)return!1;if(n){let a=c.lastChild&&c.lastChild.type==d.type,r=o.Fragment.from(a?e.create():null),l=new o.Slice(o.Fragment.from(e.create(null,o.Fragment.from(d.type.create(null,r)))),a?3:1,0),u=s.start,p=s.end;n(t.tr.step(new i.ReplaceAroundStep(u-(a?3:1),p,u,p,l,1,!0)).scrollIntoView())}return!0}}},uZzl:(e,t,n)=>{"use strict";n.r(t),n.d(t,{canInsert:()=>h,canReplace:()=>u,checkInvalidMovements:()=>k,cloneTr:()=>d,createCell:()=>g,equalNodeType:()=>l,findTableClosestToPos:()=>f,isEmptyParagraph:()=>_,isNodeSelection:()=>s,removeNodeAtPos:()=>p,replaceNodeAtPos:()=>c,tableNodeTypes:()=>m,transpose:()=>v});var i=n("Xz/0"),o=n("51FK"),a=n("5nM4"),r=n("kAdn");const s=e=>e instanceof i.NodeSelection,l=(e,t)=>Array.isArray(e)&&e.indexOf(t.type)>-1||t.type===e,d=e=>Object.assign(Object.create(e),e).setTime(Date.now()),c=(e,t)=>n=>{const i=n.doc.nodeAt(e),o=n.doc.resolve(e);if(u(o,t)){const o=(n=n.replaceWith(e,e+i.nodeSize,t)).selection.$from.pos-1;return n=(0,a.setTextSelection)(Math.max(o,0),-1)(n),n=(0,a.setTextSelection)(n.selection.$from.start())(n),d(n)}return n},u=(e,t)=>{const n=e.node(e.depth);return n&&n.type.validContent(t instanceof o.Fragment?t:o.Fragment.from(t))},p=e=>t=>{const n=t.doc.nodeAt(e);return d(t.delete(e,e+n.nodeSize))},m=e=>{if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach((n=>{const i=e.nodes[n];i.spec.tableRole&&(t[i.spec.tableRole]=i)})),e.cached.tableNodeTypes=t,t},h=(e,t)=>{const n=e.index();return t instanceof o.Fragment?e.parent.canReplace(n,n,t):t instanceof o.Node&&e.parent.canReplaceWith(n,n,t.type)},_=e=>!e||"paragraph"===e.type.name&&2===e.nodeSize,f=e=>(0,r.findParentNodeClosestToPos)(e,(e=>e.type.spec.tableRole&&/table/i.test(e.type.spec.tableRole))),g=(e,t=null)=>t?e.createChecked(null,t):e.createAndFill(),v=e=>e[0].map(((t,n)=>e.map((e=>e[n])))),k=(e,t,n,i)=>{const o=`Target position is invalid, you can't move the ${i} ${e} to ${t}, the target can't be split. You could use tryToFit option.`;if(1==(e>t?-1:1)){if(-1!==n.slice(0,n.length-1).indexOf(t))throw new Error(o)}else if(-1!==n.slice(1).indexOf(t))throw new Error(o);return!0}},kAdn:(e,t,n)=>{"use strict";n.r(t),n.d(t,{findDomRefAtPos:()=>_,findParentDomRef:()=>s,findParentDomRefOfType:()=>p,findParentNode:()=>a,findParentNodeClosestToPos:()=>r,findParentNodeOfType:()=>d,findParentNodeOfTypeClosestToPos:()=>c,findPositionOfNodeBefore:()=>h,findSelectedNodeOfType:()=>m,hasParentNode:()=>l,hasParentNodeOfType:()=>u});var i=n("Xz/0"),o=n("uZzl");const a=e=>({$from:t})=>r(t,e),r=(e,t)=>{for(let n=e.depth;n>0;n--){const i=e.node(n);if(t(i))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:i}}},s=(e,t)=>n=>{const i=a(e)(n);if(i)return _(i.pos,t)},l=e=>t=>!!a(e)(t),d=e=>t=>a((t=>(0,o.equalNodeType)(e,t)))(t),c=(e,t)=>r(e,(e=>(0,o.equalNodeType)(t,e))),u=e=>t=>l((t=>(0,o.equalNodeType)(e,t)))(t),p=(e,t)=>n=>s((t=>(0,o.equalNodeType)(e,t)),t)(n),m=e=>t=>{if((0,o.isNodeSelection)(t)){const{node:n,$from:i}=t;if((0,o.equalNodeType)(e,n))return{node:n,pos:i.pos,depth:i.depth}}},h=e=>{const{nodeBefore:t}=e.$from,n=i.Selection.findFrom(e.$from,-1);if(n&&t){const e=d(t.type)(n);return e?e.pos:n.$from.pos}},_=(e,t)=>{const n=t(e),i=n.node.childNodes[n.offset];return n.node.nodeType===Node.TEXT_NODE?n.node.parentNode:i&&i.nodeType!==Node.TEXT_NODE?i:n.node}},"5nM4":(e,t,n)=>{"use strict";n.r(t),n.d(t,{removeNodeBefore:()=>v,removeParentNodeOfType:()=>l,removeSelectedNode:()=>c,replaceParentNodeOfType:()=>d,replaceSelectedNode:()=>u,safeInsert:()=>_,selectParentNodeOfType:()=>g,setParentNodeMarkup:()=>f,setTextSelection:()=>p});var i=n("Xz/0"),o=n("51FK"),a=n("kAdn"),r=n("uZzl"),s=n("ASUJ");const l=e=>t=>{const n=(0,a.findParentNodeOfType)(e)(t.selection);return n?(0,r.removeNodeAtPos)(n.pos)(t):t},d=(e,t)=>n=>{Array.isArray(e)||(e=[e]);for(let i=0,o=e.length;i<o;i++){const o=(0,a.findParentNodeOfType)(e[i])(n.selection);if(o){const e=(0,r.replaceNodeAtPos)(o.pos,t)(n);if(e!==n)return e}}return n},c=e=>{if((0,r.isNodeSelection)(e.selection)){const t=e.selection.$from.pos,n=e.selection.$to.pos;return(0,r.cloneTr)(e.delete(t,n))}return e},u=e=>t=>{if((0,r.isNodeSelection)(t.selection)){const{$from:n,$to:a}=t.selection;if(e instanceof o.Fragment&&n.parent.canReplace(n.index(),n.indexAfter(),e)||n.parent.canReplaceWith(n.index(),n.indexAfter(),e.type))return(0,r.cloneTr)(t.replaceWith(n.pos,a.pos,e).setSelection(new i.NodeSelection(t.doc.resolve(n.pos))))}return t},p=(e,t=1)=>n=>{const o=i.Selection.findFrom(n.doc.resolve(e),t,!0);return o?n.setSelection(o):n},m=e=>e.type&&e.type.spec.selectable,h=(e,t,n)=>(e=>m(e)&&e.type.isLeaf)(e)?n.setSelection(new i.NodeSelection(n.doc.resolve(t))):p(t)(n),_=(e,t,n)=>i=>{const o="number"==typeof t,{$from:a}=i.selection,l=o?i.doc.resolve(t):(0,r.isNodeSelection)(i.selection)?i.doc.resolve(a.pos+1):a,{parent:c}=l;if((0,r.isNodeSelection)(i.selection)&&n&&i!==(i=u(e)(i)))return i;if((0,r.isEmptyParagraph)(c)&&i!==(i=d(c.type,e)(i))){const t=m(e)?l.before(l.depth):l.pos;return h(e,t,i)}if((0,r.canInsert)(l,e)){i.insert(l.pos,e);const t=(0,s.getInsertedPos)(i);return(0,r.cloneTr)(h(e,t,i))}for(let t=l.depth;t>0;t--){const n=l.after(t),o=i.doc.resolve(n);if((0,r.canInsert)(o,e))return i.insert(n,e),(0,r.cloneTr)(h(e,n,i))}return i},f=(e,t,n,i)=>o=>{const s=(0,a.findParentNodeOfType)(e)(o.selection);return s?(0,r.cloneTr)(o.setNodeMarkup(s.pos,t,Object.assign({},s.node.attrs,n),i)):o},g=e=>t=>{if(!(0,r.isNodeSelection)(t.selection)){const n=(0,a.findParentNodeOfType)(e)(t.selection);if(n)return(0,r.cloneTr)(t.setSelection(i.NodeSelection.create(t.doc,n.pos)))}return t},v=e=>{const t=(0,a.findPositionOfNodeBefore)(e.selection);return"number"==typeof t?(0,r.removeNodeAtPos)(t)(e):e}},lquI:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i={props:{filename:{type:String,required:!0},fileSize:{type:[String,Number],required:!0},draftId:{type:[String,Number],required:!0},hasDownloadUrl:Boolean,disabled:Boolean}}},Sgz4:(e,t,n)=>{"use strict";n.r(t),n.d(t,{attachment:()=>r,pluginKey:()=>a});var i=n("Xz/0");const o=Object.prototype.hasOwnProperty,a=new i.PluginKey("attachment");function r(e){const{onDrop:t,onKeyDown:n}=function(e){let t={};return["onDrop","onKeyDown"].forEach((n=>{o.call(e,n)&&"function"==typeof e[n]?t[n]=e[n]:t[n]=()=>!1})),t}(e);return new i.Plugin({key:a,state:{init:()=>({}),apply:()=>({})},props:{handleDOMEvents:{drop:(e,n)=>t({view:e,event:n})},handleKeyDown:(e,t)=>n({view:e,event:t})}})}},UvVU:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var i=n("Xz/0");function o(e){const t=[];for(;e;)t.push(e),e=e.parent;return t}function a(){const e=new i.PluginKey("cursor-inside-node");return new i.Plugin({key:e,state:{init:()=>0,apply:(e,t)=>t+1},view:()=>({update(t,n){const i=o(t.domAtPos(n.selection.head).node.pmViewDesc),a=o(t.domAtPos(t.state.selection.head).node.pmViewDesc);1===e.getState(t.state)?a.forEach((e=>{e.spec&&e.spec.setCursorInside&&e.spec.setCursorInside(!0)})):(i.forEach((e=>{!a.includes(e)&&e.spec&&e.spec.setCursorInside&&e.spec.setCursorInside(!1)})),a.forEach((e=>{!i.includes(e)&&e.spec&&e.spec.setCursorInside&&e.spec.setCursorInside(!0)})))}})})}},"//CD":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var i=n("Xz/0"),o=n("51FK");function a(e,t,n){const a=new i.PluginKey("emojis");let r=!1;return new i.Plugin({key:a,appendTransaction(e,t,n){const{text:i,active:o,range:r,emoji:s}=a.getState(n);if(!i||!o)return null;const l=n.schema.node("emoji",{id:s.id,shortcode:s.shortcode});return n.tr.replaceWith(r.from,r.to,l)},state:{init:()=>({active:!1,range:{},text:null}),apply(e,n){const{selection:i}=e;let a=Object.assign({},n);if(a.active=!1,!r)return a;if(i.from===i.to){const e=function(e,t){if(!(e&&e instanceof o.ResolvedPos))return null;const n=e.doc.textBetween(e.start(),e.end(),"\0","\0");if(""===n)return null;if(!t)return null;let i,a;for(let o=0;o<t.length;++o){let r=t[o];if(""!==r.pattern)for(a=new RegExp(r.pattern,"g");i=a.exec(n);){let t=i.input.slice(Math.max(0,i.index-1),i.index);if(!/^[\s\0]?$/.test(t))continue;let n=i.index+e.start(),o=n+i[0].length;if(n<e.pos&&o>=e.pos)return{range:{from:n,to:o},text:i[0],emoji:r}}}return null}(i.$from,t);e&&(a.active=!0,a.range=e.range,a.text=e.text,a.emoji=e.emoji)}return a.active||(a.range={},a.text=null),a}},props:{handleKeyDown(e,t){r=n.find((e=>e===t.key))}}})}},ewWi:(e,t,n)=>{"use strict";n.r(t),n.d(t,{REGEX:()=>l,default:()=>d});var i=n("Xz/0");const o=tui.require("editor_weka/components/suggestion/Hashtag");var a=n.n(o),r=n("zy7P"),s=n("U0bO");const l=new RegExp("#[^#\\s]+$","g");function d(e){const t=new i.PluginKey("hashtags");let n=new r.default(e);return new i.Plugin({key:t,view(){return{update:(0,s.debounce)((async e=>{const{text:t,active:i,range:o}=this.key.getState(e.state);n.destroyInstance(),t&&i&&await n.showList({view:e,component:{name:"hashtag",component:a(),attrs:(e,t)=>({text:t})},state:{text:t.slice(1),active:i,range:o}})}),500)}},state:{init:()=>({active:!1,range:{},text:null}),apply:(e,t)=>(l.lastIndex=0,n.apply(e,t,l))},props:{handleKeyDown(t,n){const{active:i,text:o,range:a}=this.getState(t.state);return!!i&&([" ","Tab","Enter","PageUp","PageDown","Home","End","Escape","Spacebar","Esc"].includes(n.key)&&e.execute(((e,t)=>(t(e.tr.replaceWith(a.from,a.to,e.schema.node("hashtag",{text:o.slice(1)}))),n.stopPropagation(),!0))),!1)},handleClick(t){const{active:n,text:i,range:o}=this.getState(t.state);return!!n&&(e.execute(((e,t)=>{const n=e.schema.node("hashtag",{text:i.slice(1)});t(e.tr.replaceWith(o.from,o.to,n))})),!0)}}})}},"YVk/":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var i=n("U0bO"),o=n("Xz/0"),a=n("zy7P");const r=tui.require("editor_weka/components/suggestion/User");var s=n.n(r);function l(e){const t=new o.PluginKey("mentions");let n=new a.default(e);const r=new RegExp("@[^@\\s]+$","g");return new o.Plugin({key:t,view(){return{update:(0,i.debounce)((e=>{const{text:t,active:i,range:o}=this.key.getState(e.state);n.destroyInstance(),t&&i&&n.showList({view:e,component:{name:"mention",component:s(),attrs:(e,t)=>({id:e,display:t})},state:{text:t.slice(1),active:i,range:o}})}),250)}},state:{init:()=>({active:!1,range:{},text:null}),apply:(e,t)=>(r.lastIndex=0,n.apply(e,t,r))},props:{handleKeyDown(e,t){if("Escape"===t.key||"Esc"===t.key){const{active:i}=this.getState(e.state);return!!i&&(n.destroyInstance(),e.focus(),t.stopPropagation(),!0)}}}})}},"8Tor":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var i=n("Xz/0"),o=n("QxjF");function a(e){return new i.Plugin({key:new i.PluginKey("text-placeholder"),props:{decorations({doc:t}){if(!e)return!1;if(1!==t.childCount||!t.firstChild.isTextblock)return!1;let n=[];return t.descendants(((t,i)=>(t.type.isBlock&&0==t.childCount&&n.push(o.Decoration.node(i,i+t.nodeSize,{class:"tui-weka__placeholder","data-placeholder":e})),!0))),o.DecorationSet.create(t,n)}}})}},"7AVa":(e,t,n)=>{"use strict";n.r(t),n.d(t,{createSchema:()=>r});var i=n("51FK");const o={paragraph:{group:"block",content:"inline*",attrs:{align:{default:void 0}},parseDOM:[{tag:"p"}],toDOM(e){let t=e.attrs.align;const n={};return t&&(n.style=`text-align: ${t};`),["p",n,0]}},text:{group:"inline"},unknown_block:{group:"block",toDOM:()=>["div",{class:"tui-editor_weka-unknownBlock"}],attrs:{type:{},attrs:{default:void 0},content:{default:void 0}}},unknown_inline:{group:"inline",inline:!0,toDOM:()=>["span",{class:"tui-editor_weka-unknownInline"}],attrs:{type:{},attrs:{default:void 0},content:{default:void 0}}}},a={unknown:{attrs:{type:{},attrs:{default:void 0}},toDOM:()=>["span",0],inclusive:!1}};function r({nodes:e,marks:t}){const n=Object.values(e).some((e=>"rootblock"===e.group));return new i.Schema({nodes:{doc:{content:"(paragraph | block"+(n?" | rootblock":"")+")+"},...o,...e},marks:{...a,...t}})}},"895m":(e,t,n)=>{"use strict";n.r(t),n.d(t,{ToolbarItem:()=>o,blockTypeItem:()=>s,cmdItem:()=>a,markItem:()=>r});var i=n("wQtR");class o{constructor(e){this._opts=e,this._editor=null,this._def={type:e.type,group:e.group,label:e.label,iconComponent:e.iconComponent,enabled:!0,active:null,children:e.children&&e.children.map((e=>e.getDef())),popover:e.popover,execute:()=>e.execute(this._editor),reset:()=>e.reset(this._editor)}}update(e){const{_def:t,_opts:n}=this;return this._editor=e,this._editor.view.editable?t.enabled=void 0===n.enabled||n.enabled(e):t.enabled=!1,t.iconComponent=void 0!==n.getIconComponent?n.getIconComponent(e):t.iconComponent,t.active=null!=n.active?n.active(e):null,n.children&&n.children.forEach((t=>t.update(e))),Object.assign({},t)}getDef(){return this._def}}function a(e,t){return new o(Object.assign({enabled:t=>t.canExecute(e),execute:t=>{t.view.focus(),t.execute(e)}},t))}function r(e,t){return t=Object.assign({active:t=>function(e,t){let{from:n,$from:i,to:o,empty:a}=e.selection;return a?!!t.isInSet(e.storedMarks||i.marks()):!!e.doc.rangeHasMark(n,o,t)}(t.state,e)},t),a((0,i.toggleMark)(e),t)}function s(e,t,n){return n=Object.assign({active(n){let{$from:i,to:o,node:a}=n.state.selection;const r=i.parent;return t.ignoreAttrs&&t.ignoreAttrs.forEach((e=>{a&&!(e in a.attrs)||e in r.attrs&&(t.attrs||(t.attrs={}),t.attrs[e]=a?a.attrs[e]:r.attrs[e])})),a&&a.isTextblock?a.hasMarkup(e,t.attrs):o<=i.end()&&r.hasMarkup(e,t.attrs)}},n),a((0,i.setBlockType)(e,t.attrs),n)}},ZSGX:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SetAttrsStep:()=>a,setAttrs:()=>r});var i=n("51FK"),o=n("lqu/");class a extends o.Step{constructor(e,t){super(),this.pos=e,this.attrs=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return o.StepResult.fail("No node at given position");let n=t.type.create(this.attrs,i.Fragment.empty,t.marks),a=new i.Slice(i.Fragment.from(n),0,t.isLeaf?0:1);return o.StepResult.fromReplace(e,this.pos,this.pos+t.nodeSize,a)}invert(e){let t=e.nodeAt(this.pos);return new a(this.pos,t?t.attrs:null)}map(e){let t=e.mapResult(this.pos,1);return t.deleted?null:new a(t.pos,this.attrs)}toJSON(){return{stepType:"setAttrs",pos:this.pos,attrs:this.attrs}}static fromJSON(e,t){if("number"!=typeof t.pos||null!=t.attrs&&"object"!=typeof t.attrs)throw new RangeError("Invalid input for SetAttrsStep.fromJSON");return new a(t.pos,t.attrs)}}o.Step.jsonID("setAttrs",a);const r=(e,t)=>n=>n.step(new a(e,t))},zENn:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ResolvedRange:()=>s,expandContentResolvedRange:()=>a,getInsertedPos:()=>c,getMark:()=>r,getMarkRange:()=>o});var i=n("lqu/");function o(e,t){const n=l(e);if(!n.node)return!1;const i=n.node.marks.find((e=>e.type===t));if(!i)return!1;let o=e.index(),a=e.start()+n.offset,r=a+n.node.nodeSize;return{from:d(e.parent,i,o,a,-1),to:d(e.parent,i,o,r,1)}}function a(e){if(e&&e.$from.parent!=e.$from.doc&&e.$from.sameParent(e.$to)&&0===e.$from.parentOffset&&e.$to.parentOffset===e.$to.parent.nodeSize-2){const t=e.$from.doc;return new s(t.resolve(e.$from.pos-1),t.resolve(e.$to.pos+1))}return e}function r(e,t){return l(e).node.marks.find((e=>e.type===t))}class s{constructor(e,t){this.$from=e,this.$to=t}static resolve(e,t){return new s(e.resolve(t.from),e.resolve(t.to))}}function l(e){return e.parent.childAfter(e.parentOffset)}function d(e,t,n,i,o){const a=e.childCount-1;for(;!((n+=o)<0||n>a);){const a=e.child(n);if(!t.isInSet(a.marks))break;i+=e.child(n).nodeSize*o}return i}function c(e){const t=e.steps[e.steps.length-1];return t instanceof i.ReplaceStep||t instanceof i.ReplaceAroundStep?t.to+t.slice.openStart:null}},TXPb:(e,t,n)=>{"use strict";n.r(t),n.d(t,{isListActive:()=>r,toggleList:()=>a});var i=n("wAp3"),o=n("kAdn");function a(e,t,n){const a=(0,i.liftListItem)(t),r=(0,i.wrapInList)(e);return(t,i,s)=>{const{selection:l}=t,d=l.$from.blockRange(l.$to);if(!d)return!1;const c=function(e,t){return(0,o.findParentNode)((e=>t.includes(e.type)))(e)}(l,n),u=c&&d.depth-c.depth<=1;if(d.depth>=1&&u){if(c.node.type===e)return a(t,i,s);if(e.validContent(c.node.content))return i&&i(t.tr.setNodeMarkup(c.pos,e)),!0}return r(t,i,s)}}function r(e,t){const{selection:n}=e,i=n.$from.blockRange(n.$to);if(!i)return!1;const a=(0,o.findParentNode)((e=>e.type==t))(n);return i.depth>=1&&a&&i.depth-a.depth<=1}n("51FK"),n("Xz/0")},eqTj:(e,t,n)=>{"use strict";n.r(t),n.d(t,{UploadError:()=>c,parseFiles:()=>u,pickFiles:()=>m,upload:()=>p});const i=tui.require("tui/config");var o=n("yQz/"),a=n.n(o);const r=tui.require("editor_weka/components/upload/FilePicker");var s=n.n(r),l=n("Aely"),d=n.n(l);n("NBUY");class c extends Error{constructor(e){super(e),this.name="UploadError"}}function u(e){return Array.isArray(e)?e:Array.prototype.slice.call(e).filter((e=>e instanceof File))}async function p({file:e,repositoryId:t,itemId:n,contextId:o,acceptTypes:a,url:r}){return new Promise(((s,l)=>{const d=new FormData,u=new XMLHttpRequest;d.append("repo_upload_file",e),d.append("title",e.name),d.append("sesskey",i.config.sesskey),d.append("repo_id",String(t)),d.append("itemid",String(n)),null!=o&&d.append("ctx_id",String(o)),a.forEach((e=>d.append("accepted_types[]",e))),u.addEventListener("readystatechange",(()=>{if(4===u.readyState){if(200!==u.status)return void l(new Error("Response is not a 200 response"));let e=JSON.parse(u.responseText);if(e.error)return void l(new c(e.error));s(e)}})),u.open("POST",r,!0),u.send(d)}))}async function m(e){const t=new(d().extend(s()))({parent:e.getParent(),propsData:{autoTrigger:!0}}),n=a()("weka-file-picker");return setTimeout((()=>{n();const i=document.createElement("span");e.viewExtrasEl.appendChild(i),t.$mount(i)}),0),new Promise((n=>{t.$on("picked-files",(e=>{n(e)})),t.$on("dismiss",(()=>{t.$destroy(),e.viewExtrasEl.removeChild(t.$el)}))}))}},wWJ2:(e,t,n)=>{"use strict";function i(e,t,n,i,o,a,r,s){var l,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=n,d._compiled=!0),i&&(d.functional=!0),a&&(d._scopeId="data-v-"+a),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},d._ssrRegister=l):o&&(l=s?function(){o.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(d.functional){d._injectStyles=l;var c=d.render;d.render=function(e,t){return l.call(t),c(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:d}}n.d(t,{Z:()=>i})},x4c5:e=>{"use strict";e.exports=tui.require("editor_weka/components/Weka")},xZv7:e=>{"use strict";e.exports=tui.require("editor_weka/components/editing/ActionDropdown")},"hd/h":e=>{"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol1")},KTPV:e=>{"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol2NarrowLeft")},Pspb:e=>{"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol2NarrowRight")},"5TpV":e=>{"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol2")},PWfy:e=>{"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol3")},"6tNc":e=>{"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutIconBase")},lhYX:e=>{"use strict";e.exports=tui.require("editor_weka/components/node_menu/NodeMenuActionDropdown")},oXL3:e=>{"use strict";e.exports=tui.require("editor_weka/components/node_menu/NodeMenuButton")},nIqm:e=>{"use strict";e.exports=tui.require("editor_weka/components/node_menu")},TVjX:e=>{"use strict";e.exports=tui.require("editor_weka/components/nodes/BaseNode")},oFnQ:e=>{"use strict";e.exports=tui.require("editor_weka/components/toolbar/NodeBar")},"9lfe":e=>{"use strict";e.exports=tui.require("editor_weka/components/upload/ExtraFileUploadModal")},MERh:e=>{"use strict";e.exports=tui.require("editor_weka/lib/prosemirror_utils/selection")},VmD8:e=>{"use strict";e.exports=tui.require("editor_weka/mixins/attachment_mixin")},ASUJ:e=>{"use strict";e.exports=tui.require("editor_weka/util")},wQtR:e=>{"use strict";e.exports=tui.require("ext_prosemirror/commands")},sqie:e=>{"use strict";e.exports=tui.require("ext_prosemirror/history")},R3Ws:e=>{"use strict";e.exports=tui.require("ext_prosemirror/inputrules")},"51FK":e=>{"use strict";e.exports=tui.require("ext_prosemirror/model")},"Xz/0":e=>{"use strict";e.exports=tui.require("ext_prosemirror/state")},"lqu/":e=>{"use strict";e.exports=tui.require("ext_prosemirror/transform")},QxjF:e=>{"use strict";e.exports=tui.require("ext_prosemirror/view")},eHBv:e=>{"use strict";e.exports=tui.require("tui/components/buttons/ButtonGroup")},"1+j7":e=>{"use strict";e.exports=tui.require("tui/components/buttons/ButtonIcon")},IpiT:e=>{"use strict";e.exports=tui.require("tui/components/buttons/Button")},ddQy:e=>{"use strict";e.exports=tui.require("tui/components/buttons/Cancel")},DS3U:e=>{"use strict";e.exports=tui.require("tui/components/dropdown/DropdownButton")},"6e83":e=>{"use strict";e.exports=tui.require("tui/components/dropdown/DropdownItem")},"3NWB":e=>{"use strict";e.exports=tui.require("tui/components/dropdown/Dropdown")},"2XTD":e=>{"use strict";e.exports=tui.require("tui/components/form/FormRow")},ApK1:e=>{"use strict";e.exports=tui.require("tui/components/form/Form")},IgBQ:e=>{"use strict";e.exports=tui.require("tui/components/form/InputText")},vujW:e=>{"use strict";e.exports=tui.require("tui/components/icons/Image")},AQw4:e=>{"use strict";e.exports=tui.require("tui/components/icons/Layout")},"/g0d":e=>{"use strict";e.exports=tui.require("tui/components/icons/Loading")},x7h9:e=>{"use strict";e.exports=tui.require("tui/components/icons/More")},jGtd:e=>{"use strict";e.exports=tui.require("tui/components/images/ResponsiveImage")},ZkHI:e=>{"use strict";e.exports=tui.require("tui/components/json_editor/nodes/AttachmentNode")},"+Hsq":e=>{"use strict";e.exports=tui.require("tui/components/json_editor/nodes/Emoji")},GLpC:e=>{"use strict";e.exports=tui.require("tui/components/modal/ModalContent")},EJOt:e=>{"use strict";e.exports=tui.require("tui/components/modal/ModalPresenter")},IACo:e=>{"use strict";e.exports=tui.require("tui/components/modal/Modal")},eQKp:e=>{"use strict";e.exports=tui.require("tui/dom/position")},IjKw:e=>{"use strict";e.exports=tui.require("tui/dom/scroll")},dMpG:e=>{"use strict";e.exports=tui.require("tui/geometry")},xIDV:e=>{"use strict";e.exports=tui.require("tui/i18n")},x7Rm:e=>{"use strict";e.exports=tui.require("tui/notifications")},"yQz/":e=>{"use strict";e.exports=tui.require("tui/pending")},KJgz:e=>{"use strict";e.exports=tui.require("tui/polyfills/ResizeObserver")},"7mX8":e=>{"use strict";e.exports=tui.require("tui/tui")},U0bO:e=>{"use strict";e.exports=tui.require("tui/util")},Aely:e=>{"use strict";e.exports=tui.require("vue")}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("editor_weka")?console.warn('[tui bundle] The bundle "editor_weka" is already loaded, skipping initialisation.'):(n("Md1s"),tui._bundle.register("editor_weka"),tui._bundle.addModulesFromContext("editor_weka",n("fC82")),tui._bundle.addModulesFromContext("editor_weka/components",n("nHbi")),tui._bundle.addModulesFromContext("editor_weka/pages",n("B9Lp")))}()})();