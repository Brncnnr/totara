/*! For license information please see tui_bundle.legacy.js.LICENSE.txt */
!function(){var e={nHbi:function(e,t,n){var i={"./Weka":"0TLR","./Weka.vue":"0TLR","./attachments/AudioAttachment":"t4Eo","./attachments/AudioAttachment.vue":"t4Eo","./attachments/FileAttachment":"mRIW","./attachments/FileAttachment.vue":"mRIW","./attachments/ImageAttachment":"oxqV","./attachments/ImageAttachment.vue":"oxqV","./attachments/VideoAttachment":"jzcC","./attachments/VideoAttachment.vue":"jzcC","./directives":"gFJZ","./directives.js":"gFJZ","./editing/ActionDropdown":"3R3+","./editing/ActionDropdown.vue":"3R3+","./editing/EditImageAltTextModal":"zAJu","./editing/EditImageAltTextModal.vue":"zAJu","./editing/EditLinkModal":"DwUL","./editing/EditLinkModal.vue":"DwUL","./editing/EmojiSelector":"ju6e","./editing/EmojiSelector.vue":"ju6e","./editing/PositionedActionDropdown":"kBMv","./editing/PositionedActionDropdown.vue":"kBMv","./editing/graphics/layout_icons_24/LayoutCol1":"fBuu","./editing/graphics/layout_icons_24/LayoutCol1.vue":"fBuu","./editing/graphics/layout_icons_24/LayoutCol2":"1FyB","./editing/graphics/layout_icons_24/LayoutCol2.vue":"1FyB","./editing/graphics/layout_icons_24/LayoutCol2NarrowLeft":"Cl/n","./editing/graphics/layout_icons_24/LayoutCol2NarrowLeft.vue":"Cl/n","./editing/graphics/layout_icons_24/LayoutCol2NarrowRight":"leJy","./editing/graphics/layout_icons_24/LayoutCol2NarrowRight.vue":"leJy","./editing/graphics/layout_icons_24/LayoutCol3":"/wsq","./editing/graphics/layout_icons_24/LayoutCol3.vue":"/wsq","./editing/graphics/layout_icons_24/LayoutIconBase":"Nmbj","./editing/graphics/layout_icons_24/LayoutIconBase.vue":"Nmbj","./marks/Link":"+z7R","./marks/Link.vue":"+z7R","./node_menu":"x5EO","./node_menu/":"x5EO","./node_menu/NodeMenu":"XBjH","./node_menu/NodeMenu.vue":"XBjH","./node_menu/NodeMenuActionDropdown":"Xtc8","./node_menu/NodeMenuActionDropdown.vue":"Xtc8","./node_menu/NodeMenuButton":"jRPZ","./node_menu/NodeMenuButton.vue":"jRPZ","./node_menu/NodeMenuGroup":"FphW","./node_menu/NodeMenuGroup.vue":"FphW","./node_menu/NodeMenuMoreDropdown":"aKDM","./node_menu/NodeMenuMoreDropdown.vue":"aKDM","./node_menu/index":"x5EO","./node_menu/index.js":"x5EO","./nodes/Attachment":"l0e3","./nodes/Attachment.vue":"l0e3","./nodes/Attachments":"uTni","./nodes/Attachments.vue":"uTni","./nodes/AudioBlock":"Jgzi","./nodes/AudioBlock.vue":"Jgzi","./nodes/BaseNode":"AboO","./nodes/BaseNode.vue":"AboO","./nodes/Emoji":"/bhg","./nodes/Emoji.vue":"/bhg","./nodes/FigureCaption":"Ag1S","./nodes/FigureCaption.vue":"Ag1S","./nodes/Hashtag":"4SCA","./nodes/Hashtag.vue":"4SCA","./nodes/ImageBlock":"bCJs","./nodes/ImageBlock.vue":"bCJs","./nodes/LayoutBlock":"XQm6","./nodes/LayoutBlock.vue":"XQm6","./nodes/LayoutColumn":"4mdy","./nodes/LayoutColumn.vue":"4mdy","./nodes/LinkBlock":"OjgZ","./nodes/LinkBlock.vue":"OjgZ","./nodes/LinkMedia":"dHcr","./nodes/LinkMedia.vue":"dHcr","./nodes/Mention":"m05q","./nodes/Mention.vue":"m05q","./nodes/VideoBlock":"x/f0","./nodes/VideoBlock.vue":"x/f0","./suggestion/Hashtag":"uOwq","./suggestion/Hashtag.vue":"uOwq","./suggestion/User":"TQrF","./suggestion/User.vue":"TQrF","./toolbar/NodeBar":"ZaZK","./toolbar/NodeBar.vue":"ZaZK","./toolbar/Toolbar":"ro6s","./toolbar/Toolbar.vue":"ro6s","./toolbar/ToolbarButton":"CRnz","./toolbar/ToolbarButton.vue":"CRnz","./toolbar/ToolbarButtonIcon":"tIib","./toolbar/ToolbarButtonIcon.vue":"tIib","./upload/ExtraFileUploadModal":"16vE","./upload/ExtraFileUploadModal.vue":"16vE","./upload/FilePicker":"+hvo","./upload/FilePicker.vue":"+hvo"};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id="nHbi"},fC82:function(e,t,n){var i={"./ComponentView":"e4D7","./ComponentView.js":"e4D7","./Editor":"i77D","./Editor.js":"i77D","./WekaValue":"y7sX","./WekaValue.js":"y7sX","./api":"Vulv","./api.js":"Vulv","./extensions/Base":"keTO","./extensions/Base.js":"keTO","./extensions/alignment":"MLis","./extensions/alignment.js":"MLis","./extensions/attachment":"uX+G","./extensions/attachment.js":"uX+G","./extensions/emoji":"9DO/","./extensions/emoji.js":"9DO/","./extensions/hashtag":"Xj/A","./extensions/hashtag.js":"Xj/A","./extensions/layout":"S+fX","./extensions/layout.js":"S+fX","./extensions/link":"TPYw","./extensions/link.js":"TPYw","./extensions/list":"9OSA","./extensions/list.js":"9OSA","./extensions/media":"QxpW","./extensions/media.js":"QxpW","./extensions/mention":"HMgp","./extensions/mention.js":"HMgp","./extensions/ruler":"O/wH","./extensions/ruler.js":"O/wH","./extensions/text":"HSer","./extensions/text.js":"HSer","./extensions/util":"IlVy","./extensions/util.js":"IlVy","./helpers/ExtrasNodeTracker":"Z4hE","./helpers/ExtrasNodeTracker.js":"Z4hE","./helpers/editor":"G6bi","./helpers/editor.js":"G6bi","./helpers/file":"wtEd","./helpers/file.js":"wtEd","./helpers/media":"/VMM","./helpers/media.js":"/VMM","./helpers/mention":"Y3Em","./helpers/mention.js":"Y3Em","./helpers/suggestion":"kKM0","./helpers/suggestion.js":"kKM0","./integration":"pwZ9","./integration.js":"pwZ9","./interface":"IlmE","./interface.js":"IlmE","./keymap":"aTpb","./keymap.js":"aTpb","./lib/prosemirror_schema_list/schema_list":"fLDo","./lib/prosemirror_schema_list/schema_list.js":"fLDo","./lib/prosemirror_utils/helpers":"BEWS","./lib/prosemirror_utils/helpers.js":"BEWS","./lib/prosemirror_utils/selection":"2l2b","./lib/prosemirror_utils/selection.js":"2l2b","./lib/prosemirror_utils/transforms":"RB/O","./lib/prosemirror_utils/transforms.js":"RB/O","./mixins/attachment_mixin":"BjMn","./mixins/attachment_mixin.js":"BjMn","./plugins/attachment":"h5d1","./plugins/attachment.js":"h5d1","./plugins/cursor_inside_node":"EUlj","./plugins/cursor_inside_node.js":"EUlj","./plugins/emoji":"EJ04","./plugins/emoji.js":"EJ04","./plugins/hashtag":"dUEx","./plugins/hashtag.js":"dUEx","./plugins/mention":"5AuC","./plugins/mention.js":"5AuC","./plugins/text_placeholder":"W3oP","./plugins/text_placeholder.js":"W3oP","./schema":"+89I","./schema.js":"+89I","./toolbar":"HXa6","./toolbar.js":"HXa6","./transaction":"1ahB","./transaction.js":"1ahB","./util":"bIqi","./util.js":"bIqi","./utils/list":"swIM","./utils/list.js":"swIM","./utils/upload":"NWA4","./utils/upload.js":"NWA4"};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id="fC82"},B9Lp:function(e,t,n){var i={"./WekaIntegration":"IQwa","./WekaIntegration.vue":"IQwa","./fixtures/WekaBasic":"HL2A","./fixtures/WekaBasic.vue":"HL2A","./fixtures/WekaWithLearn":"5h37","./fixtures/WekaWithLearn.vue":"5h37"};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id="B9Lp"},F8Pd:function(e,t){"use strict";t.Z={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_get_draft_file"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"item_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filename"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"file"},name:{kind:"Name",value:"editor_weka_draft_file"},arguments:[{kind:"Argument",name:{kind:"Name",value:"item_id"},value:{kind:"Variable",name:{kind:"Name",value:"item_id"}}},{kind:"Argument",name:{kind:"Name",value:"filename"},value:{kind:"Variable",name:{kind:"Name",value:"filename"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file_size"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mime_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"force_download"},value:{kind:"BooleanValue",value:!1}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"download_url"},name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"force_download"},value:{kind:"BooleanValue",value:!0}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"media_type"},arguments:[],directives:[]}]}}]}}]}},OWv5:function(e,t){"use strict";t.Z={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_get_repository_data"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"repository_data"},name:{kind:"Name",value:"editor_weka_repository_data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repository_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"max_bytes"},arguments:[],directives:[]}]}}]}}]}},"0TLR":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var i=n("GggH"),r=n("37Fk"),o=n("KCiO"),a=n.n(o),s=n("7mX8"),u=n.n(s),l=n("U0bO"),c=n("yQz/"),d=n.n(c),p=n("i77D"),f=tui.require("tui/components/editor/EditorLoading"),m=n.n(f),h=tui.require("editor_weka/components/toolbar/Toolbar"),v=n.n(h),_=n("xIDV"),k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_weka"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"variant_name"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_alphaext"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extra_extensions"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"editor"},name:{kind:"Name",value:"editor_weka_editor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"usage_identifier"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"ObjectField",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"extensions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"usage_identifier"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"ObjectField",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"variant_name"},value:{kind:"Variable",name:{kind:"Name",value:"variant_name"}}},{kind:"Argument",name:{kind:"Name",value:"extra_extensions"},value:{kind:"Variable",name:{kind:"Name",value:"extra_extensions"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tuicomponent"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_weka_nosession"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"variant_name"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_alphaext"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extra_extensions"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"editor"},name:{kind:"Name",value:"editor_weka_editor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"usage_identifier"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"ObjectField",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"extensions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"usage_identifier"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"ObjectField",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"variant_name"},value:{kind:"Variable",name:{kind:"Name",value:"variant_name"}}},{kind:"Argument",name:{kind:"Name",value:"extra_extensions"},value:{kind:"Variable",name:{kind:"Name",value:"extra_extensions"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tuicomponent"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]}]}}]}}]},y=n("wtEd"),w=n("y7sX"),b=tui.require("tui/vue_util"),x=function(e,t){return JSON.stringify(t)==JSON.stringify(e)},N=function(e){return(0,b.createImmutablePropWatcher)("Weka",e,x)},I={components:{EditorLoading:m(),Toolbar:v()},props:{placeholder:{type:String,default:""},fileItemId:[Number,String],contextId:[Number,String],usageIdentifier:{type:Object,validator:function(e){return"component"in e&&"area"in e},default:function(){return{component:"editor_weka",area:"learn"}}},variant:String,options:{type:Object,validator:function(e){return void 0!==e.extensions}},value:w.default,compact:Boolean,stickyToolbar:{type:Boolean,default:!0},isLoggedIn:{type:Boolean,default:!0},extraExtensions:{type:Array,validator:function(e){return e.every((function(e){return"string"==typeof e||"name"in e}))}},disabled:Boolean,ariaLabel:String,ariaLabelledby:String,ariaDescribedby:String,ariaInvalid:String},data:function(){return{toolbarItems:[],ready:!1}},computed:{showToolbar:function(){return!this.compact&&this.toolbarItems.length>0},variantUsageIdentifierCombo:function(){return[this.variant,this.usageIdentifier]},computedExtraExtensions:function(){return this.extraExtensions?this.extraExtensions.map((function(e){return"string"==typeof e?{name:e}:e})):null}},watch:{value:function(e){this.displayedValue!==e&&(this.displayedValue=e||w.default.empty(),this.editor&&this.editor.setValue(this.displayedValue))},variant:N("variant"),options:N("options"),extraExtensions:N("extraExtensions"),fileItemId:function(e){this.editor&&this.isLoggedIn&&this.editor.updateFileItemId(e)},disabled:function(e){this.editor&&(this.editor.setEditable(!e),this.editor.view&&(this.updateToolbar(),this.editor.forceRerenderView()))}},created:function(){var e=this;this.updateToolbarThrottled=(0,l.throttle)(this.updateToolbar,100),this.value?this.displayedValue=this.value:this.displayedValue=w.default.empty(),this.finalOptions=null,this.$watch("variantUsageIdentifierCombo",(function(){var t;(t=e).options||!t.usageIdentifier||t.variant||console.warn('[Weka] Passing usage-identifier without variant (which will construct a variant from usage-identifier) was deprecated in Totara 17. Please update your code to pass a variant explicitly (e.g. variant="standard") as in a future release, variant will default to "standard" even when usage-identifier is passed.')}),{immediate:!0})},mounted:function(){this.createEditor()},beforeDestroy:function(){this.editor&&this.editor.destroy()},methods:{setupOptions:function(){var e=this;return(0,r.Z)(a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.options){t.next=3;break}return e.finalOptions=Object.assign({},e.options),t.abrupt("return");case 3:return t.next=5,e.$apollo.query({query:e.isLoggedIn?k:g,fetchPolicy:"no-cache",variables:{instance_id:e.usageIdentifier.instanceId,component:e.usageIdentifier.component,area:e.usageIdentifier.area,context_id:e.contextId||void 0,extra_extensions:e.computedExtraExtensions?JSON.stringify(e.computedExtraExtensions):void 0,variant_name:e.variant||"".concat(e.usageIdentifier.component,"-").concat(e.usageIdentifier.area)}});case 5:n=t.sent,e.finalOptions=Object.assign({},n.data.editor);case 7:case"end":return t.stop()}}),t)})))()},getExtensions:function(){var e=this;return(0,r.Z)(a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setupOptions();case 2:if(n=[],!Array.isArray(e.finalOptions.extensions)){t.next=7;break}return t.next=6,Promise.all(e.finalOptions.extensions.map((function(e){var t=e.tuicomponent,n=e.options,r={};return null!=n&&(r="object"===(0,i.Z)(n)?n:JSON.parse(n)),u().import(t).then((function(e){return u().defaultExport(e)(r)}))})));case 6:n=t.sent;case 7:return t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})))()},createEditor:function(){var e=this;return(0,r.Z)(a().mark((function t(){var n,i,r,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.editor){t.next=2;break}return t.abrupt("return");case 2:return n=d()("weka"),t.next=5,e.getExtensions();case 5:return i=t.sent,r=new y.default({itemId:e.fileItemId,contextId:e.finalOptions.context_id||null}),e.editor=new p.default({value:e.displayedValue,placeholder:e.placeholder,parent:e,extensions:i,fileStorage:r,onUpdate:e.$_onUpdate.bind(e),contextId:e.finalOptions.context_id||null,component:e.usageIdentifier.component||null,area:e.usageIdentifier.area||null,instanceId:e.usageIdentifier.instanceId||null,ariaLabel:e.ariaLabel,ariaLabelledby:e.ariaLabelledby,ariaDescribedby:e.ariaDescribedby,ariaInvalid:e.ariaInvalid,editable:function(){return!e.disabled},onTransaction:function(){e.updateToolbarThrottled()},onFocus:function(t){e.$emit("focus",t)},onBlur:function(t){e.$emit("blur",t)}}),o=e.editor.allVueComponents(),t.next=11,Promise.all([u().loadRequirements({components:o}),(0,_.loadLangStrings)(e.editor.allStrings())]);case 11:return e.ready=!0,t.next=14,e.$nextTick();case 14:e.editor.setElements({viewExtras:e.$refs.extras,viewExtrasLive:e.$refs.extrasLive}),e.view=e.editor.createView(e.$refs.editorHost),e.updateToolbar(),n(),e.$emit("ready");case 19:case"end":return t.stop()}}),t)})))()},updateToolbar:function(){this.editor.destroyed||(this.toolbarItems=this.editor.getToolbarItems())},$_onUpdate:function(e){this.displayedValue=e,this.$emit("input",e)}}},S=(0,n("wWJ2").Z)(I,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.ready?n("div",{directives:[{name:"focus-within",rawName:"v-focus-within"}],staticClass:"tui-weka no-yui-ids",attrs:{id:e.uid}},[e.showToolbar?n("Toolbar",{attrs:{items:e.toolbarItems,sticky:e.stickyToolbar}}):e._e(),e._v(" "),n("div",{ref:"editorHost",staticClass:"tui-weka__editorHost tui-rendered",attrs:{"data-placeholder":e.placeholder}}),e._v(" "),n("div",{ref:"extras"}),e._v(" "),n("div",{ref:"extrasLive",attrs:{"aria-live":"polite",role:"status"}})],1):n("EditorLoading",{attrs:{id:e.uid,compact:e.compact}})}),[],!1,null,null,null);S.options.__hasBlocks={script:!0,template:!0};var O=S.exports},t4Eo:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var i=n("ZkHI"),r=n.n(i),o=n("oFnQ"),a=n.n(o),s=n("VmD8"),u=n.n(s),l={components:{AttachmentNode:r(),NodeBar:a()},mixins:[u()],props:{enableConvert:{type:Boolean,default:!0}},computed:{actions:function(){var e=this,t=[];return this.enableConvert&&t.push({label:this.$str("display_as_embedded_media","editor_weka"),action:function(){e.$emit("convert-to-embedded-media")}}),t=t.concat([{label:this.$str("remove","core"),action:function(){e.$emit("delete")}}]),this.hasDownloadUrl&&t.push({label:this.$str("download","core"),action:function(){e.$emit("download")}}),t}}},c=function(e){e.options.__langStrings={core:["remove","download"],editor_weka:["display_as_embedded_media","actions_menu_for"]}},d=(0,n("wWJ2").Z)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AttachmentNode",{attrs:{filename:e.filename,"file-size":e.fileSize,"item-id":e.draftId,component:"user",area:"draft"}}),e._v(" "),e.disabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)}),[],!1,null,null,null);c(d),d.options.__hasBlocks={script:!0,template:!0};var p=d.exports},mRIW:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var i=n("ZkHI"),r=n.n(i),o=n("oFnQ"),a=n.n(o),s=n("VmD8"),u=n.n(s),l={components:{AttachmentNode:r(),NodeBar:a()},mixins:[u()],computed:{actions:function(){var e=this,t=[{label:this.$str("remove","core"),action:function(){e.$emit("delete")}}];return this.hasDownloadUrl&&t.push({label:this.$str("download","core"),action:function(){e.$emit("download")}}),t}}},c=function(e){e.options.__langStrings={core:["remove","download"],editor_weka:["actions_menu_for"]}},d=(0,n("wWJ2").Z)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AttachmentNode",{attrs:{filename:e.filename,"file-size":e.fileSize,"item-id":e.draftId,component:"user",area:"draft"}}),e._v(" "),e.disabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)}),[],!1,null,null,null);c(d),d.options.__hasBlocks={script:!0,template:!0};var p=d.exports},oxqV:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var i=n("ZkHI"),r=n.n(i),o=n("oFnQ"),a=n.n(o),s=n("VmD8"),u=n.n(s),l={components:{AttachmentNode:r(),NodeBar:a()},mixins:[u()],props:{enableConvert:{type:Boolean,default:!0}},data:function(){return{showModal:!1}},computed:{actions:function(){var e=this,t=[];return this.enableConvert&&t.push({label:this.$str("display_as_embedded_media","editor_weka"),action:function(){e.$emit("convert-to-embedded-media")}}),t=t.concat([{label:this.$str("remove","core"),action:function(){e.$emit("delete")}}]),this.hasDownloadUrl&&t.push({label:this.$str("download","core"),action:function(){e.$emit("download")}}),t}}},c=function(e){e.options.__langStrings={core:["download","remove"],editor_weka:["display_as_embedded_media","actions_menu_for"]}},d=(0,n("wWJ2").Z)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AttachmentNode",{attrs:{filename:e.filename,"file-size":e.fileSize,component:"user",area:"draft","item-id":e.draftId}}),e._v(" "),e.disabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)}),[],!1,null,null,null);c(d),d.options.__hasBlocks={script:!0,template:!0};var p=d.exports},jzcC:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var i=n("ZkHI"),r=n.n(i),o=n("oFnQ"),a=n.n(o),s=n("VmD8"),u=n.n(s),l={components:{NodeBar:a(),AttachmentNode:r()},mixins:[u()],props:{enableConvert:{type:Boolean,default:!0}},computed:{actions:function(){var e=this,t=[];return this.enableConvert&&t.push({label:this.$str("display_as_embedded_media","editor_weka"),action:function(){e.$emit("convert-to-embedded-media")}}),t=t.concat([{label:this.$str("remove","core"),action:function(){e.$emit("delete")}}]),this.hasDownloadUrl&&t.push({label:this.$str("download","core"),action:function(){e.$emit("download")}}),t}}},c=function(e){e.options.__langStrings={editor_weka:["display_as_embedded_media","actions_menu_for"],core:["remove","download"]}},d=(0,n("wWJ2").Z)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AttachmentNode",{attrs:{filename:e.filename,"file-size":e.fileSize,"item-id":e.draftId,component:"user",area:"draft"}}),e._v(" "),e.disabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)}),[],!1,null,null,null);c(d),d.options.__hasBlocks={script:!0,template:!0};var p=d.exports},"3R3+":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var i=n("3NWB"),r=n.n(i),o=n("DS3U"),a=n.n(o),s={components:{Dropdown:r(),DropdownButton:a()},props:{position:String,open:Boolean,actions:Array,contextMode:String}},u=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dropdown",{attrs:{position:e.position,open:e.open,"context-mode":e.contextMode},on:{dismiss:function(t){return e.$emit("dismiss")}},scopedSlots:e._u([{key:"trigger",fn:function(t){return[e._t("trigger",null,null,t)]}}],null,!0)},[e._v(" "),e._t("dropdown-items",(function(){return e._l(e.actions,(function(t,i){return n("DropdownButton",{key:i,on:{click:function(e){return e.preventDefault(),t.action()}}},[n("div",{staticClass:"tui-editor_weka-actionDropdown__dropdownItemContent"},[t.iconComponent?n("div",{staticClass:"tui-editor_weka-actionDropdown__dropdownItemIcon"},[n(t.iconComponent,{tag:"component"})],1):e._e(),e._v("\n        "+e._s(t.label)+"\n      ")])])}))}))],2)}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};var l=u.exports},zAJu:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var i=n("ApK1"),r=n.n(i),o=n("IACo"),a=n.n(o),s=n("GLpC"),u=n.n(s),l=n("IgBQ"),c=n.n(l),d=n("eHBv"),p=n.n(d),f=n("IpiT"),m=n.n(f),h=n("ddQy"),v=n.n(h),_={components:{Modal:a(),ModalContent:u(),Form:r(),InputText:c(),ButtonGroup:p(),Button:m(),ButtonCancel:v()},props:{value:String},data:function(){return{innerValue:this.value}},computed:{modalTitle:function(){return this.value?this.$str("edit_image_alt_text","editor_weka"):this.$str("add_image_alt_text","editor_weka")}},mounted:function(){var e=this;this.$nextTick((function(){e.$refs.altTextRef&&e.$refs.altTextRef.$el&&e.$refs.altTextRef.$el.focus()}))},methods:{confirm:function(){this.$emit("change",this.innerValue)}}},k=function(e){e.options.__langStrings={editor_weka:["add_image_alt_text","edit_image_alt_text","done","image_alt_help"]}},g=(0,n("wWJ2").Z)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"tui-wekaEditImageAltTextModal",attrs:{"aria-labelledby":e.$id("title"),dismissable:{backdropClick:!1}}},[n("ModalContent",{staticClass:"tui-wekaEditImageAltTextModal__content",attrs:{title:e.modalTitle,"title-id":e.$id("title")}},[n("Form",{attrs:{"input-width":"full"},on:{submit:function(t){return t.preventDefault(),e.confirm.apply(null,arguments)}}},[n("div",{staticClass:"tui-wekaEditImageAltTextModal__input"},[n("InputText",{ref:"altTextRef",attrs:{maxlength:120,"char-length":"full",autofocus:!0},model:{value:e.innerValue,callback:function(t){e.innerValue=t},expression:"innerValue"}}),e._v(" "),n("p",{staticClass:"tui-wekaEditImageAltTextModal__input-helpText"},[e._v("\n          "+e._s(e.$str("image_alt_help","editor_weka"))+"\n        ")])],1),e._v(" "),n("ButtonGroup",{staticClass:"tui-wekaEditImageAltTextModal__buttonGroup"},[n("Button",{attrs:{disabled:!e.innerValue,styleclass:{primary:"true"},text:e.$str("done","editor_weka")},on:{click:e.confirm}}),e._v(" "),n("ButtonCancel",{on:{click:function(t){return t.preventDefault(),e.$emit("request-close")}}})],1)],1)],1)],1)}),[],!1,null,null,null);k(g),g.options.__hasBlocks={script:!0,template:!0};var y=g.exports},DwUL:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var i=n("Aely"),r=n.n(i),o=n("ApK1"),a=n.n(o),s=n("2XTD"),u=n.n(s),l=n("IgBQ"),c=n.n(l),d=tui.require("tui/components/form/Checkbox"),p=n.n(d),f=n("IACo"),m=n.n(f),h=n("GLpC"),v=n.n(h),_=n("IpiT"),k=n.n(_),g=n("ddQy"),y=n.n(g),w=n("eHBv"),b=n.n(w),x={components:{Form:a(),FormRow:u(),InputText:c(),Checkbox:p(),Modal:m(),ModalContent:v(),Button:k(),ButtonCancel:y(),ButtonGroup:b()},props:{isNew:Boolean,attrs:Object,save:Function,isMedia:Function},data:function(){return{openInNewWindow:this.attrs.open_in_new_window,url:this.attrs.url,text:this.attrs.text,loading:!1,display:this.attrs.type||"link",wasText:!!this.attrs.text,error:null}},computed:{urlIsMedia:function(){return this.isMedia&&this.isMedia(this.url)},formValue:function(){return{type:this.display,url:this.url,text:this.text,open_in_new_window:this.openInNewWindow}},formValid:function(){return!!this.url}},watch:{urlIsMedia:function(e){this.wasText||(this.display=e?"link_media":"link")},formValue:function(){this.error=null},openInNewWindow:function(e){!0===e&&(this.text?this.text=this.$str("opens_in_new_windowx","editor_weka",this.text):this.text=this.$str("opens_in_new_windowx","editor_weka",this.url))}},mounted:function(){var e=this;r().nextTick((function(){e.$refs.url&&e.$refs.url.$el&&e.$refs.url.$el.focus()}))},methods:{close:function(){this.$emit("request-close")},confirm:function(){var e=this;if(!this.loading){this.loading=!0;var t=this.formValue;t.url=this.fixUrl(t.url),Promise.resolve(this.save(t)).then(this.close).catch((function(e){console.error(e)})).then((function(){return e.loading=!1}))}},updateText:function(e){this.text=e},fixUrl:function(e){try{new URL(e)}catch(t){return e.startsWith("/")||e.startsWith("#")?e:"http://".concat(e)}return e}}},N=function(e){e.options.__langStrings={core:["cancel","ok"],editor:["linkurl"],editor_weka:["done","displayas","display_text","edit_link_label","insert_link_label","error_no_url_info","open_in_new_window","opens_in_new_windowx"]}},I=(0,n("wWJ2").Z)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{size:"normal","aria-labelledby":e.$id("title"),dismissable:{backdropClick:!1}}},[n("ModalContent",{attrs:{title:e.isNew?e.$str("insert_link_label","editor_weka"):e.$str("edit_link_label","editor_weka"),"title-id":e.$id("title"),"close-button":!0},scopedSlots:e._u([{key:"buttons",fn:function(){return[n("ButtonGroup",[n("Button",{attrs:{styleclass:{primary:"true"},text:e.$str("done","editor_weka"),disabled:!e.formValid||e.loading},on:{click:e.confirm}}),e._v(" "),n("ButtonCancel",{on:{click:e.close}})],1)]},proxy:!0}])},[n("Form",{attrs:{"input-width":"full"},on:{submit:function(t){return t.preventDefault(),e.confirm.apply(null,arguments)}}},[e.error?n("p",[e._v(e._s(e.error))]):e._e(),e._v(" "),n("FormRow",{attrs:{label:e.$str("linkurl","editor")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("InputText",{ref:"url",attrs:{id:i,autofocus:!0},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})]}}])}),e._v(" "),n("FormRow",{attrs:{label:e.$str("display_text","editor_weka")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("InputText",{attrs:{id:i,value:"link"==e.display?e.text:"",disabled:"link"!=e.display},on:{input:e.updateText}})]}}])}),e._v(" "),e.urlIsMedia?e._e():n("FormRow",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("Checkbox",{attrs:{id:i},model:{value:e.openInNewWindow,callback:function(t){e.openInNewWindow=t},expression:"openInNewWindow"}},[e._v("\n          "+e._s(e.$str("open_in_new_window","editor_weka"))+"\n        ")])]}}],null,!1,3837602781)}),e._v(" "),n("input",{style:{display:"none"},attrs:{type:"submit"}})],1)],1)],1)}),[],!1,null,null,null);N(I),I.options.__hasBlocks={script:!0,template:!0};var S=I.exports},ju6e:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var i=n("1+j7"),r=n.n(i),o=n("+Hsq"),a=n.n(o),s={components:{ButtonIcon:r(),Emoji:a()},props:{emojis:{type:Array,required:!0,validator:function(e){return e.every((function(e){return"shortcode"in e}))}}},methods:{select:function(e){this.$emit("emoji-selected",e)},fromShortCode:function(e){return String.fromCodePoint("0x"+e)}}},u=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaEmojiSelector"},e._l(e.emojis,(function(t,i){return n("ButtonIcon",{key:i,attrs:{styleclass:{stealth:!0},"aria-label":e.fromShortCode(t.shortcode)},nativeOn:{click:function(n){return e.select(t)}}},[n("Emoji",{staticClass:"tui-wekaEmojiSelector__emoji",attrs:{"short-code":t.shortcode}})],1)})),1)}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};var l=u.exports},kBMv:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("xZv7"),r={components:{ActionDropdown:n.n(i)()},props:{location:{type:Object,validator:function(e){return"x"in e&&"y"in e}},actions:Array},computed:{wrapperStyle:function(){return{position:"absolute",left:this.location.x+"px",top:this.location.y+"px"}}}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:e.wrapperStyle},[n("ActionDropdown",{attrs:{actions:e.actions,open:!0},on:{dismiss:function(t){return e.$emit("dismiss")}},scopedSlots:e._u([{key:"trigger",fn:function(t){return[e._t("trigger",null,null,t)]}}],null,!0)})],1)}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},fBuu:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("6tNc"),r={components:{LayoutIconBase:n.n(i)()}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(e){var t=e.strokeClass;return[n("rect",{class:t,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}})]}}])})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},"1FyB":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("6tNc"),r={components:{LayoutIconBase:n.n(i)()}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.strokeClass;return[n("rect",{class:i,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}}),e._v(" "),n("line",{class:i,attrs:{x1:"12.5",y1:"4",x2:"12.5",y2:"20"}})]}}])})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},"Cl/n":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("6tNc"),r={components:{LayoutIconBase:n.n(i)()}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.strokeClass,r=t.semiFillClass;return[n("rect",{class:i,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}}),e._v(" "),n("path",{class:[i,r],attrs:{d:"M0.5 6C0.5 5.17157 1.17157 4.5 2 4.5H7.5V19.5H2C1.17157 19.5 0.5 18.8284 0.5 18V6Z"}}),e._v(" "),n("line",{class:i,attrs:{x1:"7.5",y1:"4",x2:"7.5",y2:"20"}})]}}])})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},leJy:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("6tNc"),r={components:{LayoutIconBase:n.n(i)()}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.strokeClass,r=t.semiFillClass;return[n("rect",{class:i,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}}),e._v(" "),n("path",{class:[i,r],attrs:{d:"M16.5 4.5H22C22.8284 4.5 23.5 5.17157 23.5 6V18C23.5 18.8284 22.8284 19.5 22 19.5H16.5V4.5Z"}}),e._v(" "),n("line",{class:i,attrs:{x1:"16.5",y1:"4",x2:"16.5",y2:"20"}})]}}])})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},"/wsq":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("6tNc"),r={components:{LayoutIconBase:n.n(i)()}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("LayoutIconBase",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.strokeClass;return[n("rect",{class:i,attrs:{x:"0.5",y:"4.5",width:"23",height:"15",rx:"1.5"}}),e._v(" "),n("line",{class:i,attrs:{x1:"16.5",y1:"4",x2:"16.5",y2:"20"}}),e._v(" "),n("line",{class:i,attrs:{x1:"8.5",y1:"4",x2:"8.5",y2:"20"}}),e._v(" "),n("line",{class:i,attrs:{x1:"8.5",y1:"4",x2:"8.5",y2:"20"}})]}}])})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},Nmbj:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return r}});var i=(0,n("wWJ2").Z)({},(function(){var e=this,t=e.$createElement;return(e._self._c||t)("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"}},[e._t("default",null,{strokeClass:"tui-editor_weka-layoutIcon24Base__stroke",semiFillClass:"tui-editor_weka-layoutIcon24Base__semiFill"})],2)}),[],!1,null,null,null);i.options.__hasBlocks={script:!1,template:!0};var r=i.exports},"+z7R":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var i=n("TVjX"),r=n.n(i),o=n("yQz/"),a=n.n(o),s={extends:r(),props:{ariaLabel:String},data:function(){return{textContent:"",dropdownShown:!1}},mounted:function(){this.observer=new MutationObserver(this.$_updateTextContent),this.observer.observe(this.$refs.content,{childList:!0,subtree:!0,characterData:!0}),this.$_updateTextContent()},beforeDestroy:function(){this.observer.disconnect()},methods:{showDropdown:function(){var e=this;this.context.showMarkDropdown(this.getRange).then((function(t){e.dropdownShown=!0,t.$on("dismiss",(function(){return e.dropdownShown=!1}))}))},$_updateTextContent:function(){var e=this,t=a()();setTimeout((function(){t(),e.textContent=e.$refs.content.textContent}),0)}}},u=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("a",{ref:"content",attrs:{href:e.attrs.href,title:e.attrs.title,target:e.attrs.open_in_new_window?"_blank":null},on:{click:e.showDropdown}})}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};var l=u.exports},XBjH:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var i={directives:{"weka-node-ui":n("gFJZ").wekaNodeUI},props:{contextMode:{type:String,required:!0,validator:function(e){return"contained"===e||"uncontained"===e}}},provide:function(){return{wekaNodeMenuContext:this.wekaNodeMenuContext}},computed:{wekaNodeMenuContext:function(){return{contextMode:this.contextMode}}}},r=(0,n("wWJ2").Z)(i,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{directives:[{name:"weka-node-ui",rawName:"v-weka-node-ui"}],staticClass:"tui-editor_weka-nodeMenu",attrs:{contenteditable:"false"}},[e._t("default")],2)}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};var o=r.exports},Xtc8:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var i=n("xZv7"),r=n.n(i),o=n("oXL3"),a=n.n(o),s={components:{ActionDropdown:r(),NodeMenuButton:a()},props:{text:String,ariaLabel:String,title:String,position:String,actions:Array,caret:{type:Boolean,default:!0},buttonAttrs:Object},inject:["wekaNodeMenuContext"],computed:{contextMode:function(){return this.wekaNodeMenuContext&&this.wekaNodeMenuContext.contextMode}}},u=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ActionDropdown",{attrs:{position:e.position,actions:e.actions,"context-mode":e.contextMode},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,r=t.isOpen;return[n("NodeMenuButton",e._b({attrs:{text:e.text,"aria-expanded":r.toString(),"aria-label":e.ariaLabel,title:e.title,caret:e.caret},on:{click:i},scopedSlots:e._u([e.$scopedSlots.icon?{key:"icon",fn:function(){return[e._t("icon")]},proxy:!0}:null],null,!0)},"NodeMenuButton",e.buttonAttrs,!1))]}}])})}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};var l=u.exports},jRPZ:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var i=tui.require("tui/components/buttons/ButtonAria"),r=n.n(i),o=tui.require("tui/components/decor/Caret"),a=n.n(o),s={components:{ButtonAria:r(),Caret:a()},props:{text:String,caret:Boolean},computed:{iconOnly:function(){return this.$scopedSlots.icon&&!this.text&&!this.caret}},methods:{handleClick:function(e){this.$emit("click",e)}}},u=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ButtonAria",[n("div",{staticClass:"tui-editor_weka-nodeMenuButton",class:{"tui-editor_weka-nodeMenuButton--iconOnly":e.iconOnly},on:{click:e.handleClick}},[e.$scopedSlots.icon?n("div",{staticClass:"tui-editor_weka-nodeMenuButton__icon"},[e._t("icon")],2):e._e(),e._v("\n    "+e._s(e.text)+"\n    "),e.caret?n("Caret",{staticClass:"tui-editor_weka-nodeMenuButton__caret"}):e._e()],1)])}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};var l=u.exports},FphW:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return r}});var i=(0,n("wWJ2").Z)({},(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"tui-editor_weka-nodeMenuGroup"},[e._t("default")],2)}),[],!1,null,null,null);i.options.__hasBlocks={script:!1,template:!0};var r=i.exports},aKDM:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n("lhYX"),r=n.n(i),o=n("x7h9"),a=n.n(o),s={components:{NodeMenuActionDropdown:r(),MoreIcon:a()},props:{text:String,position:{type:String,default:"bottom-right"},actions:Array}},u=function(e){e.options.__langStrings={editor_weka:["more_options"]}},l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("NodeMenuActionDropdown",{attrs:{position:e.position,actions:e.actions,"aria-label":e.$str("more_options","editor_weka"),title:e.$str("more_options","editor_weka"),caret:!1,"button-attrs":{"data-weka-more":"true"}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("MoreIcon")]},proxy:!0}])})}),[],!1,null,null,null);u(l),l.options.__hasBlocks={script:!0,template:!0};var c=l.exports},l0e3:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var i=n("37Fk"),r=n("KCiO"),o=n.n(r),a=n("TVjX"),s=n.n(a),u=n("F8Pd"),l=n("/VMM"),c=tui.require("editor_weka/components/attachments/ImageAttachment"),d=n.n(c),p=tui.require("editor_weka/components/attachments/FileAttachment"),f=n.n(p),m=tui.require("editor_weka/components/attachments/VideoAttachment"),h=n.n(m),v=tui.require("editor_weka/components/attachments/AudioAttachment"),_=n.n(v),k={components:{ImageAttachment:d(),FileAttachment:f(),VideoAttachment:h(),AudioAttachment:_()},extends:s(),apollo:{file:{query:u.Z,variables:function(){return{item_id:this.itemId,filename:this.filename}}}},data:function(){return{file:{}}},computed:{isImage:function(){return this.file&&this.file.media_type===l.IMAGE},isVideo:function(){return this.file&&this.file.media_type===l.VIDEO},isAudio:function(){return this.file&&this.file.media_type===l.AUDIO},itemId:function(){return this.context.getItemId()},filename:function(){var e=this.attrs;return e.filename?e.filename:this.$str("unknown_attachment","editor_weka")},option:function(){return this.attrs.option},hasImageNode:function(){return this.context.hasImageNode()},hasVideoNode:function(){return this.context.hasVideoNode()},hasAudioNode:function(){return this.context.hasAudioNode()},downloadUrl:function(){return null}},methods:{toImage:function(){var e={filename:this.filename,alttext:this.option.alttext||null};this.context.convertToImage(this.getRange,e)},updateAltText:function(e){this.$_updateNode({filename:this.filename,size:this.file?this.file.file_size:this.attrs.size,option:{alttext:e}})},$_updateNode:function(e){this.context.updateNode(this.getRange,e)},toVideo:function(){var e={filename:this.filename,mimeType:this.file.mime_type,subtitle:this.option.subtitle||null};this.context.convertToVideo(this.getRange,e)},toAudio:function(){var e={filename:this.filename,mimeType:this.file.mime_type,transcript:this.option.transcript||null};this.context.convertToAudio(this.getRange,e)},removeNode:function(){this.context.removeNode(this.getRange)},download:function(){var e=this;return(0,i.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=window,t.next=3,e.context.getDownloadUrl(e.filename);case 3:t.t1=t.sent,t.t0.open.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t)})))()}}},g=function(e){e.options.__langStrings={editor_weka:["unknown_attachment"]}},y=(0,n("wWJ2").Z)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaAttachment"},[e.$apollo.loading?e._e():[e.isImage?n("ImageAttachment",{attrs:{"file-size":e.file?e.file.file_size:0,"draft-id":e.itemId,filename:e.filename,"alt-text":e.option.alttext||null,"enable-convert":e.hasImageNode,"has-download-url":!0,disabled:e.editorDisabled},on:{"convert-to-embedded-media":e.toImage,"update-alt-text":e.updateAltText,delete:e.removeNode,download:e.download}}):e.isVideo?n("VideoAttachment",{attrs:{"file-size":e.file?e.file.file_size:0,"draft-id":e.itemId,filename:e.filename,"enable-convert":e.hasVideoNode,"has-download-url":!0,disabled:e.editorDisabled},on:{"convert-to-embedded-media":e.toVideo,delete:e.removeNode,download:e.download}}):e.isAudio?n("AudioAttachment",{attrs:{"file-size":e.file?e.file.file_size:0,"draft-id":e.itemId,filename:e.filename,"enable-convert":e.hasAudioNode,"has-download-url":!0,disabled:e.editorDisabled},on:{"convert-to-embedded-media":e.toAudio,delete:e.removeNode,download:e.download}}):n("FileAttachment",{attrs:{"file-size":e.file?e.file.file_size:0,filename:e.filename,"draft-id":e.itemId,"has-download-url":!0,disabled:e.editorDisabled},on:{delete:e.removeNode,download:e.download}})]],2)}),[],!1,null,null,null);g(y),y.options.__hasBlocks={script:!0,template:!0};var w=y.exports},uTni:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=tui.require("tui/components/json_editor/nodes/AttachmentNodeCollection"),r={components:{AttachmentNodeCollection:n.n(i)()}},o=(0,n("wWJ2").Z)(r,(function(){var e=this.$createElement,t=this._self._c||e;return t("AttachmentNodeCollection",{staticClass:"tui-wekaAttachments"},[t("div",{ref:"content",staticClass:"tui-wekaAttachments__content"})])}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},Jgzi:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var i=n("37Fk"),r=n("KCiO"),o=n.n(r),a=tui.require("tui/components/json_editor/nodes/AudioBlock"),s=n.n(a),u=n("TVjX"),l=n.n(u),c=n("F8Pd"),d=n("oFnQ"),p=n.n(d),f=n("EJOt"),m=n.n(f),h=n("9lfe"),v=n.n(h),_=n("IpiT"),k={components:{Button:n.n(_)(),CoreAudioBlock:s(),NodeBar:p(),ModalPresenter:m(),ExtraFileUploadModal:v()},extends:l(),apollo:{file:{query:c.Z,variables:function(){return{item_id:this.itemId,filename:this.filename}}}},data:function(){return{file:{},showModal:!1}},computed:{actions:function(){return[this.hasAttachmentNode&&{label:this.$str("display_as_attachment","editor_weka"),action:this.$_toAttachment},{label:this.$str("upload_transcript","editor_weka"),action:this.openModal},{label:this.$str("remove","core"),action:this.$_removeNode},{label:this.$str("download","core"),action:this.$_download}].filter(Boolean)},itemId:function(){return this.context.getItemId()},contextId:function(){if(!this.context.getContextId)throw new Error("No function 'getContextId' was found from extension");return this.context.getContextId()},filename:function(){return this.attrs.filename?this.attrs.filename:null},transcriptFilename:function(){return this.attrs.transcript?this.attrs.transcript.filename:null},transcriptUrl:function(){return this.attrs.transcript?this.attrs.transcript.url:null},hasAttachmentNode:function(){return this.context.hasAttachmentNode()},transcriptButtonVisible:function(){return!this.editorDisabled&&null===this.attrs.transcript}},methods:{$_removeNode:function(){return this.context.removeNode(this.getRange)},$_toAttachment:function(){if(this.context.replaceWithAttachment){var e={filename:this.filename,size:this.file.file_size,transcript:this.attrs.transcript||null};this.context.replaceWithAttachment(this.getRange,e)}},$_download:function(){var e=this;return(0,i.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=window,t.next=3,e.context.getDownloadUrl(e.filename);case 3:t.t1=t.sent,t.t0.open.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t)})))()},openModal:function(){this.showModal=!0},hideModal:function(){this.showModal=!1},cancel:function(){null===this.transcriptFilename?this.updateTranscript(""):this.hideModal()},onTranscriptChange:function(e){this.updateTranscript(e||"")},updateTranscript:function(e){var t=this;return(0,i.Z)(o().mark((function n(){var i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.hideModal(),t.context.updateAudioWithTranscript){n.next=3;break}return n.abrupt("return");case 3:i=Object.assign({},t.attrs,{transcript:e}),e&&(i.transcript={filename:e.filename,url:e.url}),t.context.updateAudioWithTranscript(t.getRange,i);case 6:case"end":return n.stop()}}),n)})))()}}},g=function(e){e.options.__langStrings={core:["remove","download"],editor_weka:["audio_alt_help","display_as_attachment","actions_menu_for","upload_caption_transcript_button","upload_audio_transcript","upload_transcript","transcript_modal_title_help"]}},y=(0,n("wWJ2").Z)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaAudioBlock"},[e.$apollo.loading?e._e():[n("div",{staticClass:"tui-wekaAudioBlock__inner"},[n("ModalPresenter",{attrs:{open:e.showModal},on:{"request-close":e.cancel}},[n("ExtraFileUploadModal",{attrs:{"item-id":e.itemId,"context-id":e.contextId,"accepted-file-types":[".txt"],"modal-title":e.$str("upload_audio_transcript","editor_weka"),"modal-title-help-text":e.$str("transcript_modal_title_help","editor_weka"),"submit-button-text":e.$str("upload_caption_transcript_button","editor_weka",".txt"),"modal-help-text":e.$str("audio_alt_help","editor_weka"),filename:e.transcriptFilename},on:{change:e.onTranscriptChange}})],1),e._v(" "),n("div",{staticClass:"tui-wekaAudioBlock__positioner"},[e.transcriptButtonVisible?n("Button",{staticClass:"tui-wekaAudioBlock__inner-addtranscriptButton",attrs:{text:e.$str("upload_transcript","editor_weka")},on:{click:e.openModal}}):e._e(),e._v(" "),n("CoreAudioBlock",{attrs:{filename:e.filename,"item-id":e.itemId,url:e.file.url,"mime-type":e.file.mime_type,"transcript-url":e.transcriptUrl}})],1),e._v(" "),e.editorDisabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)]],2)}),[],!1,null,null,null);g(y),y.options.__hasBlocks={script:!0,template:!0};var w=y.exports},AboO:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n("cXde"),r=n("gFJZ"),o=n("Z4hE");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={directives:{"weka-node-ui":r.wekaNodeUI},props:{nodeInfo:Object,contextInfo:Object,updateAttrs:Function,replaceWith:Function,getPos:Function,getRange:Function,editorDisabled:Boolean,selected:Boolean,cursorInside:Boolean},computed:{node:function(){return this.nodeInfo.node},attrs:function(){return this.nodeInfo.node.attrs},context:function(){return this.contextInfo.context}},updated:function(){this.$emit("updated")},methods:{trackInExtras:function(e,t){return new o.default(e,s(s({trackedElAnchor:"top-left",positionedElAnchor:"top-right"},t),{},{trackedEl:t.trackedEl,viewExtrasEl:this.nodeInfo.editor.viewExtrasEl}))}}},l=(0,n("wWJ2").Z)(u,void 0,void 0,!1,null,null,null);l.options.__hasBlocks={script:!0,template:!1};var c=l.exports},"/bhg":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var i=n("+Hsq"),r=n.n(i),o=n("TVjX"),a=n.n(o),s={components:{Emoji:r()},extends:a(),computed:{shortCode:function(){if(this.attrs.shortcode)return this.attrs.shortcode}}},u=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("Emoji",{staticClass:"tui-wekaEmoji",attrs:{"short-code":e.shortCode}})}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};var l=u.exports},Ag1S:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("TVjX"),r={extends:n.n(i)()},o=(0,n("wWJ2").Z)(r,(function(){var e=this.$createElement;return(this._self._c||e)("figcaption",{ref:"content",staticClass:"tui-editor_weka-figureCaption"})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},"4SCA":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var i=n("TVjX"),r=n.n(i),o=tui.require("tui/components/json_editor/nodes/Hashtag"),a=n.n(o),s=n("3NWB"),u=n.n(s),l=n("DS3U"),c=n.n(l),d={components:{Hashtag:a(),Dropdown:u(),DropdownButton:c()},extends:r(),computed:{text:function(){return this.attrs.text},url:function(){return this.$url("/totara/catalog/index.php",{catalog_fts:this.attrs.text})}},methods:{open:function(e){window.open(e)}}},p=function(e){e.options.__langStrings={editor_weka:["actions_menu_for","view_search_results","hashtag"]}},f=(0,n("wWJ2").Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dropdown",{staticClass:"tui-wekaHashtag",attrs:{disabled:e.editorDisabled},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle;return t.isOpen,[n("Hashtag",{attrs:{url:e.url,text:e.$str("hashtag","editor_weka",e.text)},nativeOn:{"!click":function(e){return e.preventDefault(),i.apply(null,arguments)}}})]}}])},[e._v(" "),n("DropdownButton",{on:{click:function(t){return e.open(e.url)}}},[e._v("\n    "+e._s(e.$str("view_search_results","editor_weka"))+"\n  ")])],1)}),[],!1,null,null,null);p(f),f.options.__hasBlocks={script:!0,template:!0};var m=f.exports},bCJs:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var i=n("37Fk"),r=n("KCiO"),o=n.n(r),a=n("KJgz"),s=n.n(a),u=n("vujW"),l=n.n(u),c=n("jGtd"),d=n.n(c),p=tui.require("tui/components/loading/ComponentLoading"),f=n.n(p),m=n("EJOt"),h=n.n(m),v=n("nIqm"),_=tui.require("editor_weka/components/editing/EditImageAltTextModal"),k=n.n(_),g=n("TVjX"),y=n.n(g),w=n("F8Pd"),b={components:{ImageIcon:l(),ResponsiveImage:d(),ComponentLoading:f(),ModalPresenter:h(),NodeMenu:v.NodeMenu,NodeMenuActionDropdown:v.NodeMenuActionDropdown,NodeMenuButton:v.NodeMenuButton,NodeMenuGroup:v.NodeMenuGroup,NodeMenuMoreDropdown:v.NodeMenuMoreDropdown,EditImageAltTextModal:k()},extends:y(),apollo:{file:{query:w.Z,variables:function(){return{filename:this.filename,item_id:this.itemId}},batch:!0}},data:function(){return{file:null,altTextModalOpen:!1,toolbarPosition:"normal"}},computed:{loading:function(){return null==this.file},hasAttachmentNode:function(){return this.context.hasAttachmentNode()},actions:function(){return[this.hasAttachmentNode&&{label:this.$str("display_as_attachment","editor_weka"),action:this.$_toAttachment},{label:this.$str("remove","core"),action:this.$_removeNode},{label:this.$str("download","core"),action:this.$_download}].filter(Boolean)},altText:function(){return this.attrs.alttext},filename:function(){return this.attrs.filename||null},itemId:function(){return this.context.getItemId()},displaySize:function(){return this.attrs.display_size},grow:function(){return null!=this.displaySize},sizeOptions:function(){return[{label:this.$str("size_original","editor_weka"),size:void 0},{label:this.$str("size_large","editor_weka"),size:"large"},{label:this.$str("size_medium","editor_weka"),size:"medium"},{label:this.$str("size_small","editor_weka"),size:"small"}]},sizeActions:function(){var e=this;return this.sizeOptions.map((function(t){return{label:t.label,action:function(){return e.$_setSize(t.size)}}}))},currentSizeName:function(){var e=this;if(null==this.displaySize)return this.$str("size_original","editor_weka");var t=this.sizeOptions.find((function(t){return t.size===e.displaySize}));return t?t.label:null},toolbarDeps:function(){return{position:this.toolbarPosition,selected:this.selected}}},watch:{toolbarDeps:function(e){var t=e.position,n=e.selected;if(this.trackedToolbar){var i="floating"===t;this.trackedToolbar.setCaptured(i),i&&this.trackedToolbar.setVisible(n)}}},mounted:function(){this.resizeObserver=new(s())(this.$_handleInnerResize),this.resizeObserver.observe(this.$refs.inner),this.$_handleInnerResize(),this.trackedToolbar=this.trackInExtras(this.$refs.toolbar,{trackedEl:this.$el,trackedElAnchor:"top-start",positionedElAnchor:"top-start"}),"floating"===this.toolbarPosition&&this.trackedToolbar.captureNode()},beforeDestroy:function(){this.resizeObserver.disconnect(),this.trackedToolbar.destroy()},methods:{$_setSize:function(e){this.context.updateImage(this.getRange,{display_size:e})},$_toAttachment:function(){if(this.context.replaceWithAttachment){var e={filename:this.filename,alttext:this.altText,size:this.file.file_size};this.context.replaceWithAttachment(this.getRange,e)}},editAltText:function(){this.altTextModalOpen=!0},updateAltText:function(e){this.altTextModalOpen=!1,this.context.updateImage(this.getRange,{alttext:e})},$_removeNode:function(){return this.context.removeNode(this.getRange)},$_download:function(){var e=this;return(0,i.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=window,t.next=3,e.context.getDownloadUrl(e.filename);case 3:t.t1=t.sent,t.t0.open.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t)})))()},hideAltTextModal:function(){null===this.altText?this.updateAltText(""):this.altTextModalOpen=!1},focusCaption:function(){var e={filename:this.filename,alttext:this.altText,size:this.file.file_size};this.context.replaceWithFigure(this.getRange,e)},$_handleInnerResize:function(){var e=this.$refs.inner;this.toolbarPosition=e.offsetWidth>=300&&e.offsetHeight>=70?"normal":"floating"}}},x=function(e){e.options.__langStrings={core:["loadinghelp","remove","download"],editor_weka:["actions_menu_for","alt_text","caption","display_as_attachment","image_size_x","image_size","size_large","size_medium","size_original","size_small"]}},N=(0,n("wWJ2").Z)(b,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaImageBlock",class:["tui-wekaImageBlock--toolbarPosition-"+e.toolbarPosition,e.displaySize&&["tui-wekaImageBlock--displaySize","tui-wekaImageBlock--displaySize-"+e.displaySize]],attrs:{contenteditable:"false"}},[n("div",{ref:"inner",staticClass:"tui-wekaImageBlock__inner"},[[n("div",{staticClass:"tui-wekaImageBlock__imageWrap"},[e.loading?n("ComponentLoading"):n("ResponsiveImage",{staticClass:"tui-wekaImageBlock__image",attrs:{src:e.file.url,alt:e.altText,grow:e.grow}})],1),e._v(" "),n("div",{ref:"toolbar",class:["tui-wekaImageBlock__toolbar","tui-wekaImageBlock__toolbar--"+e.toolbarPosition]},[e.editorDisabled?e._e():n("NodeMenu",{attrs:{"context-mode":"uncontained"}},[n("NodeMenuGroup",[n("NodeMenuActionDropdown",{attrs:{position:"bottom-left",actions:e.sizeActions,text:e.currentSizeName||e.$str("image_size","editor_weka"),title:e.$str("image_size","editor_weka"),"aria-label":e.currentSizeName?e.$str("image_size_x","editor_weka",e.currentSizeName):e.$str("image_size","editor_weka")},scopedSlots:e._u([{key:"icon",fn:function(){return[n("ImageIcon")]},proxy:!0}],null,!1,3644944271)})],1),e._v(" "),n("NodeMenuGroup",[n("NodeMenuButton",{attrs:{text:e.$str("alt_text","editor_weka")},on:{click:e.editAltText}})],1),e._v(" "),n("NodeMenuGroup",[n("NodeMenuButton",{attrs:{text:e.$str("caption","editor_weka")},on:{click:e.focusCaption}})],1),e._v(" "),n("NodeMenuGroup",[n("NodeMenuMoreDropdown",{attrs:{actions:e.actions}})],1)],1)],1)]],2),e._v(" "),n("ModalPresenter",{attrs:{open:e.altTextModalOpen},on:{"request-close":e.hideAltTextModal}},[n("EditImageAltTextModal",{attrs:{value:e.altText},on:{change:e.updateAltText}})],1)],1)}),[],!1,null,null,null);x(N),N.options.__hasBlocks={script:!0,template:!0};var I=N.exports},XQm6:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var i=n("AQw4"),r=n.n(i),o=n("hd/h"),a=n.n(o),s=n("5TpV"),u=n.n(s),l=n("KTPV"),c=n.n(l),d=n("Pspb"),p=n.n(d),f=n("PWfy"),m=n.n(f),h=n("TVjX"),v=n.n(h),_=n("nIqm"),k=n("xIDV"),g={components:{LayoutIcon:r(),NodeMenu:_.NodeMenu,NodeMenuActionDropdown:_.NodeMenuActionDropdown,NodeMenuButton:_.NodeMenuButton,NodeMenuGroup:_.NodeMenuGroup,NodeMenuMoreDropdown:_.NodeMenuMoreDropdown},extends:v(),computed:{currentVariant:function(){var e=this,t=this.context.getLayoutBlockDetails(this.node);return this.layoutVariantOptions.find((function(n){return n.columns.length===t.columns.length&&n.columns.every((function(n,i){return e.columnMatches(t.columns[i],n)}))}))},layoutVariantOptions:function(){return[{label:this.$str("layout_one_column","editor_weka"),iconComponent:a(),columns:[{}]},{label:this.$str("layout_two_column","editor_weka"),columns:[{},{}],iconComponent:u()},{label:this.$str("layout_narrow_left_column","editor_weka"),columns:(0,k.isRtl)()?[{},{type:"sidebar"}]:[{type:"sidebar"},{}],iconComponent:c()},{label:this.$str("layout_narrow_right_column","editor_weka"),columns:(0,k.isRtl)()?[{type:"sidebar"},{}]:[{},{type:"sidebar"}],iconComponent:p()},{label:this.$str("layout_three_column","editor_weka"),columns:[{},{},{}],iconComponent:m()}]},layoutVariantActions:function(){var e=this;return this.layoutVariantOptions.map((function(t){return{label:t.label,iconComponent:t.iconComponent,action:function(){return e.updateLayout({columns:t.columns})}}}))},actions:function(){var e=this;return[{label:this.$str("remove","core"),action:function(){return e.deleteLayout()}}]},toolbarVisible:function(){return!this.editorDisabled&&this.cursorInside}},watch:{toolbarVisible:function(e){this.trackedToolbar.setVisible(e)}},mounted:function(){this.trackedToolbar=this.trackInExtras(this.$refs.toolbar,{trackedEl:this.$el,trackedElAnchor:"top-end",positionedElAnchor:"bottom-end"}),this.trackedToolbar.captureNode()},beforeDestroy:function(){this.trackedToolbar.destroy()},methods:{updateLayout:function(e){this.context.updateLayout(this.getRange,e)},deleteLayout:function(){this.context.deleteLayout(this.getRange)},columnMatches:function(e,t){return e.type==t.type}}},y=function(e){e.options.__langStrings={core:["remove"],editor_weka:["layout","layout_narrow_left_column","layout_narrow_right_column","layout_one_column","layout_settings","layout_three_column","layout_two_column","layout_x"]}},w=(0,n("wWJ2").Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"focus-within",rawName:"v-focus-within"}],staticClass:"tui-editor_weka-layoutBlock",class:{"tui-editor_weka-layoutBlock--cursorInside":e.cursorInside}},[n("div",{ref:"toolbar",staticClass:"tui-editor_weka-layoutBlock__toolbarWrap",attrs:{contenteditable:"false"}},[n("div",{directives:[{name:"weka-node-ui",rawName:"v-weka-node-ui"}],staticClass:"tui-editor_weka-layoutBlock__toolbar"},[n("NodeMenu",{attrs:{"context-mode":"contained"}},[n("NodeMenuActionDropdown",{attrs:{position:"bottom-right",actions:e.layoutVariantActions,text:e.currentVariant?e.currentVariant.label:e.$str("layout","editor_weka"),title:e.$str("layout","editor_weka"),"aria-label":e.currentVariant?e.$str("layout_x","editor_weka",e.currentVariant.label):e.$str("layout","editor_weka")},scopedSlots:e._u([{key:"icon",fn:function(){return[e.currentVariant&&e.currentVariant.iconComponent?n(e.currentVariant.iconComponent,{tag:"component"}):n("LayoutIcon")]},proxy:!0}])}),e._v(" "),n("NodeMenuMoreDropdown",{attrs:{actions:e.actions}})],1)],1)]),e._v(" "),n("div",{ref:"content",staticClass:"tui-editor_weka-layoutBlock__content"})])}),[],!1,null,null,null);y(w),w.options.__hasBlocks={script:!0,template:!0};var b=w.exports},"4mdy":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("TVjX"),r={extends:n.n(i)(),computed:{isSidebar:function(){return"sidebar"===this.attrs.type}}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{ref:"content",staticClass:"tui-editor_weka-layoutColumn",class:{"tui-editor_weka-layoutColumn--sidebar":e.isSidebar}})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},OjgZ:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var i=n("TVjX"),r=n.n(i),o=n("1+j7"),a=n.n(o),s=n("3NWB"),u=n.n(s),l=n("DS3U"),c=n.n(l),d=tui.require("tui/components/json_editor/nodes/LinkBlock"),p=n.n(d),f=n("x7h9"),m=n.n(f),h={components:{ButtonIcon:a(),Dropdown:u(),DropdownButton:c(),LinkBlockInner:p(),More:m()},extends:r(),methods:{open:function(){window.open(this.attrs.url)},edit:function(){this.context.editCard(this.getRange)},toLink:function(){var e=this.attrs.url;this.context.replaceWithTextLink(this.getRange,{url:e})},remove:function(){this.$emit("remove")}}},v=function(e){e.options.__langStrings={core:["edit","remove"],editor_weka:["actions_menu_for","display_as_text","go_to_link_label"]}},_=(0,n("wWJ2").Z)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaLinkBlock",attrs:{"data-url":e.attrs.url}},[n("Dropdown",{attrs:{disabled:e.editorDisabled},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,r=t.isOpen;return[n("div",{on:{"!click":function(e){return e.preventDefault(),i.apply(null,arguments)}}},[n("LinkBlockInner",{attrs:{attrs:e.attrs}})],1),e._v(" "),n("div",{staticClass:"tui-wekaLinkBlock__btn-wrapper"},[e.editorDisabled?e._e():n("ButtonIcon",{staticClass:"tui-wekaLinkBlock__btn",attrs:{styleclass:{small:!0,transparent:!0},"aria-expanded":r.toString(),"aria-label":e.$str("actions_menu_for","editor_weka",e.attrs.title||e.attrs.url)},on:{click:i}},[n("More")],1)],1)]}}])},[e._v(" "),n("DropdownButton",{on:{click:e.open}},[e._v("\n      "+e._s(e.$str("go_to_link_label","editor_weka"))+"\n    ")]),e._v(" "),n("DropdownButton",{on:{click:e.edit}},[e._v("\n      "+e._s(e.$str("edit","core"))+"\n    ")]),e._v(" "),n("DropdownButton",{on:{click:e.toLink}},[e._v("\n      "+e._s(e.$str("display_as_text","editor_weka"))+"\n    ")]),e._v(" "),n("DropdownButton",{on:{click:e.remove}},[e._v("\n      "+e._s(e.$str("remove","core"))+"\n    ")])],1)],1)}),[],!1,null,null,null);v(_),_.options.__hasBlocks={script:!0,template:!0};var k=_.exports},dHcr:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var i=n("TVjX"),r=n.n(i),o=n("oFnQ"),a=n.n(o),s=tui.require("tui/components/embeds/ResponsiveEmbedIframe"),u=n.n(s),l=n("jGtd"),c=n.n(l),d=n("/g0d"),p=n.n(d),f={components:{NodeBar:a(),ResponsiveEmbedIframe:u(),ResponsiveImage:c(),Loading:p()},extends:r(),computed:{pluginMatch:function(){return this.context.urlPlugin({type:"media",url:this.attrs.url})||{}},pluginKey:function(){return this.pluginMatch.plugin&&this.pluginMatch.plugin.key},pluginName:function(){return this.pluginMatch.plugin&&this.pluginMatch.plugin.name},details:function(){return this.pluginMatch.details||{}},actions:function(){var e=this;return[{label:this.$str("go_to_link_label","editor_weka"),action:function(){return e.open()}},{label:this.$str("edit","core"),action:function(){return e.edit()}},{label:this.$str("display_as_text","editor_weka"),action:function(){return e.toLink()}},{label:this.$str("remove","core"),action:function(){return e.$emit("remove")}}]},iframeUrl:function(){var e=this.details,t=null;switch(this.pluginKey){case"youtube":t="https://www.youtube.com/embed/"+e.id+"?rel=0";break;case"vimeo":t="https://player.vimeo.com/video/"+e.id+"?portrait=0";break;case"vimeo-private":t="https://player.vimeo.com/video/"+e.id+"?h="+e.privateString+"&portrait=0"}return t},summaryText:function(){return this.pluginName+" - "+(this.attrs.title||this.attrs.url)}},methods:{open:function(){window.open(this.attrs.url)},edit:function(){this.context.editCard(this.getRange)},toLink:function(){var e=this.attrs.url;this.context.replaceWithTextLink(this.getRange,{url:e})}}},m=function(e){e.options.__langStrings={core:["edit","remove","loading"],editor_weka:["actions_menu_for","display_as_text","go_to_link_label"]}},h=(0,n("wWJ2").Z)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaLinkMedia",class:{"tui-wekaLinkMedia--intrinsic-width":!e.attrs.loading&&!e.iframeUrl},attrs:{"data-url":e.attrs.url}},[n("div",{staticClass:"tui-wekaLinkMedia__inner"},[e.attrs.loading?n("div",{staticClass:"tui-wekaLinkMedia__loading"},[n("Loading",{attrs:{alt:e.$str("loading","core")}})],1):e.iframeUrl?n("div",{staticClass:"tui-wekaLinkMedia__embed"},[n("ResponsiveEmbedIframe",{attrs:{src:e.iframeUrl,resolution:e.attrs.resolution,title:e.attrs.title||e.attrs.url}})],1):"audio"==e.pluginKey?n("div",[n("audio",{attrs:{controls:"",src:e.attrs.url}})]):"image"==e.pluginKey?n("div",[n("ResponsiveImage",{attrs:{src:e.attrs.url}})],1):n("div",[n("a",{attrs:{href:e.attrs.url}},[e._v(e._s(e.attrs.url))])]),e._v(" "),e.editorDisabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.summaryText)}})],1)])}),[],!1,null,null,null);m(h),h.options.__hasBlocks={script:!0,template:!0};var v=h.exports},m05q:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var i=n("TVjX"),r=n.n(i),o=tui.require("tui/components/json_editor/nodes/Mention"),a={components:{Mention:n.n(o)()},extends:r(),computed:{displayName:function(){var e=this.attrs;return e.display?e.display:""},userId:function(){var e=this.attrs;return e.id?e.id:0}}},s=(0,n("wWJ2").Z)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"tui-wekaMention"},[n("Mention",{attrs:{"user-id":e.userId,fullname:e.displayName},nativeOn:{click:function(e){e.preventDefault()}}})],1)}),[],!1,null,null,null);s.options.__hasBlocks={script:!0,template:!0};var u=s.exports},"x/f0":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var i=n("37Fk"),r=n("KCiO"),o=n.n(r),a=n("TVjX"),s=n.n(a),u=n("IpiT"),l=n.n(u),c=tui.require("tui/components/json_editor/nodes/VideoBlock"),d=n.n(c),p=n("F8Pd"),f=n("oFnQ"),m=n.n(f),h=n("EJOt"),v=n.n(h),_=n("9lfe"),k=n.n(_),g=n("x7Rm"),y={components:{Button:l(),CoreVideoBlock:d(),NodeBar:m(),ModalPresenter:v(),ExtraFileUploadModal:k()},extends:s(),apollo:{file:{query:p.Z,variables:function(){return{item_id:this.itemId,filename:this.filename}}}},data:function(){return{file:{},showModal:!1}},computed:{hasAttachmentNode:function(){return this.context.hasAttachmentNode()},coreVideoBlockKey:function(){if(!this.attrs.subtitle)return this.attrs.filename;var e=this.attrs,t=e.filename,n=e.subtitle,i=n.filename,r=n.url;return"".concat(t,"-").concat(i,"-").concat(r)},actions:function(){return[this.hasAttachmentNode&&{label:this.$str("display_as_attachment","editor_weka"),action:this.$_toAttachment},{label:this.$str("upload_captions","editor_weka"),action:this.openModal},{label:this.$str("remove","core"),action:this.$_removeNode},{label:this.$str("download","core"),action:this.$_download}].filter(Boolean)},itemId:function(){return this.context.getItemId()},contextId:function(){if(!this.context.getContextId)throw new Error("No function 'getContextId' was found from extension");return this.context.getContextId()},filename:function(){return this.attrs.filename?this.attrs.filename:null},subtitleFilename:function(){return this.attrs.subtitle?this.attrs.subtitle.filename:null},subtitleUrl:function(){return this.attrs.subtitle?this.attrs.subtitle.url:null},subtitleButtonVisible:function(){return!this.editorDisabled&&null===this.attrs.subtitle}},methods:{$_toAttachment:function(){if(this.context.replaceWithAttachment){var e={filename:this.filename,size:this.file.file_size,subtitle:this.attrs.subtitle||null};this.context.replaceWithAttachment(this.getRange,e)}},$_removeNode:function(){this.context.removeNode&&this.context.removeNode(this.getRange)},$_download:function(){var e=this;return(0,i.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=window,t.next=3,e.context.getDownloadUrl(e.filename);case 3:t.t1=t.sent,t.t0.open.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t)})))()},openModal:function(){this.showModal=!0},hideModal:function(){this.showModal=!1},cancel:function(){var e=this;return(0,i.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.subtitleFilename){t.next=5;break}return t.next=3,e.updateSubtitle("");case 3:t.next=6;break;case 5:e.hideModal();case 6:case"end":return t.stop()}}),t)})))()},onSubtitleChange:function(e){var t=this;return(0,i.Z)(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.updateSubtitle(e||"");case 1:case"end":return n.stop()}}),n)})))()},updateSubtitle:function(e){var t=this;return(0,i.Z)(o().mark((function n(){var i,r,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.hideModal(),t.context.updateVideoWithSubtitle){n.next=3;break}return n.abrupt("return");case 3:if(i=Object.assign({},t.attrs),r=null,a=!1,i.subtitle&&(r=i.subtitle.filename),e?(a=r!==e.filename,i.subtitle={filename:e.filename,url:e.url}):i.subtitle=e,t.context.updateVideoWithSubtitle(t.getRange,i),!a){n.next=10;break}return n.next=10,(0,g.notify)({message:t.$str("upload_caption_confirmation","editor_weka"),type:"success"});case 10:case"end":return n.stop()}}),n)})))()}}},w=function(e){e.options.__langStrings={core:["loadinghelp","remove","download"],editor_weka:["display_as_attachment","actions_menu_for","upload_captions","video_alt_help","upload_caption_transcript_button","upload_video_caption","upload_caption_confirmation"]}},b=(0,n("wWJ2").Z)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaVideoBlock"},[e.$apollo.loading?[n("p",[e._v("\n      "+e._s(e.$str("loadinghelp","core"))+"\n    ")])]:[n("div",{staticClass:"tui-wekaVideoBlock__inner"},[n("ModalPresenter",{attrs:{open:e.showModal},on:{"request-close":e.cancel}},[n("ExtraFileUploadModal",{attrs:{"item-id":e.itemId,"context-id":e.contextId,"accepted-file-types":[".vtt"],"modal-title":e.$str("upload_video_caption","editor_weka"),"submit-button-text":e.$str("upload_caption_transcript_button","editor_weka",".vtt"),"modal-help-text":e.$str("video_alt_help","editor_weka"),filename:e.subtitleFilename},on:{change:e.onSubtitleChange}})],1),e._v(" "),n("div",{staticClass:"tui-wekaVideoBlock__positioner"},[e.subtitleButtonVisible?n("Button",{staticClass:"tui-wekaVideoBlock__inner-addCaptionButton",attrs:{text:e.$str("upload_captions","editor_weka")},on:{click:e.openModal}}):e._e(),e._v(" "),n("CoreVideoBlock",{key:e.coreVideoBlockKey,attrs:{"mime-type":e.file.mime_type,url:e.file.url,filename:e.filename,"subtitle-url":e.subtitleUrl}})],1),e._v(" "),e.editorDisabled?e._e():n("NodeBar",{attrs:{actions:e.actions,"aria-label":e.$str("actions_menu_for","editor_weka",e.filename)}})],1)]],2)}),[],!1,null,null,null);w(b),b.options.__hasBlocks={script:!0,template:!0};var x=b.exports},uOwq:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n("3NWB"),r=n.n(i),o=n("6e83"),a=n.n(o),s={components:{Dropdown:r(),DropdownItem:a()},props:{contextId:{type:[Number,String]},component:{type:String},area:{type:String},location:{required:!0,type:Object},pattern:{required:!0,type:String}},data:function(){return{hashtags:[]}},apollo:{hashtags:{query:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"core_find_hashtags"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pattern"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contextid"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"hashtags"},name:{kind:"Name",value:"core_hashtags_by_pattern"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pattern"},value:{kind:"Variable",name:{kind:"Name",value:"pattern"}}},{kind:"Argument",name:{kind:"Name",value:"contextid"},value:{kind:"Variable",name:{kind:"Name",value:"contextid"}}},{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tag"},arguments:[],directives:[]}]}}]}}]},fetchPolicy:"network-only",variables:function(){return{pattern:this.pattern,contextid:this.contextId,component:this.component,area:this.area}}}},computed:{showSuggestions:function(){return this.$apollo.loading||this.hashtags.length>0},positionStyle:function(){return{left:"".concat(this.location.x,"px"),top:"".concat(this.location.y,"px")}}},watch:{showSuggestions:function(e){e||this.$emit("dismiss")}},mounted:function(){var e=this.$refs.customTrigger;e&&e.click()},methods:{pickTag:function(e){var t=e.id,n=e.tag;this.$emit("item-selected",{id:t,text:n})},dismiss:function(){this.open=!1,this.$emit("dismiss")}}},u=function(e){e.options.__langStrings={editor_weka:["matching_hashtags"],core:["loadinghelp"]}},l=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaHashtagSuggestions",style:e.positionStyle},[n("Dropdown",{attrs:{separator:!1,open:e.showSuggestions,"inline-menu":!0},on:{dismiss:e.dismiss},scopedSlots:e._u([{key:"trigger",fn:function(){return[n("span",{staticClass:"sr-only"},[e._v("\n        "+e._s(e.$str("matching_hashtags","editor_weka"))+":\n      ")])]},proxy:!0}])},[e._v(" "),e.$apollo.loading?[n("DropdownItem",{attrs:{disabled:!0}},[e._v("\n        "+e._s(e.$str("loadinghelp","core"))+"\n      ")])]:e._e(),e._v(" "),e._l(e.hashtags,(function(t,i){return n("DropdownItem",{key:i,on:{click:function(n){return e.pickTag(t)}}},[e._v("\n      "+e._s(t.tag)+"\n    ")])}))],2)],1)}),[],!1,null,null,null);u(l),l.options.__hasBlocks={script:!0,template:!0};var c=l.exports},TQrF:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var i=n("3NWB"),r=n.n(i),o=n("6e83"),a=n.n(o),s=tui.require("tui/components/profile/MiniProfileCard"),u=n.n(s),l=tui.require("tui/components/loading/Loader"),c=n.n(l),d={components:{Dropdown:r(),DropdownItem:a(),MiniProfileCard:u(),Loader:c()},props:{contextId:[Number,String],component:String,area:String,instanceId:[Number,String],location:{required:!0,type:Object},pattern:{required:!0,type:String}},apollo:{users:{query:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"editor_weka_find_users_by_pattern"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pattern"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contextid"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"users"},name:{kind:"Name",value:"editor_weka_users_by_pattern"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pattern"},value:{kind:"Variable",name:{kind:"Name",value:"pattern"}}},{kind:"Argument",name:{kind:"Name",value:"contextid"},value:{kind:"Variable",name:{kind:"Name",value:"contextid"}}},{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"card_display"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_picture_alt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_picture_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_fields"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"associate_url"},arguments:[],directives:[]}]}}]}}]}}]}}]},fetchPolicy:"network-only",variables:function(){return{pattern:this.pattern,contextid:this.contextId,component:this.component,area:this.area,instance_id:this.instanceId}}}},data:function(){return{users:[]}},computed:{positionStyle:function(){return{left:"".concat(this.location.x,"px"),top:"".concat(this.location.y,"px")}},mentionOpen:function(){return this.$apollo.loading||this.users.length>0}},methods:{pickUser:function(e){var t=e.id,n=e.fullname;this.$emit("item-selected",{id:t,text:n})}}},p=function(e){e.options.__langStrings={editor_weka:["matching_users"]}},f=(0,n("wWJ2").Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.mentionOpen?n("div",{staticClass:"tui-wekaUserSuggestions",style:e.positionStyle},[n("Dropdown",{attrs:{separator:!0,open:e.mentionOpen,"inline-menu":!0},on:{dismiss:function(t){return e.$emit("dismiss")}}},[n("span",{staticClass:"sr-only"},[e._v("\n      "+e._s(e.$str("matching_users","editor_weka"))+":\n    ")]),e._v(" "),e.$apollo.loading?[n("DropdownItem",{attrs:{disabled:!0}},[n("Loader",{attrs:{loading:!0}})],1)]:e._e(),e._v(" "),e._l(e.users,(function(t,i){return n("DropdownItem",{key:i,attrs:{"no-padding":!0},on:{click:function(n){return e.pickUser(t)}}},[n("MiniProfileCard",{attrs:{"no-border":!0,display:t.card_display}})],1)}))],2)],1):e._e()}),[],!1,null,null,null);p(f),f.options.__hasBlocks={script:!0,template:!0};var m=f.exports},ZaZK:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var i=n("xZv7"),r=n.n(i),o=n("1+j7"),a=n.n(o),s=n("x7h9"),u=n.n(s),l={directives:{"weka-node-ui":n("gFJZ").wekaNodeUI},components:{ActionDropdown:r(),ButtonIcon:a(),More:u()},props:{actions:{type:Array,required:!0},ariaLabel:String}},c=function(e){e.options.__langStrings={editor_weka:["more_items"]}},d=(0,n("wWJ2").Z)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"weka-node-ui",rawName:"v-weka-node-ui"}],staticClass:"tui-wekaNodeBar",attrs:{contenteditable:"false"}},[n("ActionDropdown",{attrs:{position:"bottom-right",actions:e.actions},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,r=t.isOpen;return[n("ButtonIcon",{attrs:{styleclass:{small:!0,transparent:!0},"aria-expanded":r?"true":"false","aria-label":e.ariaLabel?e.ariaLabel:e.$str("more_items","editor_weka"),"data-weka-more":!0},on:{click:i}},[n("More")],1)]}}])})],1)}),[],!1,null,null,null);c(d),d.options.__hasBlocks={script:!0,template:!0};var p=d.exports},ro6s:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var i=tui.require("tui/dom/focus"),r=n("3NWB"),o=n.n(r),a=n("6e83"),s=n.n(a),u=tui.require("tui/components/icons/Show"),l=n.n(u),c=n("IpiT"),d=n.n(c),p=n("1+j7"),f=n.n(p),m=tui.require("editor_weka/components/toolbar/ToolbarButton"),h=n.n(m),v=tui.require("editor_weka/components/toolbar/ToolbarButtonIcon"),_=n.n(v),k=tui.require("tui/components/popover/Popover"),g=n.n(k),y={components:{Dropdown:o(),DropdownItem:s(),ShowIcon:l(),Button:d(),ButtonIcon:f(),ToolbarButton:h(),ToolbarButtonIcon:_(),Popover:g()},props:{items:{type:Array},sticky:Boolean},computed:{activeBlockName:function(){var e=this.blockItems.find((function(e){return e.active}));return e?e.label.toString():"Block"},blockSelectorEnabled:function(){return this.blockItems.some((function(e){return e.enabled}))},blockItems:function(){return this.items.filter((function(e){return"blocks"==e.group}))},itemGroups:function(){var e=this.items.filter((function(e){return"blocks"!=e.group})),t={text:[],embeds:[]};return e.forEach((function(e){t[e.group]||(t[e.group]=[]),t[e.group].push(e)})),t}},methods:{itemClick:function(e){e.enabled&&e.execute&&e.execute()},openChanged:function(e,t){!t&&e.enabled&&e.reset&&e.reset()},handleButtonKeydown:function(e){var t=e.currentTarget;switch(e.key){case"ArrowLeft":case"Left":this.$_moveFocus(t,"prev");break;case"ArrowRight":case"Right":this.$_moveFocus(t,"next");break;case"Home":this.$_moveFocus(t,"first");break;case"End":this.$_moveFocus(t,"last");break;default:return}e.stopPropagation(),e.preventDefault()},handleButtonFocus:function(e){var t=e.currentTarget;this.$_getAllButtons().forEach((function(e){e.tabIndex=e==t?0:-1}))},$_getAllButtons:function(){return Array.prototype.slice.call(this.$el.querySelectorAll(".tui-wekaToolbar__button"))},$_moveFocus:function(e,t){var n=(0,i.getFocusableElements)(this.$el),r=this.$_getAllButtons().filter((function(e){return n.includes(e)})),o=r.length-1,a=0;"prev"==t||"next"==t?-1==(a=r.indexOf(e))?a="next"==t?o:0:(a+="next"==t?1:-1)>o?a=0:a<0&&(a=o):"first"==t?a=0:"last"==t&&(a=o),r[a]&&r[a].focus()}}},w=function(e){e.options.__langStrings={editor_weka:["format_as_blocktype_status","label_toolbar"]}},b=(0,n("wWJ2").Z)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaToolbar",class:{"tui-wekaToolbar--sticky":e.sticky},attrs:{role:"toolbar","aria-label":e.$str("label_toolbar","editor_weka")}},[n("div",{staticClass:"tui-wekaToolbar__group"},[n("Dropdown",{attrs:{separator:!1},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,r=t.isOpen;return[n("ToolbarButton",{staticClass:"tui-wekaToolbar__currentBlock tui-wekaToolbar__button",attrs:{text:e.activeBlockName,"aria-expanded":r?"true":"false","aria-label":e.$str("format_as_blocktype_status","editor_weka",e.activeBlockName),disabled:!e.blockSelectorEnabled,caret:""},on:{click:function(e){return i()}},nativeOn:{keydown:function(t){return e.handleButtonKeydown.apply(null,arguments)},focus:function(t){return e.handleButtonFocus.apply(null,arguments)}}})]}}])},[e._v(" "),e._l(e.blockItems,(function(t,i){return n("DropdownItem",{key:i,attrs:{selected:t.active,disabled:!t.active&&!t.enabled},on:{click:function(n){return e.itemClick(t)}}},[e._v("\n        "+e._s(t.label.toString())+"\n      ")])}))],2)],1),e._v(" "),e._l(e.itemGroups,(function(t,i){return n("div",{key:i,staticClass:"tui-wekaToolbar__group"},[e._l(t,(function(t,i){return[t.children?n("Dropdown",{key:i,attrs:{separator:!1,"context-mode":"uncontained"},scopedSlots:e._u([{key:"trigger",fn:function(i){var r=i.toggle;return[n("ToolbarButtonIcon",{staticClass:"tui-wekaToolbar__button",attrs:{text:t.label.toString(),active:t.active,disabled:!t.enabled,caret:""},on:{click:r},nativeOn:{keydown:function(t){return e.handleButtonKeydown.apply(null,arguments)},focus:function(t){return e.handleButtonFocus.apply(null,arguments)}}},[n("template",{slot:"icon"},[n(t.iconComponent,{tag:"component"})],1)],2)]}}],null,!0)},[e._v(" "),e._l(t.children,(function(t,i){return["separator"===t.type?n("div",{key:i,staticClass:"tui-wekaToolbar__dropdownSeparator"}):"button"===t.type?n("div",{key:i,staticClass:"tui-wekaToolbar__dropdownButtonWrap"},[t.iconComponent?n("ButtonIcon",{key:i,attrs:{text:t.label.toString(),"aria-label":t.label.toString(),disabled:!t.enabled},on:{click:function(n){return e.itemClick(t)}}},[n(t.iconComponent,{tag:"component"})],1):n("Button",{key:i,attrs:{text:t.label.toString(),disabled:!t.enabled},on:{click:function(n){return e.itemClick(t)}}})],1):n("DropdownItem",{key:i,attrs:{disabled:!t.enabled,selected:t.active},on:{click:function(n){return e.itemClick(t)}}},[n("div",{staticClass:"tui-wekaToolbar__dropdownItemContent"},[n(t.iconComponent,{tag:"component",staticClass:"tui-wekaToolbar__dropdownItemIcon"}),e._v(e._s(t.label.toString())+"\n            ")],1)])]}))],2):t.popover?n("Popover",{key:i,attrs:{triggers:["click"],title:t.popover.title,"context-mode":"uncontained"},on:{"open-changed":function(n){for(var i=arguments.length,r=Array(i);i--;)r[i]=arguments[i];return e.openChanged.apply(void 0,[t].concat(r))}},scopedSlots:e._u([{key:"trigger",fn:function(i){var r=i.isOpen;return[n("ToolbarButtonIcon",{staticClass:"tui-wekaToolbar__button",attrs:{text:t.label.toString(),selected:t.active,disabled:!t.enabled,"aria-haspopup":"true","aria-expanded":r?"true":"false"},nativeOn:{keydown:function(t){return e.handleButtonKeydown.apply(null,arguments)},focus:function(t){return e.handleButtonFocus.apply(null,arguments)}}},[n("template",{slot:"icon"},[n(t.iconComponent,{tag:"component"})],1)],2)]}},{key:"default",fn:function(e){var i=e.close;return[n(t.popover.component,{tag:"component",on:{close:i}})]}}],null,!0)}):n("ToolbarButtonIcon",{key:i,staticClass:"tui-wekaToolbar__button",attrs:{text:t.label.toString(),selected:t.active,disabled:!t.enabled},on:{click:function(n){return e.itemClick(t)}},nativeOn:{keydown:function(t){return e.handleButtonKeydown.apply(null,arguments)},focus:function(t){return e.handleButtonFocus.apply(null,arguments)}}},[n("template",{slot:"icon"},[n(t.iconComponent,{tag:"component"})],1)],2)]}))],2)}))],2)}),[],!1,null,null,null);w(b),b.options.__hasBlocks={script:!0,template:!0};var x=b.exports},CRnz:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("IpiT"),r={components:{Button:n.n(i)()},props:{text:{type:String,required:!0},selected:{type:Boolean,default:null},caret:Boolean,disabled:Boolean},computed:{ariaPressed:function(){return null==this.selected?null:this.selected?"true":"false"}}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("Button",{staticClass:"tui-wekaToolbarButton",class:{"tui-wekaToolbarButton--selected":e.selected},attrs:{"aria-label":e.text,"aria-pressed":e.ariaPressed,text:e.text,caret:e.caret,disabled:e.disabled},on:{click:function(t){return e.$emit("click",t)}}})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},tIib:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("1+j7"),r={components:{ButtonIcon:n.n(i)()},props:{text:{type:String,required:!0},selected:{type:Boolean,default:null},iconOnly:Boolean,disabled:Boolean,caret:{type:Boolean,default:!1}},computed:{ariaPressed:function(){return null!=this.selected&&(this.selected?"true":"false")}}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("ButtonIcon",{staticClass:"tui-wekaToolbarButtonIcon",class:{"tui-wekaToolbarButtonIcon--selected":e.selected,"tui-wekaToolbarButtonIcon--iconOnly":e.iconOnly},attrs:{"aria-label":e.text,"aria-pressed":e.ariaPressed,title:e.text,disabled:e.disabled,caret:e.caret},on:{click:function(t){return e.$emit("click",t)}}},[e._t("icon")],2)}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},"16vE":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var i=n("37Fk"),r=n("KCiO"),o=n.n(r),a=n("ApK1"),s=n.n(a),u=n("IACo"),l=n.n(u),c=n("GLpC"),d=n.n(c),p=n("eHBv"),f=n.n(p),m=n("IpiT"),h=n.n(m),v=n("ddQy"),_=n.n(v),k=tui.require("tui/components/form/FieldError"),g=n.n(k),y=tui.require("tui/components/form/Upload"),w=n.n(y),b=tui.require("tui/components/icons/files/compute/FileIcon"),x=n.n(b),N=tui.require("tui/components/buttons/InfoIconButton"),I=n.n(N),S=tui.require("tui/components/icons/Clear"),O=n.n(S),A=n("1+j7"),E=n.n(A),C=n("/g0d"),T=n.n(C),D=tui.require("editor_weka/api"),M=n("OWv5"),B=n("F8Pd"),$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_core_delete_draft_file"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draftid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filename"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"totara_core_delete_draft_file"},arguments:[{kind:"Argument",name:{kind:"Name",value:"draftid"},value:{kind:"Variable",name:{kind:"Name",value:"draftid"}}},{kind:"Argument",name:{kind:"Name",value:"filename"},value:{kind:"Variable",name:{kind:"Name",value:"filename"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},F={components:{Modal:l(),ModalContent:d(),Form:s(),ButtonGroup:f(),Button:h(),ButtonCancel:_(),FieldError:g(),Upload:w(),FileIcon:x(),InfoIconButton:I(),DeleteIcon:O(),ButtonIcon:E(),Loading:T()},props:{itemId:{type:Number,required:!0},contextId:{type:Number,required:!0},acceptedFileTypes:{type:Array,required:!0},filename:String,modalHelpText:{type:String,required:!0},modalTitle:{type:String,required:!0},modalTitleHelpText:String,submitButtonText:{type:String,required:!0}},data:function(){return{repositoryData:null,uploadError:"",uploadedFile:null,uploading:!1}},apollo:{uploadedFile:{query:B.Z,variables:function(){return{item_id:this.itemId,filename:this.filename}},skip:function(){return!this.filename},update:function(e){return e.file}},repositoryData:{query:M.Z,variables:function(){return{context_id:this.contextId}},update:function(e){var t=e.repository_data;return{repositoryId:t.repository_id,url:t.url}}}},methods:{confirm:function(){this.$emit("change",this.uploadedFile)},deleteFile:function(){var e=this;return(0,i.Z)(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.uploadedFile){t.next=2;break}return t.abrupt("return");case 2:return n=e.uploadedFile.filename,t.next=5,e.$apollo.mutate({mutation:$,variables:{draftid:e.itemId,filename:n}});case 5:t.sent.data.result.success&&(e.uploadedFile=null);case 8:case"end":return t.stop()}}),t)})))()},handleFileLoaded:function(e){var t=this,n=e.file.name;return(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.uploadError="",e.next=3,(0,D.getDraftFile)({itemId:t.itemId,filename:n});case 3:t.uploadedFile=e.sent;case 4:case"end":return e.stop()}}),e)})))()},handleError:function(){this.uploadError=this.$str("meta_upload_generic_error","editor_weka"),this.uploading=!1}}},j=function(e){e.options.__langStrings={totara_core:["filewithname","delete"],editor:["transcript"],editor_weka:["done","meta_upload_generic_error"]}},R=(0,n("wWJ2").Z)(F,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.repositoryData?n("Modal",{staticClass:"tui-captionUploadModal"},[n("ModalContent",{staticClass:"tui-captionUploadModal__content"},[n("template",{slot:"title"},[n("div",{staticClass:"tui-captionUploadModal__title"},[e._v("\n        "+e._s(e.modalTitle)+"\n        "),e.modalTitleHelpText?n("InfoIconButton",{attrs:{"is-help-for":e.$str("transcript","editor")}},[e._v("\n          "+e._s(e.modalTitleHelpText)+"\n        ")]):e._e()],1)]),e._v(" "),n("Form",{on:{submit:function(t){return t.preventDefault(),e.confirm.apply(null,arguments)}}},[e.uploadedFile?n("div",{staticClass:"tui-captionUploadModal__file"},[n("div",{staticClass:"tui-captionUploadModal__fileContent"},[n("FileIcon",{attrs:{filename:e.uploadedFile.filename,title:e.$str("filewithname","totara_core",e.uploadedFile.filename)}}),e._v("\n          "+e._s(e.uploadedFile.filename)+"\n        ")],1),e._v(" "),n("ButtonIcon",{attrs:{"aria-label":e.$str("delete","totara_core"),styleclass:{transparentNoPadding:!0}},on:{click:e.deleteFile}},[n("DeleteIcon")],1)],1):[n("Upload",{staticClass:"tui-captionUploadModal__upload",attrs:{"repository-id":e.repositoryData.repositoryId,"item-id":e.itemId,href:e.repositoryData.url,"accepted-types":e.acceptedFileTypes,overwrite:!0,"one-file":!0,"context-id":e.contextId},on:{load:e.handleFileLoaded,"upload-finished":function(t){e.uploading=!1},progress:function(t){e.uploading=!0},error:e.handleError},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.selectEvents,r=t.inputEvents;return n("div",{},[n("input",e._g({directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"inputFile",attrs:{accept:e.acceptedFileTypes,type:"file"}},r)),e._v(" "),e.uploading?n("ButtonIcon",{attrs:{"aria-label":e.submitButtonText,text:e.submitButtonText,disabled:!0}},[n("Loading")],1):n("Button",e._g({attrs:{"aria-label":e.submitButtonText,text:e.submitButtonText}},i))],1)}}],null,!1,4060194065)}),e._v(" "),e.uploadError?n("FieldError",{staticClass:"tui-captionUploadModal__errorHandler",attrs:{error:e.uploadError}}):e._e()],e._v(" "),n("p",{staticClass:"tui-captionUploadModal__helpText"},[e._v("\n        "+e._s(e.modalHelpText)+"\n      ")]),e._v(" "),n("ButtonGroup",{staticClass:"tui-captionUploadModal__buttonGroup"},[n("Button",{attrs:{styleclass:{primary:"true"},text:e.$str("done","editor_weka")},on:{click:e.confirm}}),e._v(" "),n("ButtonCancel",{on:{click:function(t){return t.preventDefault(),e.$emit("request-close")}}})],1)],2)],2)],1):e._e()}),[],!1,null,null,null);j(R),R.options.__hasBlocks={script:!0,template:!0};var P=R.exports},"+hvo":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var i={props:{autoTrigger:{type:Boolean,default:!1},maxFiles:{type:[String,Number]}},computed:{multiple:function(){return 1!=this.maxFiles}},mounted:function(){this.autoTrigger&&(this.$_click(),this.$window.document.addEventListener("keyup",this.$_dismiss))},beforeDestroy:function(){this.$window.document.removeEventListener("keyup",this.$_dismiss)},methods:{$_pickFile:function(e){var t=[];e&&e.target&&e.target.files&&(t=e.target.files),this.$emit("picked-files",t),this.$emit("dismiss")},$_click:function(){this.$refs.fileInput&&this.$refs.fileInput.click()},$_dismiss:function(e){e&&"Escape"===e.key&&this.$emit("dismiss")}}},r=(0,n("wWJ2").Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"fileInput",attrs:{type:"file",multiple:e.multiple},on:{change:e.$_pickFile}})])}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};var o=r.exports},IQwa:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var i=tui.require("tui/components/errors/ErrorPageRender"),r=n.n(i),o=n("pwZ9"),a=n("xIDV"),s={components:{ErrorPageRender:r()},props:{params:Object},data:function(){return{errorMessage:null,error:null}},created:function(){var e=this;try{(0,o.setupTextarea)(this.params)}catch(n){var t;t="TEXTAREA_NOT_FOUND"===n.code?(0,a.langString)("error_textarea_not_found","editor_weka"):(0,a.langString)("error_failed_to_initialise","editor_weka"),(0,a.loadLangStrings)([t]).then((function(){e.errorMessage=t.toString(),e.error=n}))}}},u=(0,n("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.errorMessage?n("ErrorPageRender",{attrs:{message:e.errorMessage,error:e.error}}):e._e()}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};var l=u.exports},HL2A:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var i=n("x4c5"),r={components:{Weka:n.n(i)()},props:{contextId:[Number,String]}},o=(0,n("wWJ2").Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-fixture-wekaBasic"},[n("Weka",{attrs:{"usage-identifier":{component:"editor_weka",area:"behat"},variant:"standard","extra-extensions":["mention","hashtag"],"context-id":e.contextId}})],1)}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};var a=o.exports},"5h37":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var i=n("ApK1"),r=n.n(i),o=n("2XTD"),a=n.n(o),s=n("x4c5"),u=n.n(s),l=tui.require("editor_weka/WekaValue"),c=n.n(l),d=n("eHBv"),p=n.n(d),f=n("IgBQ"),m=n.n(f),h=tui.require("tui/components/buttons/Submit"),v=n.n(h),_=n("IpiT"),k=n.n(_),g={components:{Form:r(),FormRow:a(),Weka:u(),ButtonGroup:p(),InputText:m(),Submit:v(),Button:k()},props:{defaultDoc:{type:String,default:""},instanceId:[String,Number],sesskey:{type:String,required:!0}},data:function(){return{content:null,itemId:this.instanceId}},computed:{documentValue:function(){return this.content?JSON.stringify(this.content.getDoc()):""},jsonPretty:function(){return this.content?JSON.stringify(this.content.getDoc(),void 0,2):""}},watch:{defaultDoc:{immediate:!0,handler:function(e){e&&(this.content=c().fromDoc(JSON.parse(e)))}},content:function(e){e&&(this.itemId=e.fileStorageItemId)}}},y=function(e){e.options.__langStrings={editor_weka:["pluginname"],core:["cancel"]}},w=(0,n("wWJ2").Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaWithLearn"},[n("h3",{staticClass:"tui-wekaWithLearn__title"},[e._v("\n    "+e._s(e.$str("pluginname","editor_weka"))+"\n  ")]),e._v(" "),n("Form",{staticClass:"tui-wekaWithLearn__form",attrs:{method:"POST",action:e.$url("/lib/editor/weka/tests/fixtures/weka_with_learn.php",{sesskey:e.sesskey}),"input-width":"full",vertical:!0}},[n("FormRow",{staticClass:"tui-wekaWithLearn__formRow",attrs:{label:e.$str("pluginname","editor_weka")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("Weka",{attrs:{id:i,"usage-identifier":{component:"editor_weka",area:"learn"},variant:"full","instance-id":e.instanceId,"file-item-id":e.instanceId},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})]}}])}),e._v(" "),n("FormRow",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"tui-wekaWithLearn__formRow",attrs:{hidden:!0},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("InputText",{attrs:{id:i,name:"json_content",value:e.documentValue,hidden:!0}})]}}])}),e._v(" "),n("FormRow",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"tui-wekaWithLearn__formRow",attrs:{hidden:!0},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.id;return[n("InputText",{attrs:{id:i,name:"item_id",value:e.itemId,hidden:!0}})]}}])}),e._v(" "),n("ButtonGroup",{staticClass:"tui-wekaWithLearn__buttonGroup"},[n("Submit"),e._v(" "),n("Button",{attrs:{type:"submit",name:"cancel",value:"1",text:e.$str("cancel","core")}})],1)],1),e._v(" "),n("hr"),e._v(" "),n("pre",{staticClass:"tui-wekaWithLearn__code"},[e._v(e._s(e.jsonPretty))])],1)}),[],!1,null,null,null);y(w),w.options.__hasBlocks={script:!0,template:!0};var b=w.exports},gFJZ:function(e,t,n){"use strict";function i(e){e.wekaIgnore=!0}n.r(t),n.d(t,{wekaNodeUI:function(){return r}});var r={bind:function(e){e.addEventListener("keydown",i),e.addEventListener("keypress",i),e.addEventListener("keyup",i),e.addEventListener("mousedown",i),e.addEventListener("mouseup",i),e.addEventListener("click",i)},unbind:function(e){e.removeEventListener("keydown",i),e.removeEventListener("keypress",i),e.removeEventListener("keyup",i),e.removeEventListener("mousedown",i),e.removeEventListener("mouseup",i),e.removeEventListener("click",i)}}},x5EO:function(e,t,n){"use strict";n.r(t),n.d(t,{NodeMenu:function(){return r()},NodeMenuActionDropdown:function(){return a()},NodeMenuButton:function(){return u()},NodeMenuGroup:function(){return c()},NodeMenuMoreDropdown:function(){return p()}});var i=tui.require("editor_weka/components/node_menu/NodeMenu"),r=n.n(i),o=n("lhYX"),a=n.n(o),s=n("oXL3"),u=n.n(s),l=tui.require("editor_weka/components/node_menu/NodeMenuGroup"),c=n.n(l),d=tui.require("editor_weka/components/node_menu/NodeMenuMoreDropdown"),p=n.n(d)},e4D7:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n("5EKS"),r=n("rRkQ"),o=n("IkkI"),a=n("Aely"),s=n.n(a),u=n("bIqi"),l={selectedNode:"ProseMirror-selectednode"},c=function(){function e(t,n){var i=n.editor,o=n.node,a=n.view,s=n.getPos,u=n.parent,l=n.context;(0,r.Z)(this,e),this.component=t,this.editor=i,this.node=o,this.view=a,this.parent=u,this.context=l,this.isNode=!!this.node.marks,this.isMark=!this.isNode,this.getPos=this.isNode?s:null,this.selected=!1,this.cursorInside=!1,this.activeClasses={},this.createVue(),this.dom=this.vm.$el,this.contentDOM=this.vm.$refs.content}return(0,o.Z)(e,[{key:"createVue",value:function(){var e=this,t=s().extend(this.component),n={nodeInfo:this.getNodeInfo(),contextInfo:this.getContextInfo(),updateAttrs:function(t){return e.updateAttrs(t)},replaceWith:function(t){return e.replaceWith(t)},getPos:this.getPos,getRange:this.getRange.bind(this),editorDisabled:!this.view.editable,selected:this.selected,cursorInside:this.cursorInside};this.vm=new t({parent:this.parent,propsData:n}).$mount(),this.vm.$on("updated",this.applyClasses.bind(this)),this.vm.$on("remove",this.remove.bind(this))}},{key:"getNodeInfo",value:function(){var e={node:this.node,editor:this.editor};return Object.preventExtensions(e),e}},{key:"getContextInfo",value:function(){var e={context:this.context};return Object.preventExtensions(e),e}},{key:"update",value:function(e,t){return e.type===this.node.type&&(e===this.node&&this.decorations===t||(this.node=e,this.updateComponentProps({nodeInfo:this.getNodeInfo(),editorDisabled:!this.view.editable})),!0)}},{key:"updateComponentProps",value:function(e){var t=this;if(this.vm._props){var n=s().config.silent;s().config.silent=!0,Object.entries(e).forEach((function(e){var n=(0,i.Z)(e,2),r=n[0],o=n[1];t.vm._props[r]=o})),s().config.silent=n}}},{key:"updateAttrs",value:function(e){if(this.view.editable){var t=this.view.state,n=this.node.type,i=this.getPos(),r=Object.assign({},this.node.attrs,e),o=this.isMark?t.tr.removeMark(i.from,i.to,n).addMark(i.from,i.to,n.create(r)):t.tr.setNodeMarkup(i,null,r);this.view.dispatch(o)}}},{key:"replaceWith",value:function(e){var t=e(this.view.state.schema);if(void 0!==t){var n=this.getRange(),i=this.view.state.tr.replaceWith(n.from,n.to,t);this.view.dispatch(i)}}},{key:"remove",value:function(){var e=this.view.state.tr,t=this.getRange(),n=e.delete(t.from,t.to);this.view.dispatch(n)}},{key:"getSize",value:function(){return this.node.nodeSize}},{key:"getRange",value:function(){if(this.isNode){var e=this.getPos();return{from:e,to:e+this.getSize()}}if(this.isMark){var t=this.view.posAtDOM(this.dom),n=this.view.state.doc.resolve(t);return(0,u.getMarkRange)(n,this.node.type)}}},{key:"destroy",value:function(){this.vm.$destroy()}},{key:"ignoreMutation",value:function(e){return!this.contentDOM&&"selection"!==e.type||!(!this.node.isLeaf&&!this.node.isAtom)||"selection"!==e.type&&(!(!this.contentDOM||"selection"===e.type||this.contentDOM.contains(e.target))||(this.dom===e.target||this.contentDOM===e.target)&&"attributes"===e.type)}},{key:"selectNode",value:function(){this.updateSelection(!0)}},{key:"deselectNode",value:function(){this.updateSelection(!1)}},{key:"setCursorInside",value:function(e){this.cursorInside=e,this.updateComponentProps({cursorInside:e})}},{key:"updateSelection",value:function(e){this.selected=e,this.setClassEnabled("selectedNode",e),!this.contentDOM&&this.node.type.spec.draggable||(e?this.dom.draggable=!0:this.dom.removeAttribute("draggable")),this.updateComponentProps({selected:e})}},{key:"setClassEnabled",value:function(e,t){this.activeClasses[e]=t;var n=l[e];t?this.dom.classList.add(n):this.dom.classList.remove(n)}},{key:"applyClasses",value:function(){var e=this;Object.entries(l).forEach((function(t){var n=(0,i.Z)(t,2),r=n[0],o=n[1];e.activeClasses[r]?e.dom.classList.add(o):e.dom.classList.remove(o)}))}},{key:"stopEvent",value:function(e){return!!e.wekaIgnore}}]),e}()},i77D:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var i=n("5EKS"),r=n("cXde"),o=n("rRkQ"),a=n("IkkI"),s=n("Xz/0"),u=n("QxjF"),l=tui.require("ext_prosemirror/keymap"),c=n("sqie"),d=n("wQtR"),p=tui.require("ext_prosemirror/dropcursor"),f=tui.require("ext_prosemirror/gapcursor"),m=n("R3Ws"),h=n("51FK"),v=n("aTpb"),_=n("+89I"),k=n("e4D7"),g=(n("1ahB"),n("W3oP")),y=n("y7sX"),w=n("U0bO"),b=n("x7Rm"),x=n("xIDV"),N=n("X/Xy"),I=n("EUlj");function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.Z)(this,e),this.uid=(0,w.uniqueId)(),this._options=n,this._parent=n.parent,this.viewExtrasEl=n.viewExtrasEl||null,this.viewExtrasLiveEl=n.viewExtrasLiveEl||null,this._editable=!("editable"in n)||n.editable,this.destroyed=!1,this.view=null,this.state=null,this._extensions=n.extensions||[],this.fileStorage=n.fileStorage,this._extensions.forEach((function(e){return e.setEditor(t)}));var i={};this._nodeViews={};var r={};this._markViews={},this._allVueComponents=[],this._extensions.forEach((function(e){t._extractExtensionSchema(e,"node","nodes",i,t._nodeViews),t._extractExtensionSchema(e,"mark","marks",r,t._nodeViews)})),this.schema=(0,_.createSchema)({nodes:i,marks:r}),this._plugins=[],this._extensions.forEach((function(e){var n=e.plugins();n&&n.forEach((function(e){return t._plugins.push(e)}))})),this._toolbarItemInstances=this._extensions.reduce((function(e,t){return t.toolbarItems?e.concat(t.toolbarItems()):e}),[]),this._toolbarItems=this._toolbarItemInstances.map((function(e){return e.getDef()})),this._mapKeys=this._extensions.map((function(e){return e.keymap&&e.keymap.bind(e)})).filter(Boolean),this._inputRules=this._extensions.reduce((function(e,t){return t.inputRules?e.concat(t.inputRules()):e}),[]),this.dispatch=this.dispatch.bind(this),this.execute=this.execute.bind(this),this.getFileStorageItemId=this.getFileStorageItemId.bind(this),this.setValue(n.value||y.default.empty())}return(0,a.Z)(e,[{key:"updateFileItemId",value:function(e){this.fileStorage.updateFileItemId(e)}},{key:"_extractExtensionSchema",value:function(e,t,n,i,r){var o=this,a=e[n]&&e[n]();if(a){var s=function(e){var n=a[e];i[e]&&console.warn("[editor_weka] ".concat(t,' "').concat(e,'" was redefined')),i[e]=n.schema,n.component&&(o._allVueComponents.push(n.component),r[e]=o._componentNodeView.bind(o,n.component,n.componentContext)),n.view&&(r[e]=n.view)};for(var u in a)s(u)}}},{key:"setValue",value:function(e){if(!e.inflated(this))if(e.hasHtml()){var t=document.createElement("div");t.innerHTML=e.getHtml();var n=s.EditorState.create(O(O({},this._editorConfig()),{},{doc:h.DOMParser.fromSchema(this.schema).parse(t)}));e.inflate(this,n)}else{var i=s.EditorState.create(O(O({},this._editorConfig()),{},{doc:this._docFromJson(this.schema,e.getDoc(!1))}));e.inflate(this,i)}this._value=e,this.state=e.getState(this),this.view&&this.view.updateState(this.state)}},{key:"_docFromJson",value:function(e,t){return t?(t=JSON.parse(JSON.stringify(t)),this._execSerializedVisitors(t,"load"),this._rewriteUnknownNodes(e,t),h.Node.fromJSON(e,t)):null}},{key:"_rewriteUnknownNodes",value:function(e,t){var n=this;(0,N.X)(t,{any:function(t){var i=t.content;if(i)for(var r=0;r<i.length;r++){var o=i[r];if(!e.nodes[o.type]){var a=e.nodes[t.type]&&e.nodes[t.type].spec.content,s=null;"doc"===t.type||/^block[+*]?$/.test(a)?s="unknown_block":/^inline[+*]?$/.test(a)&&(s="unknown_inline"),s?(o.attrs={type:o.type,attrs:o.attrs,content:o.content},o.type=s,delete o.content):(i.splice(r,1),r--,o=null)}o&&n._rewriteUnknownNodeMarks(e,o,t)}}})}},{key:"_rewriteUnknownNodeMarks",value:function(e,t,n){var i=t.marks;if(i)for(var r=0;r<i.length;r++){var o=i[r];if(!e.marks[o.type]){var a=e.nodes["text"===t.type?n.type:t.type],s=a&&a.spec.marks;"_"===s||null==s&&a.inlineContent?(o.attrs={type:o.type,attrs:o.attrs},o.type="unknown"):(i.splice(r,1),r--)}}}},{key:"_editorConfig",value:function(){return{schema:this.schema,plugins:this._createPlugins()}}},{key:"setElements",value:function(e){var t=e.viewExtras,n=e.viewExtrasLive;this.viewExtrasEl=t,this.viewExtrasLiveEl=n}},{key:"createView",value:function(e){var t=this,n=this._options,r={class:"tui-weka-editor",role:"textbox","aria-multiline":"true","aria-labelledby":n.ariaLabelledby,"aria-label":n.ariaLabel,"aria-describedby":n.ariaDescribedby,"aria-invalid":n.ariaInvalid};return r["aria-label"]||r["aria-labelledby"]||(r["aria-label"]=n.placeholder||(0,x.langString)("pluginname","editor_weka")),this.view=new u.EditorView(e,{state:this.state,dispatchTransaction:this.dispatch,nodeViews:this._nodeViews,attributes:Object.entries(r).reduce((function(e,t){var n=(0,i.Z)(t,2),r=n[0],o=n[1];return null!=o&&(e[r]=o),e}),{}),editable:function(){return(0,w.result)(t._editable)}}),this.view.dom.addEventListener("focus",(function(e){t._options.onFocus&&t._options.onFocus(e)})),this.view.dom.addEventListener("blur",(function(e){t._options.onBlur&&t._options.onBlur(e)})),this.view}},{key:"allVueComponents",value:function(){return this._allVueComponents}},{key:"allStrings",value:function(){var e=[];return this._toolbarItems.forEach((function t(n){n.children&&n.children.forEach(t),n.label&&e.push(n.label)})),e.concat([(0,x.langString)("pluginname","editor_weka")])}},{key:"getParent",value:function(){return this._parent}},{key:"_componentNodeView",value:function(e,t,n,i,r){return new k.default(e,{editor:this,node:n,view:i,getPos:r,parent:this._parent,context:t})}},{key:"dispatch",value:function(e){var t=this.state.apply(e);this.view&&!this.destroyed&&this.view.updateState(t),this.state=t,this._value=y.default.fromState(t,this),this._options.onTransaction&&this._options.onTransaction({value:this._value,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this._options.onUpdate&&this._options.onUpdate(this._value)}},{key:"forceRerenderView",value:function(){if(this.view){var e=s.EditorState.create(Object.assign({},this._editorConfig()));this.view.updateState(e),this.view.updateState(this.state)}}},{key:"getFileStorageItemId",value:function(){return this.fileStorage.getFileStorageItemId()}},{key:"_createPlugins",value:function(){var e=[];return Array.isArray(this._plugins)&&(e=this._plugins),e.concat((0,I.default)(),(0,g.default)(this._options.placeholder),(0,m.inputRules)({rules:this._inputRules}),(0,l.keymap)((0,v.buildKeymap)(this.schema,this._mapKeys)),(0,l.keymap)(d.baseKeymap),(0,p.dropCursor)(),(0,f.gapCursor)(),(0,c.history)())}},{key:"getToolbarItems",value:function(){var e=this;return this._toolbarItemInstances.map((function(t){return t.update(e)})),this._toolbarItems}},{key:"execute",value:function(e){try{return e(this.state,this.dispatch,this.view)}catch(e){console.error("[Weka] Failed to execute command."),console.error(e);var t=(0,x.langString)("error_failed_to_execute","editor_weka");return(0,x.loadLangStrings)([t]).then((function(){return(0,b.notify)({type:"error",message:t.toString()})})),!1}}},{key:"canExecute",value:function(e){return e(this.state,null,null)}},{key:"hasNode",value:function(e){return e in this.state.schema.nodes}},{key:"destroy",value:function(){this.view&&this.view.destroy(),this.destroyed=!0}},{key:"identifier",get:function(){return{contextId:this._options.contextId||null,component:this._options.component||null,area:this._options.area||null,instanceId:this._options.instanceId||null}}},{key:"extensionFormatters",get:function(){return this._extensions.map((function(e){return e.applyFormatters.bind(e)}))}},{key:"setEditable",value:function(e){var t=this;this._editable=e,this.view&&this.view.setProps({editable:function(){return(0,w.result)(t._editable)}})}},{key:"getEditable",value:function(){return this._editable}},{key:"_execSerializedVisitors",value:function(e,t){var n=[];this._extensions.forEach((function(e){var i=t+"SerializedVisitor";e[i]&&n.push(e[i]())})),n.length>0&&n.forEach((function(t){return(0,N.X)(e,t)}))}}]),e}()},y7sX:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var i=n("rRkQ"),r=n("IkkI"),o=(n("Xz/0"),n("G6bi")),a=n("X/Xy"),s=function(){function e(){(0,i.Z)(this,e),this._editor=null,this._state=null,this._doc=null,this._html=null,this._map=null,Object.preventExtensions(this)}return(0,r.Z)(e,[{key:"inflated",value:function(e){return this._editor==e||this._map&&!!this._map[e.uid]}},{key:"inflate",value:function(e,t){this._editor?(this._map||(this._map={}),this._map[e.uid]=t):(this._editor=e,this._state=t)}},{key:"getState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this._editor===e?this._state:this._map&&this._map[e.uid]?this._map[e.uid]:null:this._state}},{key:"toJSON",value:function(){return this.getDoc(!0)}},{key:"getDoc",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e&&(this.applyFormatters(),this._doc=null),this._doc||(this._doc=JSON.parse(JSON.stringify(this._state.toJSON().doc)),this._reverseUnknownTransform(this._doc),this._doc&&this._editor&&this._editor._execSerializedVisitors(this._doc,"save")),this._doc}},{key:"_reverseUnknownTransform",value:function(){(0,a.X)(this._doc,{any:function(e){"unknown_block"!==e.type&&"unknown_inline"!==e.type||(e.type=e.attrs.type,e.content=e.attrs.content,e.attrs=e.attrs.attrs),Array.isArray(e.marks)&&e.marks.forEach((function(e){"unknown"===e.type&&(e.type=e.attrs.type,e.attrs=e.attrs.attrs)}))}})}},{key:"applyFormatters",value:function(){var e=this;this._editor&&this._state&&this._editor.extensionFormatters.forEach((function(t){e._state=t(e._state)}))}},{key:"hasHtml",value:function(){return!!this._html}},{key:"getHtml",value:function(){return this._html}},{key:"__isEmpty",value:function(){return this.isEmpty}},{key:"isEmpty",get:function(){if(this._state){var e=this._state.doc;return 0===e.childCount||1===e.childCount&&Boolean(e.firstChild.isTextblock)&&0===e.firstChild.content.size}if(this._doc){if(0===u(this._doc))return!0;if(1===u(this._doc)){var t=this._doc.content[0];return"paragraph"==t.type&&0===u(t)}return!1}return!0}},{key:"fileStorageItemId",get:function(){return this._editor?this._editor.getFileStorageItemId():null}}],[{key:"fromState",value:function(t,n){var i=new e;return i._editor=n,i._state=t,i}},{key:"fromDoc",value:function(t){var n=new e;return n._doc=t,n}},{key:"fromHtml",value:function(t){var n=new e;return n._html=t,n}},{key:"empty",value:function(){return e.fromDoc((0,o.getDefaultDocument)())}}]),e}();function u(e){return e&&e.content?e.content.length:0}},Vulv:function(e,t,n){"use strict";n.r(t),n.d(t,{getDraftFile:function(){return g},getLinkMetadata:function(){return d},getMediaType:function(){return _},getRepositoryData:function(){return f},prepareDraftFileArea:function(){return h}});var i=n("37Fk"),r=n("KCiO"),o=n.n(r),a=tui.require("tui/apollo_client"),s=n.n(a),u=n("OWv5"),l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"core_get_linkmetadata"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_url"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"link"},name:{kind:"Name",value:"core_get_linkmetadata"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"videoheight"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"videowidth"},arguments:[],directives:[]}]}}]}}]},c=n("F8Pd");function d(e){return p.apply(this,arguments)}function p(){return(p=(0,i.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s().query({query:l,variables:{url:t}});case 2:return n=e.sent,e.abrupt("return",n.data.link);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=(0,i.Z)(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s().query({query:u.Z,variables:{context_id:t},fetchPolicy:"no-cache"});case 2:return n=e.sent,i=n.data.repository_data,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return v.apply(this,arguments)}function v(){return v=(0,i.Z)(o().mark((function e(){var t,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:null,console.warn("[editor_weka] The function prepareDraftFileArea had been deprecated, ","please use getRepositoryData instead"),e.abrupt("return",f(t));case 3:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function _(e){return k.apply(this,arguments)}function k(){return(k=(0,i.Z)(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.itemId,i=t.filename,console.warn("[editor_weka] getMediaType had been deprecated, please use getDraftFile instead"),e.next=4,g({itemId:n,filename:i});case 4:return r=e.sent,a=r.media_type,s=r.mime_type,e.abrupt("return",{mediaType:a,mimeType:s});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=(0,i.Z)(o().mark((function e(t){var n,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.itemId,i=t.filename,e.next=3,s().query({query:c.Z,variables:{item_id:n,filename:i},batch:!0});case 3:return r=e.sent,a=r.data.file,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},keTO:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var i=n("37Fk"),r=n("rRkQ"),o=n("IkkI"),a=n("KCiO"),s=n.n(a),u=n("Aely"),l=n.n(u),c=n("7mX8"),d=n.n(c),p=n("EJOt"),f=n.n(p),m=tui.require("editor_weka/components/editing/PositionedActionDropdown"),h=n.n(m),v=(n("51FK"),n("i77D"),n("xIDV")),_=n("yQz/"),k=n.n(_),g=function(e){var t=k()("sleep");return new Promise((function(n){return setTimeout((function(){t(),n()}),e)}))},y=function(){function e(t){(0,r.Z)(this,e),this.editor=null,this.options=Object.assign({},t)}var t,n;return(0,o.Z)(e,[{key:"setEditor",value:function(e){this.editor=e}},{key:"nodes",value:function(){return{}}},{key:"marks",value:function(){return{}}},{key:"plugins",value:function(){return[]}},{key:"toolbarItems",value:function(){return[]}},{key:"keymap",value:function(e){}},{key:"inputRules",value:function(){return[]}},{key:"getSchema",value:function(){return this.editor.schema}},{key:"applyFormatters",value:function(e){return e}},{key:"doc",get:function(){return this.editor.state.doc}},{key:"showModal",value:(n=(0,i.Z)(s().mark((function e(t,n){var i,r,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=document.createElement("span"),this.editor.viewExtrasEl.appendChild(i),r={component:t,props:n},Object.preventExtensions(r),e.next=6,d().loadRequirements(t);case 6:return(o=new w({parent:this.editor.getParent(),propsData:{container:r}})).$mount(i),e.abrupt("return",new Promise((function(e){o.$on("close-complete",(function(t){o.$destroy(),e(t)})),o.show()})));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"showComponent",value:function(e,t){var n=document.createElement("span"),i=l().extend(e);this.editor.viewExtrasEl.appendChild(n);var r=new i(Object.assign({parent:this.editor.getParent()},t));return r.$mount(n),r}},{key:"showActionDropdown",value:(t=(0,i.Z)(s().mark((function e(t,n){var i,r,o,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.actions,r=this.editor.view.coordsAtPos(t),o=this.editor.viewExtrasEl.offsetParent.getBoundingClientRect(),e.next=5,g(0);case 5:return e.next=7,(0,v.loadLangStrings)(i.map((function(e){return e.label})));case 7:return(a=this.showComponent(h(),{propsData:{location:{x:r.left-o.left,y:r.bottom-o.top},actions:i}})).$on("dismiss",(function(){a.$destroy(),a.$el.remove()})),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"removeNode",value:function(e){this.editor.execute((function(t,n){var i=t.tr,r=e();i.delete(r.from,r.to),n(i)}))}}]),e}(),w=l().extend({props:{container:{type:Object}},data:function(){return{result:null,open:!1}},methods:{show:function(){this.open=!0},requestClose:function(e){this.result=e,this.open=!1},closeComplete:function(){this.$emit("close-complete",this.result)}},render:function(e){return e(f(),{props:{open:this.open},on:{"request-close":this.requestClose,"close-complete":this.closeComplete}},[e(this.container.component,{props:this.container.props})])}})},MLis:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});var i=n("rRkQ"),r=n("IkkI"),o=n("vWPu"),a=n("F2vq"),s=n("thZj"),u=n("keTO"),l=n("HXa6"),c=tui.require("tui/components/icons/AlignLeft"),d=n.n(c),p=tui.require("tui/components/icons/AlignCenter"),f=n.n(p),m=tui.require("tui/components/icons/AlignRight"),h=n.n(m),v=n("cXde");function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,v.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){return Boolean(e.spec.attrs&&e.spec.attrs[t])}function y(e,t,n,i){var r=function(e,t,n,i){var r=[];return e.nodesBetween(t,n,(function(e){if(g(e.type,i)){var t=e.attrs[i];r.includes(t)||r.push(t)}})),r}(e,t,n,i);return!(r.length>1||0===r.length)&&r[0]}function w(e,t,n,i){return!!g(t.type,"align")&&e.setNodeMarkup(n,t.type,k(k({},t.attrs),{},{align:i}))}var b=n("xIDV");var x=function(e){(0,o.Z)(c,e);var t,n,u=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,i.Z)(this,c),u.apply(this,arguments)}return(0,r.Z)(c,[{key:"setAlignment",value:function(e,t){var n=e.state,i=n.tr,r=n.selection;this.editor.view.focus();var o=r.$from.blockRange(r.$to);if(!o)return!1;var a=o.$from.start(o.depth);return o.parent.nodesBetween(o.$from.pos-a,o.$to.pos-a,(function(e,n){"right"===t&&(0,b.isRtl)()||"left"===t&&!(0,b.isRtl)()?w(i,e,n,void 0):w(i,e,n,t)}),a),!!i.docChanged&&(this.editor.dispatch(i),!0)}},{key:"isAlignmentActive",value:function(e,t){var n=e.state,i=n.selection,r=y(n.doc,i.from,i.to,"align");return!(void 0!==r||!("left"===t&&!(0,b.isRtl)()||"right"===t&&(0,b.isRtl)()))||r===t}},{key:"getAlignmentIcon",value:function(e){var t=e.state,n=t.selection;switch(y(t.doc,n.from,n.to,"align")){case"center":return f();case"right":return h();case"left":return d()}return(0,b.isRtl)()?h():d()}},{key:"canSetAlignment",value:function(e){var t=e.state.selection,n=!1,i=t.$from.blockRange(t.$to);if(!i)return!1;var r=i.$from.start(i.depth);return i.parent.nodesBetween(i.$from.pos-r,i.$to.pos-r,(function(e){g(e.type,"align")&&(n=!0)}),r),n}},{key:"toolbarItems",value:function(){var e=this;return[new l.ToolbarItem({group:"text",label:(0,b.langString)("alignment","editor"),getIconComponent:this.getAlignmentIcon,enabled:function(t){return e.canSetAlignment(t)},children:[new l.ToolbarItem({group:"text",label:(0,b.langString)("left","editor"),iconComponent:d(),execute:function(t){return e.setAlignment(t,"left")},active:function(t){return e.isAlignmentActive(t,"left")}}),new l.ToolbarItem({group:"text",label:(0,b.langString)("centre","editor"),iconComponent:f(),execute:function(t){return e.setAlignment(t,"center")},active:function(t){return e.isAlignmentActive(t,"center")}}),new l.ToolbarItem({group:"text",label:(0,b.langString)("right","editor"),iconComponent:h(),execute:function(t){return e.setAlignment(t,"right")},active:function(t){return e.isAlignmentActive(t,"right")}})]})]}}]),c}(u.default),N=function(e){return new x(e)}},"uX+G":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var i=n("37Fk"),r=n("rRkQ"),o=n("IkkI"),a=n("vWPu"),s=n("F2vq"),u=n("thZj"),l=n("KCiO"),c=n.n(l),d=n("keTO"),p=tui.require("editor_weka/components/nodes/Attachment"),f=n.n(p),m=tui.require("editor_weka/components/nodes/Attachments"),h=n.n(m),v=tui.require("tui/components/icons/Attachment"),_=n.n(v),k=n("HXa6"),g=n("xIDV"),y=n("h5d1"),w=n("IlVy"),b=n("Xz/0"),x=n("NWA4"),N=n("x7Rm"),I=n("MERh");var S=function(e){(0,a.Z)(E,e);var t,n,l,d,p,m,v,S,O,A=(S=E,O=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(S);if(O){var n=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,s.Z)(this,e)});function E(e){var t;return(0,r.Z)(this,E),void 0===e&&(e={}),(t=A.call(this,e)).acceptTypes=e.accepttypes||[],t}return(0,o.Z)(E,[{key:"nodes",value:function(){return{attachment:{schema:{inline:!0,atom:!0,attrs:{filename:{default:void 0},size:{default:void 0},option:{default:void 0},url:{default:void 0}},parseDOM:[{tag:"div.tui-wekaNodeAttachment",getAttrs:w.getJsonAttrs}],toDOM:function(e){return["div",{class:"tui-wekaNodeAttachment","data-attrs":JSON.stringify({filename:e.attrs.filename,option:e.attrs.option,url:e.attrs.url})}]}},component:f(),componentContext:{convertToImage:this._convertToImage.bind(this),convertToVideo:this._convertToVideo.bind(this),convertToAudio:this._convertToAudio.bind(this),updateNode:this._updateNode.bind(this),hasImageNode:this._hasImageNode.bind(this),hasVideoNode:this._hasVideoNode.bind(this),removeNode:this.removeNode.bind(this),hasAudioNode:this._hasAudioNode.bind(this),getItemId:this._getItemId.bind(this),getDownloadUrl:this._getDownloadUrl.bind(this)}},attachments:{schema:{group:"block",allowGapCursor:!0,content:"attachment*",parseDOM:[{tag:"div.tui-wekaNodeAttachments"}],toDOM:function(){return["div",{class:"tui-wekaNodeAttachments"},0]}},component:h()}}}},{key:"toolbarItems",value:function(){var e=this;return this.editor.fileStorage.enabled?[new k.ToolbarItem({group:"embeds",label:(0,g.langString)("attachment","editor_weka"),iconComponent:_(),execute:function(t){(0,x.pickFiles)(t).then((function(t){e.startUploadingFiles(t)}))}})]:[]}},{key:"plugins",value:function(){return this.editor.fileStorage.enabled?[(0,y.attachment)({onDrop:this._onDropEvent.bind(this),onKeyDown:this._onKeyDownEvent.bind(this)})]:[]}},{key:"_findAttachmentCollectionBlock",value:function(e){var t=e.selection.$from,n=t.parent;if(!n||"attachments"!==n.type.name)return null;var i=t.pos;return e.selection.empty||(i+=1),{from:t.before(),to:t.after(),insertPoint:i,node:n}}},{key:"startUploadingFiles",value:(v=(0,i.Z)(c().mark((function e(t){var n,i,r,o,a,s,u,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.editor.fileStorage.uploadFiles(t,this.acceptTypes);case 3:if(0!==(n=e.sent).length){e.next=6;break}return e.abrupt("return");case 6:i=this.editor.state.schema,r=this.editor.view,o=r.state.tr,a=this._findAttachmentCollectionBlock(o),s=n.map((function(e){var t=e.filename,n=e.url,r=e.file_size;return i.node("attachment",{filename:t,url:n,size:r,option:{}})})),a?(o.insert(a.insertPoint,s),r.dispatch(o)):(u=i.node("attachments",null,s),l=o.selection.$from.pos,r.dispatch(o.replaceWith(l,l,u))),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),d=(0,g.langString)("error_upload_failed","editor_weka"),(0,g.loadLangStrings)([d]).then((function(){return(0,N.notify)({type:"error",message:d.toString()})}));case 17:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return v.apply(this,arguments)})},{key:"_onKeyDownEvent",value:function(e){var t=e.view,n=e.event,i=t.state.tr,r=this._findAttachmentCollectionBlock(i);if(!r)return!1;if("Enter"===n.key){var o=t.state.schema.nodes.paragraph.createAndFill();return i.insert(r.to,o),i.setSelection(new b.TextSelection(i.doc.resolve(r.to+1))),t.dispatch(i),!0}if("Backspace"===n.key){if(!i.selection.$from.nodeBefore)return!1;if(1===r.node.content.size)return i.delete(r.from,r.to),t.dispatch(i),!0}return!1}},{key:"_onDropEvent",value:function(e){var t=e.event;return!!(t.dataTransfer&&t.dataTransfer.files&&t.dataTransfer.files.length)&&(t.preventDefault(),this.startUploadingFiles(t.dataTransfer.files),!0)}},{key:"_convertToImage",value:(m=(0,i.Z)(c().mark((function e(t,n){var i,r,o,a=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.filename,r=n.alttext,e.next=3,this._getFileInfo(i);case 3:o=e.sent,this.editor.execute((function(e,n){var s=e.schema.node("image",{filename:i,url:o.url,alttext:r});a._doConvertToMedia(s,e.tr,n,t)}));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"_convertToVideo",value:(p=(0,i.Z)(c().mark((function e(t,n){var i,r,o,a,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.filename,r=n.mimeType,o=n.subtitle,e.next=3,this._getFileInfo(i);case 3:a=e.sent,this.editor.execute((function(e,n){var u={filename:i,url:a.url,mime_type:r,subtitle:o},l=e.schema.node("video",u);s._doConvertToMedia(l,e.tr,n,t)}));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"_updateNode",value:(d=(0,i.Z)(c().mark((function e(t,n){var i,r,o,a,s,u=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.filename,r=n.option,o=n.size,a=n.transcript,e.next=3,this._getFileInfo(i);case 3:s=e.sent,this.editor.execute((function(e,n){var l=e.tr,c=t(),d={filename:i,url:s.url,option:r,size:o};a&&(d.transcript={url:a.url,filename:a.filename}),n(l.replaceWith(c.from,c.to,e.schema.node("attachment",d))),u.editor.view.focus()}));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"_hasImageNode",value:function(){return this.editor.hasNode("image")}},{key:"_hasVideoNode",value:function(){return this.editor.hasNode("video")}},{key:"_hasAudioNode",value:function(){return this.editor.hasNode("audio")}},{key:"removeNode",value:function(e){var t=this;this.editor.execute((function(n,i){var r=e(),o=n.tr,a=(0,I.findParentNodeOfTypeClosestToPos)(o.doc.resolve(r.from),t.editor.schema.nodes.attachments);(1===a.node.content.size?b.NodeSelection.create(o.doc,a.pos):b.NodeSelection.create(o.doc,r.from)).replace(o),i(o)}))}},{key:"_convertToAudio",value:(l=(0,i.Z)(c().mark((function e(t,n){var i,r,o,a,s,u=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.filename,r=n.mimeType,o=n.transcript,e.next=3,this._getFileInfo(i);case 3:a=e.sent,s={filename:i,url:a.url,mime_type:r,transcript:o},this.editor.execute((function(e,n){var i=e.schema.node("audio",s);u._doConvertToMedia(i,e.tr,n,t)}));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"_doConvertToMedia",value:function(e,t,n,i){var r=i(),o=(0,I.findParentNodeOfTypeClosestToPos)(t.doc.resolve(r.from),this.editor.schema.nodes.attachments);(1===o.node.content.size?b.NodeSelection.create(t.doc,o.pos):b.NodeSelection.create(t.doc,r.from)).replaceWith(t,e),n(t)}},{key:"_getFileInfo",value:(n=(0,i.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.editor.fileStorage.getFileInfo(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_getDownloadUrl",value:(t=(0,i.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getFileInfo(t);case 2:return n=e.sent,e.abrupt("return",n.download_url);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_getItemId",value:function(){return this.editor.fileStorage.getFileStorageItemId()}}]),E}(d.default),O=function(e){return new S(e)}},"9DO/":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var i=n("rRkQ"),r=n("IkkI"),o=n("vWPu"),a=n("F2vq"),s=n("thZj"),u=n("keTO"),l=n("HXa6"),c=n("xIDV"),d=tui.require("editor_weka/components/editing/EmojiSelector"),p=n.n(d),f=tui.require("editor_weka/components/nodes/Emoji"),m=n.n(f),h=tui.require("tui/components/icons/Emoji"),v=n.n(h),_=n("Aely"),k=n.n(_),g=n("EJ04"),y=n("IlVy");var w=function(e){(0,o.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function d(e){var t;(0,i.Z)(this,d),t=u.call(this,e),void 0===e&&(e={}),t.emojis=e.emojis||[];var n=t.emojis.map((function(e){return e.pattern}));return t.charArray=n.toString().split(""),t.charArray=t.charArray.filter((function(e,n){return t.charArray.indexOf(e)===n})),t}return(0,r.Z)(d,[{key:"nodes",value:function(){return{emoji:{schema:{group:"inline",inline:!0,attrs:{shortcode:{default:""}},parseDOM:[{tag:"span.tui-wekaNodeEmoji",getAttrs:y.getJsonAttrs}],toDOM:function(e){return["span",{class:"tui-wekaNodeEmoji","data-attrs":JSON.stringify({shortcode:e.attrs.shortcode})},String.fromCodePoint("0x"+e.attrs.shortcode)]}},component:m()}}}},{key:"plugins",value:function(){return[(0,g.default)(this.editor,this.emojis,this.charArray)]}},{key:"toolbarItems",value:function(){return[new l.ToolbarItem({group:"embeds",popover:{title:"",component:this.getEmojiPopover()},label:(0,c.langString)("insertemoji","editor"),iconComponent:v(),enabled:function(e){return!!e.view.editable&&e.view.state.selection.$head.pos>0},reset:function(e){e.view.focus()}})]}},{key:"getEmojiPopover",value:function(){var e=this;return k().extend({data:function(){return{insertEmoji:e.insertEmoji.bind(e),emojiData:e.emojis}},methods:{emojiSelected:function(e){this.$emit("close"),this.insertEmoji(e)}},render:function(e){return e(p(),{props:{emojis:this.emojiData},on:{"emoji-selected":this.emojiSelected}})}})}},{key:"insertEmoji",value:function(e){var t=this,n=e.shortcode;this.editor.execute((function(e,i){var r=e.schema.node("emoji",{shortcode:n}),o=e.selection,a=o.from,s=o.to;i(e.tr.replaceWith(a,s,r)),t.editor.view.focus()}))}}]),d}(u.default),b=function(e){return new w(e)}},"Xj/A":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var i=n("rRkQ"),r=n("IkkI"),o=n("vWPu"),a=n("F2vq"),s=n("thZj"),u=n("keTO"),l=n("dUEx"),c=tui.require("editor_weka/components/nodes/Hashtag"),d=n.n(c),p=tui.require("editor_weka/helpers/suggestion"),f=n.n(p);n("Xz/0");var m=function(e){(0,o.Z)(c,e);var t,n,u=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,i.Z)(this,c),u.apply(this,arguments)}return(0,r.Z)(c,[{key:"nodes",value:function(){return{hashtag:{schema:{group:"inline",inline:!0,atom:!0,attrs:{text:{default:""}},parseDOM:[{tag:"span.tui-wekaNodeHashtag",getAttrs:function(e){try{return{text:e.textContent.trim().slice(1)}}catch(e){return{}}}}],toDOM:function(e){return["span",{class:"tui-wekaNodeHashtag"},"#"+e.attrs.text]}},component:d()}}}},{key:"plugins",value:function(){return[(0,l.default)(this.editor)]}},{key:"applyFormatters",value:function(e){var t=new(f())(this.editor),n=e.tr;return e.doc.nodesBetween(0,e.doc.nodeSize-2,(function(i,r){if(i.isText){l.REGEX.lastIndex=0;for(var o=e.doc.resolve(r),a=t.matcher(l.REGEX,o);a;)n=n.replaceWith(n.mapping.map(a.range.from),n.mapping.map(a.range.to),e.schema.node("hashtag",{text:a.text.slice(1)})),a=t.matcher(l.REGEX,o)}})),n.docChanged?(this.editor.dispatch(n),this.editor.state):e}}]),c}(u.default),h=function(e){return new m(e)}},"S+fX":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var i=n("cXde"),r=n("L2Id"),o=n("cVfm");var a=n("rRkQ"),s=n("IkkI"),u=n("vWPu"),l=n("F2vq"),c=n("thZj"),d=tui.require("editor_weka/toolbar"),p=n("xIDV"),f=n("Xz/0"),m=n("51FK"),h=n("wQtR"),v=n("keTO"),_=tui.require("editor_weka/lib/prosemirror_utils/helpers"),k=n("MERh"),g=n("ASUJ"),y=tui.require("editor_weka/components/nodes/LayoutBlock"),w=n.n(y),b=tui.require("editor_weka/components/nodes/LayoutColumn"),x=n.n(b),N=tui.require("tui/components/icons/Add"),I=n.n(N),S=n("AQw4"),O=n.n(S),A=n("hd/h"),E=n.n(A),C=n("5TpV"),T=n.n(C),D=n("KTPV"),M=n.n(D),B=n("Pspb"),$=n.n(B),F=n("PWfy"),j=n.n(F);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var P=function(e){(0,u.Z)(m,e);var t,n,i=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var r=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function m(){return(0,a.Z)(this,m),i.apply(this,arguments)}return(0,s.Z)(m,[{key:"nodes",value:function(){return{layout_block:{schema:{group:"rootblock",content:"layout_column+",isolating:!0,defining:!0,parseDOM:[{tag:"div.jsoneditor-layout-block"}],toDOM:function(){return["div",{class:"jsoneditor-layout-block"},0]}},component:w(),componentContext:{getLayoutBlockDetails:q,updateLayout:this.updateLayout.bind(this),deleteLayout:this.deleteLayout.bind(this)}},layout_column:{schema:{content:"block+",isolating:!0,defining:!0,attrs:{type:{default:void 0}},parseDOM:[{tag:"div.jsoneditor-layout-column--sidebar",attrs:{type:"sidebar"}},{tag:"div.jsoneditor-layout-column",attrs:{type:void 0}}],toDOM:function(e){var t=["jsoneditor-layout-column"];return"sidebar"===e.attrs.type&&t.push("jsoneditor-layout-column--sidebar"),["div",{class:t.join(" ")},0]}},component:x()}}}},{key:"getLayoutOptions",value:function(){return[{label:(0,p.langString)("layout_one_column","editor_weka"),iconComponent:E(),columns:[{}]},{label:(0,p.langString)("layout_two_column","editor_weka"),columns:[{},{}],iconComponent:T()},{label:(0,p.langString)("layout_narrow_left_column","editor_weka"),columns:(0,p.isRtl)()?[{},{type:"sidebar"}]:[{type:"sidebar"},{}],iconComponent:M()},{label:(0,p.langString)("layout_narrow_right_column","editor_weka"),columns:(0,p.isRtl)()?[{type:"sidebar"},{}]:[{},{type:"sidebar"}],iconComponent:$()},{label:(0,p.langString)("layout_three_column","editor_weka"),columns:[{},{},{}],iconComponent:j()}]}},{key:"toolbarItems",value:function(){return[new d.ToolbarItem({group:"layout",label:(0,p.langString)("layout","editor"),iconComponent:O(),children:[(0,d.cmdItem)(V,{label:(0,p.langString)("add_layout","editor_weka"),iconComponent:I(),type:"button"}),new d.ToolbarItem({type:"separator"})].concat((e=this.getLayoutOptions().map(W),function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,o.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))})];var e}},{key:"updateLayout",value:function(e,t){var n=t.columns,i=this.editor.state,r=e(),o=Z({columns:n},i.doc.nodeAt(r.from)),a=i.tr;a.replaceWith(r.from,r.to,o),a.setSelection(f.Selection.near(a.doc.resolve(r.from+2))),this.editor.dispatch(a),this.editor.view.focus()}},{key:"deleteLayout",value:function(e){this.editor.execute((function(t,n){var i=e();n(t.tr.delete(i.from,i.to))}))}}]),m}(v.default);function L(e){var t=e.columns;return function(e,n){if(t.length<1)return!1;if(!n)return!0;var i=e.selection,r=e.schema.nodes,o=r.layout_block,a=r.layout_column,s=o.create(null,t.map((function(e){return a.createAndFill({type:e.type})}))),u=e.tr;u.insert(i.to,s);var l=u.mapping.maps.length,c=(0,g.getInsertedPos)(u);if(null!=c){if(!i.empty){var d=c+2;u.replace(d,d+s.content.child(0).content.size,e.doc.slice(i.from,i.to)),u.delete(i.from,i.to)}if(i.empty&&(0,_.isEmptyParagraph)(i.$from.parent)){var p=u.mapping.map(i.$from.before());u.delete(p,p+i.$from.parent.nodeSize)}c=u.mapping.slice(l).map(c);var m=u.doc.nodeAt(c+1).content.size;u.setSelection(f.Selection.near(u.doc.resolve(c+2+m),-1))}return n(u),!0}}function Z(e,t){var n=e.columns,i=t.type.schema.nodes,r=i.layout_block,o=i.layout_column,a=n.length;return r.create(null,n.map((function(e,n){var i={type:e.type},r=t.maybeChild(n),s=r?r.content:m.Fragment.empty;if(n===a-1)for(var u=n+1;u<t.childCount;u++){var l=t.child(u);1===l.childCount&&(0,_.isEmptyParagraph)(l.child(0))||(s=s.append(l.content))}return o.createAndFill(i,s)||o.create(i)})))}function V(e,t){var n=(0,k.findParentNodeOfTypeClosestToPos)(e.selection.$from,e.schema.nodes.layout_block);return L(n?q(n.node):{columns:[{},{}]})(e,t)}function q(e){var t=[];return e.forEach((function(e){t.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.attrs))})),{columns:t}}function W(e){var t=(0,h.chainCommands)(function(e){return function(t,n){var i=(0,k.findParentNodeOfTypeClosestToPos)(t.selection.$from,t.schema.nodes.layout_block);if(!i)return!1;if(n){var r=Z(e,i.node),o=t.tr;o.replaceWith(i.pos,i.pos+i.node.nodeSize,r),o.setSelection(f.Selection.near(o.doc.resolve(i.pos+2))),n(o)}return!0}}(e),L(e));return(0,d.cmdItem)(t,{label:e.label,iconComponent:e.iconComponent})}var z=function(e){return new P(e)}},TPYw:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var i=n("37Fk"),r=n("rRkQ"),o=n("IkkI"),a=n("SiDh"),s=n("vWPu"),u=n("F2vq"),l=n("thZj"),c=n("KCiO"),d=n.n(c),p=n("keTO"),f=n("IlVy"),m=tui.require("editor_weka/components/nodes/LinkBlock"),h=n.n(m),v=tui.require("editor_weka/components/nodes/LinkMedia"),_=n.n(v),k=tui.require("editor_weka/components/marks/Link"),g=n.n(k),y=tui.require("editor_weka/components/editing/EditLinkModal"),w=n.n(y),b=tui.require("tui/components/icons/Link"),x=n.n(b),N=n("Xz/0"),I=n("51FK"),S=n("xIDV"),O=n("HXa6"),A=n("Vulv"),E=n("1ahB"),C=n("bIqi"),T=n("U0bO"),D=n("x7Rm");var M=/\bhttps?:\/\/[-a-zA-Z0-9@:%._+~#=]+\b(?:[-a-zA-Z0-9@:%_+.~#?&//=]*)/g,B=/\b[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?/g,$=["link_block","link_media"],F=function(e){(0,s.Z)(v,e);var t,n,c,p,m=(c=v,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(c);if(p){var n=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,u.Z)(this,e)});function v(e){var t;return(0,r.Z)(this,v),(t=m.call(this,e)).isMedia=t.isMedia.bind((0,a.Z)(t)),t._convertPastedUrl=t._convertPastedUrl.bind((0,a.Z)(t)),t._convertPastedEmail=t._convertPastedEmail.bind((0,a.Z)(t)),t._getSelectionRange=t._getSelectionRange.bind((0,a.Z)(t)),t}return(0,o.Z)(v,[{key:"nodes",value:function(){return{link_media:{schema:{group:"block",atom:!0,attrs:{url:{},loading:{default:void 0},type:{default:void 0},image:{default:void 0},title:{default:void 0},description:{default:void 0},siteName:{default:void 0},resolution:{default:void 0}},parseDOM:[{tag:".tui-wekaNodeLinkMedia",getAttrs:f.getJsonAttrs}],toDOM:function(e){return["a",{class:"tui-wekaNodeLinkMedia","data-attrs":JSON.stringify(e.attrs),href:e.attrs.url},e.attrs.url]}},component:_(),componentContext:{urlPlugin:this.urlPlugin.bind(this),editCard:this.editCard.bind(this),replaceWithTextLink:this.replaceWithTextLink.bind(this)}},link_block:{schema:{group:"block",atom:!0,attrs:{url:{},type:{default:void 0},image:{default:void 0},title:{default:void 0},description:{default:void 0},siteName:{default:void 0},open_in_new_window:{default:void 0}},parseDOM:[{tag:".tui-wekaNodeLinkBlock",getAttrs:function(e){var t=(0,f.getJsonAttrs)(e);return t.open_in_new_window=!!e.getAttribute("target"),t.target=void 0,t}}],toDOM:function(e){return["a",{class:"tui-wekaNodeLinkBlock","data-attrs":JSON.stringify(e.attrs),href:e.attrs.url,target:e.attrs.open_in_new_window?"_blank":null},e.attrs.url]}},component:h(),componentContext:{editCard:this.editCard.bind(this),replaceWithTextLink:this.replaceWithTextLink.bind(this)}}}}},{key:"marks",value:function(){return{link:{schema:{attrs:{href:{},title:{default:void 0},open_in_new_window:{default:void 0}},inclusive:!1,parseDOM:[{tag:"a[href]:not([class*=tui-weka])",getAttrs:function(e){return{href:e.getAttribute("href"),title:e.getAttribute("title"),open_in_new_window:!!e.getAttribute("target")}}}],toDOM:function(e){var t=e.attrs;return["a",{href:t.href,title:t.title,target:e.attrs.open_in_new_window?"_blank":void 0},0]}},component:g(),componentContext:{showMarkDropdown:this.showMarkDropdown.bind(this)}}}}},{key:"plugins",value:function(){var e=this;return[new N.Plugin({props:{transformPasted:function(t){var n=P(t.content,{convert:e._convertPastedUrl},M);return n=P(n,{convert:e._convertPastedEmail},B),new I.Slice(n,t.openStart,t.openEnd)}}})]}},{key:"toolbarItems",value:function(){var e=this;return[new O.ToolbarItem({group:"embeds",label:(0,S.langString)("link","editor_weka"),iconComponent:x(),execute:function(){e.editLink()}})]}},{key:"loadSerializedVisitor",value:function(){return{link_media:function(e){delete e.attrs.loading,Array.isArray(e.attrs.resolution)&&delete e.attrs.resolution}}}},{key:"saveSerializedVisitor",value:function(){return{link_media:function(e){delete e.attrs.loading}}}},{key:"editLink",value:function(){var e=this,t=this.getSchema().marks.link,n=this._getSelectionRange();if(n.from===n.to){var r=(0,C.getMarkRange)(this.doc.resolve(n.from),t);if(r)return void this._editMarkAt((function(){return r}))}var o,a=this.doc.textBetween(n.from,n.to);this.showModal(w(),{isNew:!0,isMedia:this.isMedia,attrs:{url:"",text:a,open_in_new_window:void 0},save:(o=(0,i.Z)(d().mark((function t(n){var i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._prepareLinkUpdate(n);case 2:i=t.sent,e._updateLink({type:null,getRange:e._getSelectionRange},i),e.editor.view.focus();case 5:case"end":return t.stop()}}),t)}))),function(e){return o.apply(this,arguments)})})}},{key:"replaceWithTextLink",value:function(e,t){var n=t.url;this.editor.execute((function(t,i){var r=n;n.startsWith("mailto:")&&(r=n.substring("mailto:".length));var o=t.schema.text(r,[t.schema.mark("link",{href:n})]),a=e();i(t.tr.replaceWith(a.from,a.to,o))}))}},{key:"urlPlugin",value:function(e){return this._findLinkPlugin(e)}},{key:"isMedia",value:function(e){return!!this._findLinkPlugin({type:"media",url:e})}},{key:"editCard",value:function(e){var t,n=this,r=this.doc.nodeAt(e().from),o=r.type.name;$.includes(o)&&this.showModal(w(),{isMedia:this.isMedia,attrs:{type:o,url:r.attrs.url,open_in_new_window:r.attrs.open_in_new_window},save:(t=(0,i.Z)(d().mark((function t(i){var r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._prepareLinkUpdate(i);case 2:r=t.sent,n._updateLink({type:o,getRange:e},r),n.editor.view.focus();case 5:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})})}},{key:"showMarkDropdown",value:function(e){var t=this,n=this._getLinkMark(e);if(n){var i=n&&this.isMedia(n.attrs.href),r=n&&n.attrs.href.startsWith("mailto:"),o=[{label:(0,S.langString)("go_to_link_label","editor_weka"),action:function(){return t._openLinkMarkAt(e)}},{label:(0,S.langString)("edit","core"),action:function(){return t._editMarkAt(e)}}];return r||o.push({label:i?(0,S.langString)("display_as_embedded_media","editor_weka"):(0,S.langString)("display_as_card","editor_weka"),action:function(){return t._markToCardAt(i?"link_media":"link_block",e)}}),o.push({label:(0,S.langString)("delete","editor_weka"),action:function(){return t._removeMarkAt(e)}}),"link"==n.type.name&&o.push({label:(0,S.langString)("remove_link_target","editor_weka"),action:function(){t._removeLink(e)}}),this.showActionDropdown(e().from,{actions:o})}}},{key:"_findLinkPlugin",value:function(e){for(var t=e.type,n=e.url,i=0;i<R.length;i++){var r=R[i];if(!t||r.type===t)for(var o=0;o<r.matches.length;o++){var a=r.matches[o],s=a.match.exec(n);if(s)return{plugin:r,details:a.details?a.details(s):{}}}}return null}},{key:"_updateLink",value:function(e,t){var n=this;e||(e={type:null,getRange:this._getSelectionRange});var i=null;if("link"===e.type||null===e.type){var r=e.getRange();i=this.doc.textBetween(r.from,r.to)}this.editor.execute((function(r,o){var a=(0,C.expandContentResolvedRange)(C.ResolvedRange.resolve(n.doc,e.getRange()));if("link"==t.type){var s=r.schema.marks.link,u=t.text||t.url,l=s.create({href:t.url,open_in_new_window:t.open_in_new_window});o("link"==e.type&&i&&u===i?r.tr.removeMark(a.$from.pos,a.$to.pos,s).addMark(a.$from.pos,a.$to.pos,l):r.tr.replaceWith(a.$from.pos,a.$to.pos,u?r.schema.text(u,[l]):I.Fragment.empty))}else $.includes(t.type)&&o(r.tr.replaceWith(a.$from.pos,a.$to.pos,t.content))}))}},{key:"_prepareLinkUpdate",value:(n=(0,i.Z)(d().mark((function e(t){var n,i,r,o,a,s,u,l,c;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.type,i=t.url,r=t.text,o=t.open_in_new_window,!i.startsWith("mailto:")){e.next=3;break}return e.abrupt("return",this._createEmailLinkUpdate(t));case 3:if(!$.includes(n)){e.next=37;break}if(a=this.editor.state.schema,!(s=(!n||"link_media"==n)&&this._findLinkPlugin({type:"media",url:i}))){e.next=21;break}if(!s.plugin.nodeAttrs){e.next=18;break}return e.prev=8,e.next=11,s.plugin.nodeAttrs({url:i});case 11:u=e.sent,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),u={},console.error(e.t0);case 18:return e.abrupt("return",new j({type:n,url:i,content:a.node("link_media",Object.assign({url:i},u))}));case 21:return e.prev=21,e.next=24,(0,A.getLinkMetadata)(i);case 24:c=e.sent,(l=V(c))||(l={}),l.open_in_new_window=o,e.next=34;break;case 30:e.prev=30,e.t1=e.catch(21),console.error(e.t1),l={};case 34:return e.abrupt("return",new j({type:n,url:i,content:a.node("link_block",Object.assign({url:i},l))}));case 35:e.next=38;break;case 37:return e.abrupt("return",new j({type:"link",url:i,text:r,open_in_new_window:o}));case 38:case"end":return e.stop()}}),e,this,[[8,14],[21,30]])}))),function(e){return n.apply(this,arguments)})},{key:"_createEmailLinkUpdate",value:function(e){var t=e.url,n=e.text;return n||(n=t.substring("mailto:".length)),new j({type:"link",url:t,text:n})}},{key:"_convertPastedEmail",value:function(e){return this._convertPastedUrl("mailto:".concat(e))}},{key:"_convertPastedUrl",value:function(e){var t=this,n=this.getSchema().marks.link,i=this.getSchema().nodes.link_media,r=this._findLinkPlugin({type:"media",url:e});if(r){var o={url:e};r.plugin.nodeAttrs&&(o.loading=!0);var a=i.create(o);return o.loading&&r.plugin.nodeAttrs({url:e}).then((function(n){t._updatePastedMedia(e,n)})).catch((function(n){console.error(n),t._updatePastedMedia(e,{})})),a}return n.create({href:e})}},{key:"_updatePastedMedia",value:function(e,t){var n=this.getSchema().nodes.link_media,i=this.editor.state.tr;this.editor.state.doc.descendants((function(r,o){if(r.type==n&&r.attrs.loading&&r.attrs.url===e){var a=Object.assign({},r.attrs,{loading:!1},t);i=(0,E.setAttrs)(o,a)(i)}})),i.setMeta("addToHistory",!1),this.editor.dispatch(i)}},{key:"_getSelectionRange",value:function(){return(0,T.pick)(this.editor.state.selection,["from","to"])}},{key:"_getLinkMark",value:function(e){return(0,C.getMark)(this.doc.resolve(e().from),this.getSchema().marks.link)}},{key:"_openLinkMarkAt",value:function(e){var t=this._getLinkMark(e);t&&window.open(t.attrs.href)}},{key:"_editMarkAt",value:function(e){var t=this,n=e(),r=this._getLinkMark(e);if(r){var o,a=r.attrs.href,s=this.doc.textBetween(n.from,n.to);a===s&&(s=null),this.showModal(w(),{isMedia:this.isMedia,attrs:{url:a,text:s,open_in_new_window:r.attrs.open_in_new_window},save:(o=(0,i.Z)(d().mark((function n(i){var r;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._prepareLinkUpdate(i);case 2:r=n.sent,t._updateLink({type:"link",getRange:e},r),t.editor.view.focus();case 5:case"end":return n.stop()}}),n)}))),function(e){return o.apply(this,arguments)})})}}},{key:"_markToCardAt",value:(t=(0,i.Z)(d().mark((function e(t,n){var i,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._getLinkMark(n)){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,this._prepareLinkUpdate({type:t,url:i.attrs.href,open_in_new_window:i.attrs.open_in_new_window});case 6:r=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),q(e.t0),e.abrupt("return");case 13:this._updateLink({type:"link",getRange:n},r),this.editor.view.focus();case 15:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(e,n){return t.apply(this,arguments)})},{key:"_removeLink",value:function(e){var t=this;this.editor.execute((function(n,i){var r=e(),o=t.doc.resolve(r.from).nodeAfter,a=n.schema.text(o.text);i(n.tr.replaceWith(r.from,r.to,a))}))}},{key:"_removeMarkAt",value:function(e){var t=this;this.editor.execute((function(n,i){var r=(0,C.expandContentResolvedRange)(C.ResolvedRange.resolve(t.doc,e()));i(n.tr.delete(r.$from.pos,r.$to.pos))})),this.editor.view.focus()}},{key:"keymap",value:function(e){var t=this;e("Mod-k",(function(){return t.editLink(),!0}))}}]),v}(p.default),j=(0,o.Z)((function e(t){(0,r.Z)(this,e),Object.assign(this,t)})),R=[{key:"youtube",type:"media",name:"YouTube",matches:[{match:/^https?:\/\/(?:www\.)?youtube.com\/watch\?v=([a-zA-Z0-9_-]+)/,details:function(e){return{id:e[1]}}},{match:/^https?:\/\/(?:www\.)?youtu.be\/([a-zA-Z0-9_-]+)/,details:function(e){return{id:e[1]}}}],nodeAttrs:function(e){var t=e.url;return(0,i.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.getLinkMetadata)(t);case 2:return n=e.sent,e.abrupt("return",Z(n));case 4:case"end":return e.stop()}}),e)})))()}},{key:"vimeo-private",type:"media",name:"Vimeo private",matches:[{match:/^https?:\/\/(?:www\.)?vimeo.com\/([0-9]+)\/([0-9a-zA-Z]+)/,details:function(e){return{id:e[1],privateString:e[2]}}}],nodeAttrs:function(e){var t=e.url;return(0,i.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.getLinkMetadata)(t);case 2:return n=e.sent,e.abrupt("return",Z(n));case 4:case"end":return e.stop()}}),e)})))()}},{key:"vimeo",type:"media",name:"Vimeo",matches:[{match:/^https?:\/\/(?:www\.)?vimeo.com\/([0-9]+)/,details:function(e){return{id:e[1]}}}],nodeAttrs:function(e){var t=e.url;return(0,i.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.getLinkMetadata)(t);case 2:return n=e.sent,e.abrupt("return",Z(n));case 4:case"end":return e.stop()}}),e)})))()}},{key:"image",type:"media",name:"Image",matches:[{match:/\.(png|jpe?g|gif|webp|avif)$/}]},{key:"audio",type:"media",name:"Audio",matches:[{match:/\.(aac|flac|m4a|mp3|ogg|opus|wav|wma)$/}]}];function P(e,t,n){var i=[];return e.forEach((function(e){if(e.isText){var r,o=e.text,a=0;for(n.lastIndex=0;r=n.exec(o);){var s=r.index,u=s+r[0].length;s>0&&i.push(e.cut(a,s));var l=o.slice(s,u),c=t.convert(l);c instanceof I.Node?i.push(c):c instanceof I.Mark?i.push(e.cut(s,u).mark(c.addToSet(e.marks))):i.push(e.cut(s,u)),a=u}a<o.length&&i.push(e.cut(a))}else i.push(e.copy(P(e.content,t,n)))})),I.Fragment.fromArray(i)}var L=function(e){var t={};for(var n in e)null!=e[n]&&(t[n]=e[n]);return t};function Z(e){if(null===e)return null;var t=L((0,T.pick)(e,["url","image","title","description"])),n=Number(e.videowidth),i=Number(e.videoheight);return t.resolution=isNaN(n)||isNaN(i)?void 0:{width:n,height:i},t}function V(e){return null===e?null:L((0,T.pick)(e,["url","image","title","description"]))}function q(){return W.apply(this,arguments)}function W(){return(W=(0,i.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,S.langString)("error_no_url_info","editor_weka"),e.next=3,(0,S.loadLangStrings)([t]);case 3:(0,D.notify)({type:"error",message:t.toString()});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=function(e){return new F(e)}},"9OSA":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var i=n("rRkQ"),r=n("IkkI"),o=n("vWPu"),a=n("F2vq"),s=n("thZj"),u=n("keTO"),l=n("xIDV"),c=n("HXa6"),d=n("swIM"),p=n("fLDo"),f=n("R3Ws"),m=tui.require("tui/components/icons/ListOrdered"),h=n.n(m),v=tui.require("tui/components/icons/ListUnordered"),_=n.n(v);var k=["ol",0],g=["ul",0],y=["li",0],w=function(e){(0,o.Z)(m,e);var t,n,u=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function m(){return(0,i.Z)(this,m),u.apply(this,arguments)}return(0,r.Z)(m,[{key:"nodes",value:function(){return{bullet_list:{schema:{content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:function(){return g}}},ordered_list:{schema:{content:"list_item+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:function(e){return{order:e.hasAttribute("start")?+e.getAttribute("start"):1}}}],toDOM:function(e){return 1==e.attrs.order?k:["ol",{start:e.attrs.order},0]}}},list_item:{schema:{content:"paragraph block*",parseDOM:[{tag:"li"}],toDOM:function(){return y},defining:!0,draggable:!1}}}}},{key:"toolbarItems",value:function(){var e=this.getSchema().nodes,t=e.bullet_list,n=e.ordered_list,i=e.list_item,r=[t,n];return[(0,c.cmdItem)((0,d.toggleList)(t,i,r),{group:"text",label:(0,l.langString)("bulletlist","editor"),iconComponent:_(),active:function(e){return(0,d.isListActive)(e.state,t)}}),(0,c.cmdItem)((0,d.toggleList)(n,i,r),{group:"text",label:(0,l.langString)("numberedlist","editor"),iconComponent:h(),active:function(e){return(0,d.isListActive)(e.state,n)}})]}},{key:"keymap",value:function(e){var t=this.getSchema().nodes,n=t.bullet_list,i=t.ordered_list,r=t.list_item,o=[n,i];e("Shift-Ctrl-8",(0,d.toggleList)(n,r,o)),e("Shift-Ctrl-9",(0,d.toggleList)(i,r,o)),e("Enter",(0,p.splitListItem)(r)),e("Shift-Tab",(0,p.liftListItem)(r)),e("Tab",(0,p.sinkListItem)(r))}},{key:"inputRules",value:function(){var e,t=this.getSchema().nodes,n=t.bullet_list,i=t.ordered_list;return[(e=n,(0,f.wrappingInputRule)(/^\s*([-+*])\s$/,e)),b(i)]}}]),m}(u.default);function b(e){return(0,f.wrappingInputRule)(/^(\d+)\.\s$/,e,(function(e){return{order:+e[1]}}),(function(e,t){return t.childCount+t.attrs.order==+e[1]}))}var x=function(e){return new w(e)}},QxpW:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var i=n("cXde"),r=n("37Fk"),o=n("rRkQ"),a=n("IkkI"),s=n("vWPu"),u=n("F2vq"),l=n("thZj"),c=n("KCiO"),d=n.n(c),p=n("keTO"),f=n("HXa6"),m=n("xIDV"),h=n("NWA4"),v=tui.require("editor_weka/components/nodes/ImageBlock"),_=n.n(v),k=tui.require("editor_weka/components/nodes/VideoBlock"),g=n.n(k),y=tui.require("editor_weka/components/nodes/AudioBlock"),w=n.n(y),b=tui.require("editor_weka/components/nodes/FigureCaption"),x=n.n(b),N=n("vujW"),I=n.n(N),S=n("/VMM"),O=n("IlVy"),A=n("x7Rm"),E=n("Xz/0"),C=n("51FK"),T=tui.require("editor_weka/transaction"),D=n("U0bO"),M=tui.require("editor_weka/lib/prosemirror_utils/transforms");function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=new E.PluginKey("figure"),j=function(e){(0,s.Z)(Z,e);var t,n,i,c,p,v,k,y,b,N,B,j,P,L=(j=Z,P=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(j);if(P){var n=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,u.Z)(this,e)});function Z(e){var t;return(0,o.Z)(this,Z),(t=L.call(this,e)).acceptTypes=e.accept_types||[],t}return(0,a.Z)(Z,[{key:"nodes",value:function(){return{figure:{schema:{content:"image? figure_caption",group:"block",parseDOM:[{tag:"figure"}],toDOM:function(){return["figure",0]},atom:!1,isolating:!0,defining:!0,selectable:!1,allowGapCursor:!1}},figure_caption:{schema:{content:"inline*",parseDOM:[{tag:"figcaption"}],toDOM:function(){return["figcaption",0]},selectable:!1,draggable:!1,atom:!1},component:x()},image:{schema:{atom:!0,group:"block",inline:!1,selectable:!0,attrs:{filename:{},url:{default:void 0},alttext:{default:void 0},display_size:{default:void 0}},parseDOM:[{tag:"div.tui-wekaNodeImageBlock",getAttrs:O.getJsonAttrs},{tag:"div.tui-imageBlock",getAttrs:O.getJsonAttrs}],toDOM:function(e){return["div",{class:"tui-wekaNodeImageBlock","data-attrs":JSON.stringify((0,D.pick)(e.attrs,["filename","alttext","url","display_size"]))}]}},component:_(),componentContext:{replaceWithAttachment:this._replaceImageWithAttachment.bind(this),replaceWithFigure:this._replaceImageWithFigure.bind(this),updateImage:this._updateImage.bind(this),hasAttachmentNode:this._hasAttachmentsNode.bind(this),removeNode:this.removeNode.bind(this),getItemId:this._getItemId.bind(this),getDownloadUrl:this._getDownloadUrl.bind(this)}},video:{schema:{atom:!0,group:"block",inline:!1,attrs:{filename:{default:void 0},url:{default:void 0},mime_type:{default:void 0},subtitle:{default:void 0}},parseDOM:[{tag:"div.tui-wekaNodeVideoBlock",getAttrs:O.getJsonAttrs},{tag:"div.tui-videoBlock",getAttrs:O.getJsonAttrs}],toDOM:function(e){var t={filename:e.attrs.filename,url:e.attrs.url,mime_type:e.attrs.mime_type,subtitle:e.attrs.subtitle};return["div",{class:"tui-wekaNodeVideoBlock","data-attrs":JSON.stringify(t)}]}},component:g(),componentContext:{replaceWithAttachment:this._replaceVideoWithAttachment.bind(this),hasAttachmentNode:this._hasAttachmentNode.bind(this),removeNode:this.removeNode.bind(this),getFileUrl:function(){return null},getItemId:this._getItemId.bind(this),getDownloadUrl:this._getDownloadUrl.bind(this),getContextId:this._getContextId.bind(this),updateVideoWithSubtitle:this._updateVideoWithSubtitle.bind(this)}},audio:{schema:{atom:!0,group:"block",inline:!1,attrs:{filename:{default:void 0},url:{default:void 0},mime_type:{default:void 0},transcript:{default:void 0}},parseDOM:[{tag:"div.tui-wekaNodeAudioBlock",getAttrs:O.getJsonAttrs},{tag:"div.tui-audioBlock",getAttrs:O.getJsonAttrs}],toDOM:function(e){return["div",{class:"tui-wekaNodeAudioBlock","data-attrs":JSON.stringify({filename:e.attrs.filename,url:e.attrs.url,mime_type:e.attrs.mime_type,transcript:e.attrs.transcript})}]}},component:w(),componentContext:{hasAttachmentNode:this._hasAttachmentNode.bind(this),replaceWithAttachment:this._replaceAudioWithAttachment.bind(this),removeNode:this.removeNode.bind(this),getFileUrl:function(){return null},getItemId:this._getItemId.bind(this),getDownloadUrl:this._getDownloadUrl.bind(this),getContextId:this._getContextId.bind(this),updateAudioWithTranscript:this._updateAudioWithTranscript.bind(this)}}}}},{key:"plugins",value:function(){return[new E.Plugin({key:F,props:{handleKeyDown:function(e,t){if("Enter"===t.key){var n=e.state,i=n.selection,r=n.doc;if(0!==i.$from.depth&&"figure_caption"===r.nodeAt(i.$from.before()).type.name){var o=n.tr,a=r.resolve(i.$from.before()),s=e.state.schema.nodes.paragraph.createAndFill();return o.insert(a.after(),s),o.setSelection(new E.TextSelection(o.doc.resolve(a.after()+1))),e.dispatch(o),!0}}}},appendTransaction:function(e,t,n){var i=n.selection,r=n.doc,o=null,a=function(){return o||(o=n.tr),o};return r.nodesBetween(0,r.nodeSize-2,(function(s,u){if("figure"!==s.type.name){if("figure_caption"===s.type.name){var l=r.resolve(u);if(0!==s.childCount)return;if(i.head>=l.start()&&i.head<=l.end())return;var c=l.start();o=R(a,r,o?o.mapping.map(c):c)||o}}else{if(2===s.childCount)return;if(a(),e[0]&&e[0].meta&&e[0].meta.paste){var d=E.NodeSelection.create(t.doc,o.mapping.map(u)).node,p=e[0].steps[0].slice.content.content[0].textContent.length,f=E.NodeSelection.create(o.doc,o.mapping.map(u)),m=n.schema.node(d.type,d.attrs,s.content.content[0].content);f.replaceWith(o,m);var h=E.TextSelection.create(o.doc,o.mapping.map(u)+p+1);return void o.setSelection(h)}o.delete(o.mapping.map(u),o.mapping.map(u+s.nodeSize))}})),o}})]}},{key:"toolbarItems",value:function(){var e=this;return this.editor.fileStorage.enabled?[new f.ToolbarItem({group:"embeds",label:(0,m.langString)("embedded_media","editor_weka"),iconComponent:I(),execute:function(t){(0,h.pickFiles)(t).then(function(){var t=(0,r.Z)(d().mark((function t(n){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n&&e._startUploading(n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})]:[]}},{key:"_startUploading",value:(B=(0,r.Z)(d().mark((function e(t){var n,i,r,o,a=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.editor.fileStorage.uploadFiles(t,this.acceptTypes);case 3:if(0!==(n=e.sent).length){e.next=6;break}return e.abrupt("return");case 6:return i=this.editor.state.schema,e.next=9,Promise.all(n.map((function(e){var t=e.filename,n=e.url,r=e.media_type,o=e.mime_type;return S.IMAGE===r?i.node("image",{filename:t,alttext:null,url:n}):S.VIDEO===r?i.node("video",{filename:t,url:n,mime_type:o,subtitle:null}):i.node("audio",{url:n,filename:t,mime_type:o,transcript:null})})));case 9:r=e.sent,this.editor.execute((function(e,t){var n=e.tr;t(n=(0,M.safeInsert)(r.length>1?C.Fragment.fromArray(r):r[0])(n)),a.editor.view.focus()})),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),e.t0 instanceof h.UploadError?(0,A.notify)({type:"error",message:e.t0.message}):(o=(0,m.langString)("error_upload_failed","editor_weka"),(0,m.loadLangStrings)([o]).then((function(){return(0,A.notify)({type:"error",message:o.toString()})})));case 17:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(e){return B.apply(this,arguments)})},{key:"_replaceImageWithAttachment",value:(N=(0,r.Z)(d().mark((function e(t,n){var i,r,o,a,s=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.filename,r=n.alttext,o=n.size,e.next=3,this._getFileInfo(i);case 3:a=e.sent,this.editor.execute((function(e,n){var u=t(),l=s.editor.state.doc.resolve(u.from),c=l.parent,d=e.tr;if(c&&c.type&&"figure"===c.type.name){var p=l.before();d=R((function(){return d}),d.doc,p)||d,u={from:p,to:p+c.nodeSize}}var f=e.schema.node("attachment",{filename:i,url:a.url,size:o,option:{alttext:r}});n(d.replaceWith(u.from,u.to,e.schema.node("attachments",null,[f])))}));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return N.apply(this,arguments)})},{key:"_replaceFigureWithImage",value:(b=(0,r.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.editor.execute((function(e,n){var i=t(),r=R((function(){return e.tr}),e.doc,i.from)||!1;r&&n(r)}));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"_replaceImageWithFigure",value:(y=(0,r.Z)(d().mark((function e(t){var n=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.editor.execute((function(e,i){var r=e.tr,o=e.doc,a=e.schema,s=t(),u=o.resolve(s.from),l=u.parent;if(l&&l.type&&"figure"===l.type.name){var c=o.nodeAt(s.from+u.nodeAfter.nodeSize);return r.setSelection(E.TextSelection.between(o.resolve(s.from+1),o.resolve(s.from+1+c.nodeSize))),i(r),void n.editor.view.focus()}var d=o.nodeAt(s.from),p=a.node("figure_caption",null,[]),f=a.node("figure",null,[d,p]);if(u.parent.canReplaceWith(u.index(),u.index()+1,f.type)){r.replaceWith(s.from,s.to,f);var m=s.from+f.nodeSize-p.nodeSize;r.setSelection(E.TextSelection.create(r.doc,m,m)),i(r.scrollIntoView()),n.editor.view.focus()}}));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"_replaceVideoWithAttachment",value:(k=(0,r.Z)(d().mark((function e(t,n){var i,r,o,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.filename,r=n.size,o=n.subtitle,e.next=3,this._getFileInfo(i);case 3:a=e.sent,this.editor.execute((function(e,n){var s=e.tr,u=t(),l={filename:i,url:a.url,size:r,option:{}};o&&(l.option.subtitle={url:o.url,filename:o.filename});var c=e.schema.node("attachment",l);n(s.replaceWith(u.from,u.to,e.schema.node("attachments",null,[c])))}));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"_updateVideoWithSubtitle",value:(v=(0,r.Z)(d().mark((function e(t,n){var i,r,o,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.filename,r=n.url,o=n.mime_type,a=n.subtitle,this.editor.execute((function(e,n){var s=e.tr,u=t(),l={filename:i,url:r,mime_type:o};l.subtitle=a?{filename:a.filename,url:a.url}:a;var c=e.schema.node("video",l);n(s.replaceWith(u.from,u.to,c))}));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"_updateImage",value:(p=(0,r.Z)(d().mark((function e(t,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.editor.execute((function(e,i){var r=e.tr,o=t().from,a=e.doc.nodeAt(o);i((0,T.setAttrs)(o,$($({},a.attrs),n))(r))}));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"_replaceAudioWithAttachment",value:(c=(0,r.Z)(d().mark((function e(t,n){var i,r,o,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.filename,r=n.size,o=n.transcript,e.next=3,this._getFileInfo(i);case 3:a=e.sent,this.editor.execute((function(e,n){var s=e.tr,u=t(),l={filename:i,url:a.url,size:r,option:{}};o&&(l.option.transcript={url:o.url,filename:o.filename});var c=e.schema.node("attachment",l);n(s.replaceWith(u.from,u.to,e.schema.node("attachments",null,[c])))}));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"_updateAudioWithTranscript",value:(i=(0,r.Z)(d().mark((function e(t,n){var i,r,o,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.filename,r=n.url,o=n.mime_type,a=n.transcript,this.editor.execute((function(e,n){var s=e.tr,u=t(),l={filename:i,url:r,mime_type:o};a&&(l.transcript={filename:a.filename,url:a.url});var c=e.schema.node("audio",l);n(s.replaceWith(u.from,u.to,c))}));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"_hasAttachmentNode",value:function(){return this.editor.hasNode("attachment")}},{key:"_hasAttachmentsNode",value:function(){return this.editor.hasNode("attachments")}},{key:"_getFileInfo",value:(n=(0,r.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.editor.fileStorage.getFileInfo(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_getDownloadUrl",value:(t=(0,r.Z)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getFileInfo(t);case 2:return n=e.sent,e.abrupt("return",n.download_url);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_getItemId",value:function(){return this.editor.fileStorage.getFileStorageItemId()}},{key:"_getContextId",value:function(){return this.editor.identifier.contextId}}]),Z}(p.default);function R(e,t,n){var i=t.resolve(n),r=i.parent;if("figure"!==r.type.name)return!1;var o=t.nodeAt(n),a=i.before(),s=t.resolve(a);return!!s.parent.canReplaceWith(s.index(),s.indexAfter(),o.type)&&e().replaceWith(a,a+r.nodeSize,o)}var P=function(e){return new j(e)}},HMgp:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var i=n("rRkQ"),r=n("IkkI"),o=n("vWPu"),a=n("F2vq"),s=n("thZj"),u=tui.require("editor_weka/components/nodes/Mention"),l=n.n(u),c=n("keTO"),d=n("5AuC");var p=function(e){(0,o.Z)(c,e);var t,n,u=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,i.Z)(this,c),u.apply(this,arguments)}return(0,r.Z)(c,[{key:"nodes",value:function(){return{mention:{schema:{group:"inline",inline:!0,attrs:{type:{default:void 0},id:{default:void 0},display:{default:""}},parseDOM:[{tag:"span.tui-wekaNodeMention",getAttrs:function(e){try{return{type:JSON.parse(e.getAttribute("data-type")),id:JSON.parse(e.getAttribute("data-id")),display:e.textContent.trim().slice(1)}}catch(e){return{}}}}],toDOM:function(e){return["span",{class:"tui-wekaNodeMention","data-type":JSON.stringify(e.attrs.type),"data-id":JSON.stringify(e.attrs.id)},"@"+e.attrs.display]}},component:l()}}}},{key:"plugins",value:function(){return[(0,d.default)(this.editor)]}}]),c}(c.default),f=function(e){return new p(e)}},"O/wH":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var i=n("rRkQ"),r=n("IkkI"),o=n("vWPu"),a=n("F2vq"),s=n("thZj"),u=n("keTO"),l=n("HXa6"),c=n("xIDV"),d=tui.require("tui/components/icons/HorizontalRule"),p=n.n(d);var f=function(e){(0,o.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function d(){return(0,i.Z)(this,d),u.apply(this,arguments)}return(0,r.Z)(d,[{key:"nodes",value:function(){return{ruler:{schema:{group:"block",parseDOM:[{tag:"hr"}],toDOM:function(){return["hr"]}}}}}},{key:"toolbarItems",value:function(){return[new l.ToolbarItem({group:"embeds",label:(0,c.langString)("horizontalrule","editor"),iconComponent:p(),execute:function(e){e.execute((function(t,n){var i=t.schema.nodes.ruler;n(t.tr.replaceSelectionWith(i.create())),e.view.focus()}))}})]}},{key:"keymap",value:function(e){var t=this.getSchema().nodes.ruler;e("Mod-_",(function(e,n){return n(e.tr.replaceSelectionWith(t.create()).scrollIntoView()),!0}))}}]),d}(u.default),m=function(e){return new f(e)}},HSer:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var i=n("rRkQ"),r=n("IkkI"),o=n("vWPu"),a=n("F2vq"),s=n("thZj"),u=n("keTO"),l=n("xIDV"),c=n("HXa6"),d=n("wQtR"),p=n("R3Ws"),f=tui.require("tui/components/icons/TextBold"),m=n.n(f),h=tui.require("tui/components/icons/TextItalic"),v=n.n(h),_=tui.require("tui/components/icons/TextUnderline"),k=n.n(_);var g=["blockquote",0],y=["em",0],w=["strong",0],b=["u",0],x=["h4","h5"],N=function(e){(0,o.Z)(f,e);var t,n,u=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function f(){return(0,i.Z)(this,f),u.apply(this,arguments)}return(0,r.Z)(f,[{key:"nodes",value:function(){return{blockquote:{schema:{group:"block",content:"block+",parseDOM:[{tag:"blockquote"}],toDOM:function(){return g}}},heading:{schema:{attrs:{level:{default:1},align:{default:void 0}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:function(e){var t=e.attrs.align,n={};return t&&(n.style="text-align: ".concat(t,";")),["h"+e.attrs.level,n,0]}},view:function(e){var t=Math.max(e.attrs.level,1)-1,n=x[t]||x[x.length-1],i=document.createElement(n);return e.attrs.align&&(i.style.textAlign=e.attrs.align),{dom:i,contentDOM:i}}},hard_break:{schema:{group:"inline",parseDOM:[{tag:"br"}],toDOM:function(){return["br"]},inline:!0,selectable:!1}}}}},{key:"marks",value:function(){return{em:{schema:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:function(){return y}}},strong:{schema:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(e){return"normal"!=e.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(e){return/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}}],toDOM:function(){return w}}},underline:{schema:{parseDOM:[{tag:"u"},{style:"text-decoration=underline"}],toDOM:function(){return b}}}}}},{key:"toolbarItems",value:function(){var e=this.getSchema().nodes,t=e.paragraph,n=e.heading,i=this.getSchema().marks,r=i.strong,o=i.em,a=i.underline;return[(0,c.blockTypeItem)(t,{ignoreAttrs:["align"]},{group:"blocks",label:(0,l.langString)("paragraph","editor")}),(0,c.blockTypeItem)(n,{attrs:{level:1},ignoreAttrs:["align"]},{group:"blocks",label:(0,l.langString)("heading","editor")}),(0,c.blockTypeItem)(n,{attrs:{level:2},ignoreAttrs:["align"]},{group:"blocks",label:(0,l.langString)("subheading","editor")}),(0,c.markItem)(r,{group:"text",label:(0,l.langString)("bold","editor"),iconComponent:m()}),(0,c.markItem)(o,{group:"text",label:(0,l.langString)("italic","editor"),iconComponent:v()}),(0,c.markItem)(a,{group:"text",label:(0,l.langString)("underline","editor"),iconComponent:k()})]}},{key:"keymap",value:function(e){var t=this.getSchema().nodes,n=t.paragraph,i=t.blockquote,r=t.heading,o=t.hard_break,a=this.getSchema().marks,s=a.strong,u=a.em,l=a.underline;e("Shift-Ctrl-0",(0,d.setBlockType)(n)),e("Ctrl->",(0,d.wrapIn)(i));for(var c=1;c<=6;c++)e("Shift-Ctrl-"+c,(0,d.setBlockType)(r,{level:c}));e("Shift-Enter",(function(e,t){return t(e.tr.replaceSelectionWith(o.create()).scrollIntoView()),!0})),e("Mod-b",(0,d.toggleMark)(s)),e("Mod-B",(0,d.toggleMark)(s)),e("Mod-i",(0,d.toggleMark)(u)),e("Mod-I",(0,d.toggleMark)(u)),e("Mod-u",(0,d.toggleMark)(l)),e("Mod-U",(0,d.toggleMark)(l))}},{key:"inputRules",value:function(){var e,t=this.getSchema().nodes,n=t.blockquote,i=t.heading;return[p.ellipsis,(e=n,(0,p.wrappingInputRule)(/^\s*>\s$/,e)),I(i,6)]}}]),f}(u.default);function I(e,t){return(0,p.textblockTypeInputRule)(new RegExp("^(#{1,"+t+"})\\s$"),e,(function(e){return{level:e[1].length}}))}var S=function(e){return new N(e)}},IlVy:function(e,t,n){"use strict";function i(e){try{return JSON.parse(e.getAttribute("data-attrs"))}catch(e){return{}}}function r(e){return function(t){var n={};return e.forEach((function(e){var i=t.getAttribute(e);n[e]=null==i?void 0:i})),n}}n.r(t),n.d(t,{attrGetter:function(){return r},getJsonAttrs:function(){return i}})},Z4hE:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var i=n("5EKS"),r=n("rRkQ"),o=n("IkkI"),a=n("eQKp"),s=n("IjKw"),u=n("dMpG"),l=n("xIDV"),c=n("KJgz"),d=n.n(c),p={start:"left",end:"right"},f={start:"right",end:"left"},m=function(){function e(t,n){(0,r.Z)(this,e),this._el=t,this._trackedEl=n.trackedEl,this._trackedElAnchor=n.trackedElAnchor,this._positionedElAnchor=n.positionedElAnchor,this._viewExtrasEl=n.viewExtrasEl,this._captured=!1,this._shown=!1,this._destroyed=!1,this._scrollableContainers=null,this._handleDOMUpdate=this._handleDOMUpdate.bind(this)}return(0,o.Z)(e,[{key:"captureNode",value:function(){if(!this._captured&&!this._destroyed){if(this._el.parentNode&&this._el.parentNode!=this._viewExtrasEl){var e=document.createComment("captured node");this._el.parentNode.insertBefore(e,this._el),this._el.prevLocationMarker=e,this._el.remove()}this._captured=!0}}},{key:"releaseNode",value:function(){this._captured&&!this._destroyed&&(this._hide(),this._el.prevLocationMarker?(this._el.prevLocationMarker.parentNode.replaceChild(this._el,this._el.prevLocationMarker),delete this._el.prevLocationMarker):this._el.remove(),this._captured=!1)}},{key:"getCaptured",value:function(){return this._captured}},{key:"setCaptured",value:function(e){e?this.captureNode():this.releaseNode()}},{key:"getVisible",value:function(){return this._shown}},{key:"setVisible",value:function(e){e?this._show():this._hide()}},{key:"_show",value:function(){if(!this._shown&&this._captured&&!this._destroyed){this._viewExtrasEl.appendChild(this._el),this._resizeOberver=new(d())(this._handleDOMUpdate),this._resizeOberver.observe(this._el),this._resizeOberver.observe(this._trackedEl),this._scrollableContainers=[];for(var e=(0,s.getClosestScrollable)(this._trackedEl);e;)this._scrollableContainers.push(e),e.addEventListener("scroll",this._handleDOMUpdate),e=(0,s.getClosestScrollable)(e.parentNode);this._shown=!0,this._handleDOMUpdate()}}},{key:"_hide",value:function(){var e=this;this._shown&&!this._destroyed&&(this._resizeOberver.disconnect(),this._resizeOberver=null,this._scrollableContainers&&(this._scrollableContainers.forEach((function(t){return t.removeEventListener("scroll",e._handleDOMUpdate)})),this._scrollableContainers=null),this._el.remove(),Object.assign(this._el.style,{left:null,top:null,width:null}),this._shown=!1)}},{key:"destroy",value:function(){this.releaseNode(),this._destroyed=!0}},{key:"_handleDOMUpdate",value:function(){this._updatePosition()}},{key:"_updatePosition",value:function(){if(this._shown)if(this._viewExtrasEl.offsetParent){var e=(0,a.getBoundingClientRect)(this._viewExtrasEl.offsetParent).getPosition(),t=(0,a.getBoundingClientRect)(this._trackedEl).sub(e),n=this._trackedElAnchor.split("-"),r=(0,i.Z)(n,2),o=r[0],s=r[1],l=new u.Point(t[this._logicalSideToPhysical(s)],t[o]),c=this._scrollableContainers.every((function(t){return(0,a.getBoundingClientRect)(t).sub(e).contains(l)}));if(this._el.style.display=c?"":"none",c){var d=(0,a.getBox)(this._el),p=this._positionedElAnchor.split("-"),f=(0,i.Z)(p,2),m=f[0],h=f[1],v=l.sub(new u.Point("right"===this._logicalSideToPhysical(h)?d.marginBox.width:0,"bottom"===m?d.marginBox.height:0));this._el.style.left=v.x+"px",this._el.style.top=v.y+"px";var _=document.documentElement.clientWidth;this._el.style.width=null,e.x+v.x+d.marginBox.width>_&&(this._el.style.width=_-(e.x+v.x))}}else this._el.style.display="none"}},{key:"_logicalSideToPhysical",value:function(e){return((0,l.isRtl)()?f:p)[e]}}]),e}()},G6bi:function(e,t,n){"use strict";function i(){return{type:"doc",content:[{type:"paragraph"}]}}n.r(t),n.d(t,{getDefaultDocument:function(){return i}})},wtEd:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var i=n("37Fk"),r=n("rRkQ"),o=n("IkkI"),a=n("KCiO"),s=n.n(a),u=n("Vulv"),l=n("NWA4"),c=n("xIDV"),d=tui.require("tui/file"),p=n("x7Rm"),f=function(){function e(t){var n=t.contextId,i=t.itemId;(0,r.Z)(this,e),this.repositoryData=null,this.files={},this.itemId=null,i&&(this.itemId=i),this.contextId=n}var t,n,a,f,m,h;return(0,o.Z)(e,[{key:"enabled",get:function(){return!!this.itemId}},{key:"updateFileItemId",value:function(e){this.itemId=e}},{key:"getContextId",value:function(){return this.contextId}},{key:"setRepositoryData",value:function(e){var t=e.repository_id,n=e.url,i=e.max_bytes;this.repositoryData||(this.repositoryData={repositoryId:t,url:n,maxBytes:parseInt(i)})}},{key:"_fetchRepositoryData",value:(h=(0,i.Z)(s().mark((function e(){var t,n,i,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.repositoryData){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,u.getRepositoryData)(this.contextId);case 4:t=e.sent,n=t.repository_id,i=t.url,r=t.max_bytes,this.setRepositoryData({repository_id:n,url:i,max_bytes:r});case 9:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"getRepositoryData",value:function(){return this.repositoryData}},{key:"getFileStorageItemId",value:function(){return this.itemId}},{key:"addFile",value:function(){console.warn("[editor_weka] FileStorage.addFile had been deprecated and no longer used.")}},{key:"getFile",value:(m=(0,i.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("[editor_weka] FileStorage.getFile had been deprecated ","please use FileStorage.getFileInfo instead"),e.abrupt("return",null);case 2:case"end":return e.stop()}}),e)}))),function(){return m.apply(this,arguments)})},{key:"uploadFile",value:(f=(0,i.Z)(s().mark((function e(t,n){var i,r,o,a,u,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchRepositoryData();case 2:return i=this.repositoryData,r=i.repositoryId,o=i.url,e.next=5,(0,l.upload)({file:t,itemId:this.itemId,contextId:this.contextId,acceptTypes:n,repositoryId:r,url:o});case 5:if(!(a=e.sent).id||!a.file){e.next=12;break}return e.next=9,this.getFileInfo(a.file);case 9:case 16:return e.abrupt("return",e.sent);case 12:if("fileexists"!==a.event){e.next=17;break}return u=a.newfile.filename,e.next=16,this.getFileInfo(u);case 17:return d=(0,c.langString)("invalid_response","editor_weka"),e.next=20,(0,c.loadLangStrings)([d]);case 20:throw new Error(d.toString());case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"uploadFiles",value:(a=(0,i.Z)(s().mark((function e(t,n){var i,r,o=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=(0,l.parseFiles)(t)).length){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,this.checkFilesSizeExceed(t);case 5:if(!e.sent){e.next=15;break}return e.next=8,(0,d.getReadableSize)(this.repositoryData.maxBytes);case 8:return i=e.sent,r=(0,c.langString)("file_size_exceed","editor_weka",i),e.next=12,(0,c.loadLangStrings)([r]);case 12:return e.next=14,(0,p.notify)({type:"error",message:r.toString()});case 14:return e.abrupt("return",[]);case 15:return e.abrupt("return",Promise.all(t.map((function(e){return o.uploadFile(e,n)}))));case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"checkFilesSizeExceed",value:(n=(0,i.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchRepositoryData();case 2:if(this.repositoryData.maxBytes){e.next=4;break}return e.abrupt("return",!0);case 4:return n=this.repositoryData.maxBytes,e.abrupt("return",t.some((function(e){return e.size>n})));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getFileInfo",value:(t=(0,i.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.getDraftFile)({itemId:this.itemId,filename:t}));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}()},"/VMM":function(e,t,n){"use strict";n.r(t),n.d(t,{AUDIO:function(){return o},IMAGE:function(){return i},VIDEO:function(){return r}});var i="IMAGE",r="VIDEO",o="AUDIO"},Y3Em:function(e,t,n){"use strict";n.r(t),n.d(t,{createMentionContent:function(){return r}});var i=tui.require("editor_weka/helpers/editor");function r(e){var t=e.fullname,n=e.userId,r=(0,i.getDefaultDocument)();return r.content[0]={type:"paragraph",content:[{type:"mention",attrs:{id:n,display:t}},{type:"text",text:" "}]},r}},kKM0:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var i=n("37Fk"),r=n("rRkQ"),o=n("IkkI"),a=n("KCiO"),s=n.n(a),u=n("51FK"),l=n("Aely"),c=n.n(l),d=n("IjKw"),p=tui.require("tui/lib/popover"),f=n("dMpG"),m=n("eQKp"),h=n("KJgz"),v=n.n(h),_=n("xIDV"),k=tui.require("tui/i18n_vue_plugin"),g=function(){function e(t){(0,r.Z)(this,e),this._instance=null,this._editor=t,this._updatePosition=this._updatePosition.bind(this)}var t;return(0,o.Z)(e,[{key:"matcher",value:function(e,t){if(!(t&&t instanceof u.ResolvedPos))return null;var n=t.doc.textBetween(t.start(),t.pos,"\n","\0");if(""===n)return null;var i=e.exec(n);if(!i)return null;var r=i.index+t.start();return{range:{from:r,to:r+i[0].length},text:i[0]}}},{key:"destroyInstance",value:function(){var e=this;this._scrollableContainers&&(this._scrollableContainers.forEach((function(t){return t.removeEventListener("scroll",e._updatePosition)})),this._scrollableContainers=null),window.removeEventListener("resize",this._updatePosition),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),null!==this._instance&&(this._instance.$destroy(),document.body.removeChild(this._instance.$el),this._instance=null)}},{key:"resetComponent",value:function(){return console.warn("[editor_weka] The function Suggestion.resetComponent() had been deprecated, ","please do not use"),{apply:!1,text:"",from:0,to:0}}},{key:"showList",value:(t=(0,i.Z)(s().mark((function e(t){var n,i,r,o,a,u,l,p,f=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.view,i=t.component,r=t.state,o=r.range,a=r.text,t.callback&&console.warn("[editor_weka] The fourth parameter of function Suggestion.showList(), ","had been deprecated, and no longer used"),null!==this._instance&&this.destroyInstance(),e.next=5,(0,_.loadStrings)((0,k.collectStrings)(i.component));case 5:for(u=document.createElement("span"),document.body.appendChild(u),this._view=n,this._range=o,this._location=c().observable(this._getLocation()),l=i.props?Object.assign({},i.props,{location:this._location}):void 0,this._instance=new(c().extend(i.component))({parent:this._editor.getParent(),propsData:l||{location:this._location,pattern:a,area:this._editor.identifier.area||void 0,contextId:this._editor.identifier.contextId||void 0,component:this._editor.identifier.component||void 0,instanceId:this._editor.identifier.instanceId||void 0}}),this._instance.$mount(u),this._scrollableContainers=[],p=(0,d.getClosestScrollable)(this._editor.viewExtrasLiveEl);p;)this._scrollableContainers.push(p),p.addEventListener("scroll",this._updatePosition),p=(0,d.getClosestScrollable)(p.parentNode);this._scrollableContainers.push(document),document.addEventListener("scroll",this._updatePosition),window.addEventListener("resize",this._updatePosition),this._resizeObserver=new(v())(this._updatePosition),this._resizeObserver.observe(this._instance.$el),this._instance.$on("item-selected",(function(e){var t=e.id,r=e.text;f.destroyInstance();var a=f.getNode(n.state,i.name,i.attrs(t,r));f.convertToNode(o,a)})),this._instance.$on("dismiss",(function(){f.destroyInstance(),f._editor.view.focus()})),c().nextTick(this._updatePosition);case 24:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_updatePosition",value:function(){Object.assign(this._location,this._getLocation())}},{key:"_getLocation",value:function(){var e=document.documentElement,t=(0,m.getBoundingClientRect)(document.body),n=this._view.coordsAtPos(this._range.from),i=f.Rect.fromPositions({left:n.left,top:n.top,right:n.right+1,bottom:n.bottom}).sub(t.getPosition()),r=new f.Rect(0,0,e.clientWidth,e.clientHeight).sub(t.getPosition()),o=(0,p.position)({position:["bottom","left"],ref:i,viewport:r,size:this._instance?new f.Size(this._instance.$el.offsetWidth,this._instance.$el.offsetHeight):new f.Size(50,50),padding:0});return{x:o.location.x,y:o.location.y}}},{key:"getNode",value:function(e,t,n){return e.schema.node(t,n)}},{key:"convertToNode",value:function(e,t){var n=this;this._editor.execute((function(i,r){r(n.createTransaction(i,e,t)),n._editor.view.focus()}))}},{key:"createTransaction",value:function(e,t,n){var i=e.tr;return i.replaceWith(t.from,t.to,n)}},{key:"apply",value:function(e,t,n,i){i&&console.warn("[editor_weka] The fourth parameter of function Suggestion.apply() had been deprecated ","and no longer needed. Please update all calls");var r=e.selection,o=Object.assign({},t);if(r.from===r.to){var a=this.matcher(n,r.$from);if(a)return o.active=!0,o.range=a.range,o.text=a.text,o}return o.active=!1,o.range={},o.text=null,o}}]),e}()},pwZ9:function(e,t,n){"use strict";n.r(t),n.d(t,{setupTextarea:function(){return d}});var i=n("rRkQ"),r=n("IkkI"),o=n("7mX8"),a=n.n(o),s=n("U0bO"),u=n("x4c5"),l=n.n(u),c=n("y7sX");function d(e){var t=e.id,n=e.extensions,i=e.showtoolbar,r=e.file_item_id,o=e.context_id,a=e.files,s=document.getElementById(t);if(!s){var u=new Error("Textarea not found");throw u.code="TEXTAREA_NOT_FOUND",u}new p(t,s,{extensions:n,showtoolbar:i,context_id:o,files:a,file_item_id:r})}var p=function(){function e(t,n,r){var o=this;(0,i.Z)(this,e),this.id=t,this.textareaEl=n,n.style.display="none",n.setAttribute("data-enhanced",!0),this.wrapper=document.createElement("div");var u=document.createElement("div");this.wrapper.appendChild(u),this.textareaEl.parentNode.insertBefore(this.wrapper,this.textareaEl.nextSibling);var c=this.getWekaValue();this.wekaValue=c;var d=function(){if(o.wekaValue){var e=(0,s.createNewEvent)("change");o.textareaEl.value=JSON.stringify(o.wekaValue.getDoc()),o.textareaEl.dispatchEvent(e)}},p=(0,s.throttle)(d,250);a().mount(l(),{props:{variant:"full",value:c,options:r,fileItemId:r.file_item_id?r.file_item_id:void 0},on:{input:function(e){o.wekaValue=e,p()},blur:d,ready:function(){o.wekaValue.hasHtml()&&d()}}},u)}return(0,r.Z)(e,[{key:"getWekaValue",value:function(){var e=this.textareaEl.value;if(e){if(!this.looksLikeJson(e))return c.default.fromHtml(e);try{var t=JSON.parse(e);return c.default.fromDoc(t)}catch(e){console.error("[editor_weka] Error parsing JSON"),console.error(e)}}return c.default.empty()}},{key:"looksLikeJson",value:function(e){return"{"===e.slice(0,1)&&"}"===e.slice(e.length-1)}}]),e}()},IlmE:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var i=tui.require("tui/editor"),r=n("x4c5"),o=n.n(r),a=n("y7sX"),s={getComponent:function(){return o()},getProps:function(e){var t=e.contextId,n=e.config,i=e.fileItemId,r=e.placeholder,o=e.compact,a=e.usageIdentifer,s=e.extraExtensions,u=e.disabled,l=e.ariaLabel,c=e.ariaLabelledby,d=e.ariaDescribedby,p=e.ariaInvalid,f=e.stickyToolbar;return{fileItemId:i,usageIdentifer:a,extraExtensions:s,options:{context_id:t,extensions:n.extensions,files:null,repository_data:null,showtoolbar:n.showtoolbar},placeholder:r,compact:o,disabled:u,ariaLabel:l,ariaLabelledby:c,ariaDescribedby:d,ariaInvalid:p,stickyToolbar:f}},rawToValue:function(e){if(!e)return a.default.empty();try{return a.default.fromDoc(JSON.parse(e))}catch(t){return console.error("Failed to parse Weka document"),console.log(e),console.error(t),a.default.empty()}},valueToRaw:function(e){return JSON.stringify(e.getDoc())},isContentEmpty:function(e){return e.isEmpty},getValueFormat:function(){return i.Format.JSON_EDITOR},getPreferredFormat:function(){return i.Format.JSON_EDITOR},forceRecreate:!0,supportsFormat:function(e){return i.Format.JSON_EDITOR===e}}},"X/Xy":function(e,t,n){"use strict";function i(e,t){t[e.type]&&t[e.type](e),t.any&&t.any(e),Array.isArray(e.content)&&e.content.forEach((function(e){return i(e,t)}))}n.d(t,{X:function(){return i}})},aTpb:function(e,t,n){"use strict";n.r(t),n.d(t,{buildKeymap:function(){return s}});var i=n("wQtR"),r=n("sqie"),o=n("R3Ws"),a="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function s(e,t){var n={};function s(e,t){n[e]=t}s("Mod-z",r.undo),s("Shift-Mod-z",r.redo),s("Backspace",o.undoInputRule),a||s("Mod-y",r.redo),s("Alt-ArrowUp",i.joinUp),s("Alt-ArrowDown",i.joinDown),s("Mod-BracketLeft",i.lift),s("Escape",i.selectParentNode);var u={schema:e,isMac:a};return t.forEach((function(e){e(s,u)})),n}},fLDo:function(e,t,n){"use strict";n.r(t),n.d(t,{liftListItem:function(){return s},sinkListItem:function(){return u},splitListItem:function(){return a},wrapInList:function(){return o}});var i=n("lqu/"),r=n("51FK");function o(e,t){return function(n,o){var a=n.selection,s=a.$from,u=a.$to,l=s.blockRange(u),c=!1,d=l;if(!l)return!1;if(l.depth>=2&&s.node(l.depth-1).type.compatibleContent(e)&&0==l.startIndex){if(0==s.index(l.depth-1))return!1;var p=n.doc.resolve(l.start-2);d=new r.NodeRange(p,p,l.depth),l.endIndex<l.parent.childCount&&(l=new r.NodeRange(s,n.doc.resolve(u.end(l.depth)),l.depth)),c=!0}var f=(0,i.findWrapping)(d,e,t,l);return!!f&&(o&&o(function(e,t,n,o,a){for(var s=r.Fragment.empty,u=n.length-1;u>=0;u--)s=r.Fragment.from(n[u].type.create(n[u].attrs,s));e.step(new i.ReplaceAroundStep(t.start-(o?2:0),t.end,t.start,t.end,new r.Slice(s,0,0),n.length,!0));for(var l=0,c=0;c<n.length;c++)n[c].type==a&&(l=c+1);for(var d=n.length-l,p=t.start+n.length-(o?2:0),f=t.parent,m=t.startIndex,h=t.endIndex,v=!0;m<h;m++,v=!1)!v&&(0,i.canSplit)(e.doc,p,d)&&(e.split(p,d),p+=2*d),p+=f.child(m).nodeSize;return e}(n.tr,l,f,c,e).scrollIntoView()),!0)}}function a(e){return function(t,n){var o=t.selection,a=o.$from,s=o.$to,u=o.node;if(u&&u.isBlock||a.depth<2||!a.sameParent(s))return!1;var l=a.node(-1);if(l.type!=e)return!1;if(0==a.parent.content.size){if(2==a.depth||a.node(-3).type!=e||a.index(-2)!=a.node(-2).childCount-1)return!1;if(n){for(var c=r.Fragment.empty,d=a.index(-1)>0,p=a.depth-(d?1:2);p>=a.depth-3;p--)c=r.Fragment.from(a.node(p).copy(c));c=c.append(r.Fragment.from(e.createAndFill()));var f=t.tr.replace(a.before(d?null:-1),a.after(-3),new r.Slice(c,d?3:2,2));f.setSelection(t.selection.constructor.near(f.doc.resolve(a.pos+(d?3:2)))),n(f.scrollIntoView())}return!0}var m=s.pos==a.end()?l.contentMatchAt(0).defaultType:null,h=t.tr.delete(a.pos,s.pos),v=m&&[null,{type:m}];return!!(0,i.canSplit)(h.doc,a.pos,2,v)&&(n&&n(h.split(a.pos,2,v).scrollIntoView()),!0)}}function s(e){return function(t,n){var o=t.selection,a=o.$from,s=o.$to,u=a.blockRange(s,(function(t){return t.childCount&&t.firstChild.type==e}));return!!u&&(!n||(a.node(u.depth-1).type==e?function(e,t,n,o){var a=e.tr,s=o.end,u=o.$to.end(o.depth);return s<u&&(a.step(new i.ReplaceAroundStep(s-1,u,s,u,new r.Slice(r.Fragment.from(n.create(null,o.parent.copy())),1,0),1,!0)),o=new r.NodeRange(a.doc.resolve(o.$from.pos),a.doc.resolve(u),o.depth)),t(a.lift(o,(0,i.liftTarget)(o)).scrollIntoView()),!0}(t,n,e,u):function(e,t,n){for(var o=e.tr,a=n.parent,s=n.end,u=n.endIndex-1,l=n.startIndex;u>l;u--)s-=a.child(u).nodeSize,o.delete(s-1,s+1);var c=o.doc.resolve(n.start),d=c.nodeAfter,p=0==n.startIndex,f=n.endIndex==a.childCount,m=c.node(-1),h=c.index(-1);if(!m.canReplace(h+(p?0:1),h+1,d.content.append(f?r.Fragment.empty:r.Fragment.from(a))))return!1;var v=c.pos,_=v+d.nodeSize;return o.step(new i.ReplaceAroundStep(v-(p?1:0),_+(f?1:0),v+1,_-1,new r.Slice((p?r.Fragment.empty:r.Fragment.from(a.copy(r.Fragment.empty))).append(f?r.Fragment.empty:r.Fragment.from(a.copy(r.Fragment.empty))),p?0:1,f?0:1),p?0:1)),t(o.scrollIntoView()),!0}(t,n,u)))}}function u(e){return function(t,n){var o=t.selection,a=o.$from,s=o.$to,u=a.blockRange(s,(function(t){return t.childCount&&t.firstChild.type==e}));if(!u)return!1;var l=u.startIndex;if(0==l)return!1;var c=u.parent,d=c.child(l-1);if(d.type!=e)return!1;if(n){var p=d.lastChild&&d.lastChild.type==c.type,f=r.Fragment.from(p?e.create():null),m=new r.Slice(r.Fragment.from(e.create(null,r.Fragment.from(c.type.create(null,f)))),p?3:1,0),h=u.start,v=u.end;n(t.tr.step(new i.ReplaceAroundStep(h-(p?3:1),v,h,v,m,1,!0)).scrollIntoView())}return!0}}},BEWS:function(e,t,n){"use strict";n.r(t),n.d(t,{canInsert:function(){return m},canReplace:function(){return d},checkInvalidMovements:function(){return g},cloneTr:function(){return l},createCell:function(){return _},equalNodeType:function(){return u},findTableClosestToPos:function(){return v},isEmptyParagraph:function(){return h},isNodeSelection:function(){return s},removeNodeAtPos:function(){return p},replaceNodeAtPos:function(){return c},tableNodeTypes:function(){return f},transpose:function(){return k}});var i=n("Xz/0"),r=n("51FK"),o=n("RB/O"),a=n("2l2b"),s=function(e){return e instanceof i.NodeSelection},u=function(e,t){return Array.isArray(e)&&e.indexOf(t.type)>-1||t.type===e},l=function(e){return Object.assign(Object.create(e),e).setTime(Date.now())},c=function(e,t){return function(n){var i=n.doc.nodeAt(e),r=n.doc.resolve(e);if(d(r,t)){var a=(n=n.replaceWith(e,e+i.nodeSize,t)).selection.$from.pos-1;return n=(0,o.setTextSelection)(Math.max(a,0),-1)(n),n=(0,o.setTextSelection)(n.selection.$from.start())(n),l(n)}return n}},d=function(e,t){var n=e.node(e.depth);return n&&n.type.validContent(t instanceof r.Fragment?t:r.Fragment.from(t))},p=function(e){return function(t){var n=t.doc.nodeAt(e);return l(t.delete(e,e+n.nodeSize))}},f=function(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;var t={};return Object.keys(e.nodes).forEach((function(n){var i=e.nodes[n];i.spec.tableRole&&(t[i.spec.tableRole]=i)})),e.cached.tableNodeTypes=t,t},m=function(e,t){var n=e.index();return t instanceof r.Fragment?e.parent.canReplace(n,n,t):t instanceof r.Node&&e.parent.canReplaceWith(n,n,t.type)},h=function(e){return!e||"paragraph"===e.type.name&&2===e.nodeSize},v=function(e){return(0,a.findParentNodeClosestToPos)(e,(function(e){return e.type.spec.tableRole&&/table/i.test(e.type.spec.tableRole)}))},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.createChecked(null,t):e.createAndFill()},k=function(e){return e[0].map((function(t,n){return e.map((function(e){return e[n]}))}))},g=function(e,t,n,i){var r=e>t?-1:1,o="Target position is invalid, you can't move the ".concat(i," ").concat(e," to ").concat(t,", the target can't be split. You could use tryToFit option.");if(1===r){if(-1!==n.slice(0,n.length-1).indexOf(t))throw new Error(o)}else if(-1!==n.slice(1).indexOf(t))throw new Error(o);return!0}},"2l2b":function(e,t,n){"use strict";n.r(t),n.d(t,{findDomRefAtPos:function(){return h},findParentDomRef:function(){return s},findParentDomRefOfType:function(){return p},findParentNode:function(){return o},findParentNodeClosestToPos:function(){return a},findParentNodeOfType:function(){return l},findParentNodeOfTypeClosestToPos:function(){return c},findPositionOfNodeBefore:function(){return m},findSelectedNodeOfType:function(){return f},hasParentNode:function(){return u},hasParentNodeOfType:function(){return d}});var i=n("Xz/0"),r=n("BEWS"),o=function(e){return function(t){var n=t.$from;return a(n,e)}},a=function(e,t){for(var n=e.depth;n>0;n--){var i=e.node(n);if(t(i))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:i}}},s=function(e,t){return function(n){var i=o(e)(n);if(i)return h(i.pos,t)}},u=function(e){return function(t){return!!o(e)(t)}},l=function(e){return function(t){return o((function(t){return(0,r.equalNodeType)(e,t)}))(t)}},c=function(e,t){return a(e,(function(e){return(0,r.equalNodeType)(t,e)}))},d=function(e){return function(t){return u((function(t){return(0,r.equalNodeType)(e,t)}))(t)}},p=function(e,t){return function(n){return s((function(t){return(0,r.equalNodeType)(e,t)}),t)(n)}},f=function(e){return function(t){if((0,r.isNodeSelection)(t)){var n=t.node,i=t.$from;if((0,r.equalNodeType)(e,n))return{node:n,pos:i.pos,depth:i.depth}}}},m=function(e){var t=e.$from.nodeBefore,n=i.Selection.findFrom(e.$from,-1);if(n&&t){var r=l(t.type)(n);return r?r.pos:n.$from.pos}},h=function(e,t){var n=t(e),i=n.node.childNodes[n.offset];return n.node.nodeType===Node.TEXT_NODE?n.node.parentNode:i&&i.nodeType!==Node.TEXT_NODE?i:n.node}},"RB/O":function(e,t,n){"use strict";n.r(t),n.d(t,{removeNodeBefore:function(){return k},removeParentNodeOfType:function(){return u},removeSelectedNode:function(){return c},replaceParentNodeOfType:function(){return l},replaceSelectedNode:function(){return d},safeInsert:function(){return h},selectParentNodeOfType:function(){return _},setParentNodeMarkup:function(){return v},setTextSelection:function(){return p}});var i=n("Xz/0"),r=n("51FK"),o=n("2l2b"),a=n("BEWS"),s=n("ASUJ"),u=function(e){return function(t){var n=(0,o.findParentNodeOfType)(e)(t.selection);return n?(0,a.removeNodeAtPos)(n.pos)(t):t}},l=function(e,t){return function(n){Array.isArray(e)||(e=[e]);for(var i=0,r=e.length;i<r;i++){var s=(0,o.findParentNodeOfType)(e[i])(n.selection);if(s){var u=(0,a.replaceNodeAtPos)(s.pos,t)(n);if(u!==n)return u}}return n}},c=function(e){if((0,a.isNodeSelection)(e.selection)){var t=e.selection.$from.pos,n=e.selection.$to.pos;return(0,a.cloneTr)(e.delete(t,n))}return e},d=function(e){return function(t){if((0,a.isNodeSelection)(t.selection)){var n=t.selection,o=n.$from,s=n.$to;if(e instanceof r.Fragment&&o.parent.canReplace(o.index(),o.indexAfter(),e)||o.parent.canReplaceWith(o.index(),o.indexAfter(),e.type))return(0,a.cloneTr)(t.replaceWith(o.pos,s.pos,e).setSelection(new i.NodeSelection(t.doc.resolve(o.pos))))}return t}},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(n){var r=i.Selection.findFrom(n.doc.resolve(e),t,!0);return r?n.setSelection(r):n}},f=function(e){return e.type&&e.type.spec.selectable},m=function(e,t,n){return function(e){return f(e)&&e.type.isLeaf}(e)?n.setSelection(new i.NodeSelection(n.doc.resolve(t))):p(t)(n)},h=function(e,t,n){return function(i){var r="number"==typeof t,o=i.selection.$from,u=r?i.doc.resolve(t):(0,a.isNodeSelection)(i.selection)?i.doc.resolve(o.pos+1):o,c=u.parent;if((0,a.isNodeSelection)(i.selection)&&n&&i!==(i=d(e)(i)))return i;if((0,a.isEmptyParagraph)(c)&&i!==(i=l(c.type,e)(i))){var p=f(e)?u.before(u.depth):u.pos;return m(e,p,i)}if((0,a.canInsert)(u,e)){i.insert(u.pos,e);var h=(0,s.getInsertedPos)(i);return(0,a.cloneTr)(m(e,h,i))}for(var v=u.depth;v>0;v--){var _=u.after(v),k=i.doc.resolve(_);if((0,a.canInsert)(k,e))return i.insert(_,e),(0,a.cloneTr)(m(e,_,i))}return i}},v=function(e,t,n,i){return function(r){var s=(0,o.findParentNodeOfType)(e)(r.selection);return s?(0,a.cloneTr)(r.setNodeMarkup(s.pos,t,Object.assign({},s.node.attrs,n),i)):r}},_=function(e){return function(t){if(!(0,a.isNodeSelection)(t.selection)){var n=(0,o.findParentNodeOfType)(e)(t.selection);if(n)return(0,a.cloneTr)(t.setSelection(i.NodeSelection.create(t.doc,n.pos)))}return t}},k=function(e){var t=(0,o.findPositionOfNodeBefore)(e.selection);return"number"==typeof t?(0,a.removeNodeAtPos)(t)(e):e}},BjMn:function(e,t,n){"use strict";n.r(t),t.default={props:{filename:{type:String,required:!0},fileSize:{type:[String,Number],required:!0},draftId:{type:[String,Number],required:!0},hasDownloadUrl:Boolean,disabled:Boolean}}},h5d1:function(e,t,n){"use strict";n.r(t),n.d(t,{attachment:function(){return a},pluginKey:function(){return o}});var i=n("Xz/0"),r=Object.prototype.hasOwnProperty,o=new i.PluginKey("attachment");function a(e){var t=function(e){var t={};return["onDrop","onKeyDown"].forEach((function(n){r.call(e,n)&&"function"==typeof e[n]?t[n]=e[n]:t[n]=function(){return!1}})),t}(e),n=t.onDrop,a=t.onKeyDown;return new i.Plugin({key:o,state:{init:function(){return{}},apply:function(){return{}}},props:{handleDOMEvents:{drop:function(e,t){return n({view:e,event:t})}},handleKeyDown:function(e,t){return a({view:e,event:t})}}})}},EUlj:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var i=n("Xz/0");function r(e){for(var t=[];e;)t.push(e),e=e.parent;return t}function o(){var e=new i.PluginKey("cursor-inside-node");return new i.Plugin({key:e,state:{init:function(){return 0},apply:function(e,t){return t+1}},view:function(){return{update:function(t,n){var i=r(t.domAtPos(n.selection.head).node.pmViewDesc),o=r(t.domAtPos(t.state.selection.head).node.pmViewDesc);1===e.getState(t.state)?o.forEach((function(e){e.spec&&e.spec.setCursorInside&&e.spec.setCursorInside(!0)})):(i.forEach((function(e){!o.includes(e)&&e.spec&&e.spec.setCursorInside&&e.spec.setCursorInside(!1)})),o.forEach((function(e){!i.includes(e)&&e.spec&&e.spec.setCursorInside&&e.spec.setCursorInside(!0)})))}}}})}},EJ04:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var i=n("Xz/0"),r=n("51FK");function o(e,t,n){var o=new i.PluginKey("emojis"),a=!1;return new i.Plugin({key:o,appendTransaction:function(e,t,n){var i=o.getState(n),r=i.text,a=i.active,s=i.range,u=i.emoji;if(!r||!a)return null;var l=n.schema.node("emoji",{id:u.id,shortcode:u.shortcode});return n.tr.replaceWith(s.from,s.to,l)},state:{init:function(){return{active:!1,range:{},text:null}},apply:function(e,n){var i=e.selection,o=Object.assign({},n);if(o.active=!1,!a)return o;if(i.from===i.to){var s=function(e,t){if(!(e&&e instanceof r.ResolvedPos))return null;var n,i,o=e.doc.textBetween(e.start(),e.end(),"\0","\0");if(""===o)return null;if(!t)return null;for(var a=0;a<t.length;++a){var s=t[a];if(""!==s.pattern)for(i=new RegExp(s.pattern,"g");n=i.exec(o);){var u=n.input.slice(Math.max(0,n.index-1),n.index);if(/^[\s\0]?$/.test(u)){var l=n.index+e.start(),c=l+n[0].length;if(l<e.pos&&c>=e.pos)return{range:{from:l,to:c},text:n[0],emoji:s}}}}return null}(i.$from,t);s&&(o.active=!0,o.range=s.range,o.text=s.text,o.emoji=s.emoji)}return o.active||(o.range={},o.text=null),o}},props:{handleKeyDown:function(e,t){a=n.find((function(e){return e===t.key}))}}})}},dUEx:function(e,t,n){"use strict";n.r(t),n.d(t,{REGEX:function(){return d},default:function(){return p}});var i=n("37Fk"),r=n("KCiO"),o=n.n(r),a=n("Xz/0"),s=tui.require("editor_weka/components/suggestion/Hashtag"),u=n.n(s),l=n("kKM0"),c=n("U0bO"),d=new RegExp("#[^#\\s]+$","g");function p(e){var t=new a.PluginKey("hashtags"),n=new l.default(e);return new a.Plugin({key:t,view:function(){var e=this;return{update:(0,c.debounce)(function(){var t=(0,i.Z)(o().mark((function t(i){var r,a,s,l;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.key.getState(i.state),a=r.text,s=r.active,l=r.range,n.destroyInstance(),a&&s){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,n.showList({view:i,component:{name:"hashtag",component:u(),attrs:function(e,t){return{text:t}}},state:{text:a.slice(1),active:s,range:l}});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),500)}},state:{init:function(){return{active:!1,range:{},text:null}},apply:function(e,t){return d.lastIndex=0,n.apply(e,t,d)}},props:{handleKeyDown:function(t,n){var i=this.getState(t.state),r=i.active,o=i.text,a=i.range;return!!r&&([" ","Tab","Enter","PageUp","PageDown","Home","End","Escape","Spacebar","Esc"].includes(n.key)&&e.execute((function(e,t){return t(e.tr.replaceWith(a.from,a.to,e.schema.node("hashtag",{text:o.slice(1)}))),n.stopPropagation(),!0})),!1)},handleClick:function(t){var n=this.getState(t.state),i=n.active,r=n.text,o=n.range;return!!i&&(e.execute((function(e,t){var n=e.schema.node("hashtag",{text:r.slice(1)});t(e.tr.replaceWith(o.from,o.to,n))})),!0)}}})}},"5AuC":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var i=n("U0bO"),r=n("Xz/0"),o=n("kKM0"),a=tui.require("editor_weka/components/suggestion/User"),s=n.n(a);function u(e){var t=new r.PluginKey("mentions"),n=new o.default(e),a=new RegExp("@[^@\\s]+$","g");return new r.Plugin({key:t,view:function(){var e=this;return{update:(0,i.debounce)((function(t){var i=e.key.getState(t.state),r=i.text,o=i.active,a=i.range;n.destroyInstance(),r&&o&&n.showList({view:t,component:{name:"mention",component:s(),attrs:function(e,t){return{id:e,display:t}}},state:{text:r.slice(1),active:o,range:a}})}),250)}},state:{init:function(){return{active:!1,range:{},text:null}},apply:function(e,t){return a.lastIndex=0,n.apply(e,t,a)}},props:{handleKeyDown:function(e,t){if("Escape"===t.key||"Esc"===t.key)return!!this.getState(e.state).active&&(n.destroyInstance(),e.focus(),t.stopPropagation(),!0)}}})}},W3oP:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var i=n("Xz/0"),r=n("QxjF");function o(e){return new i.Plugin({key:new i.PluginKey("text-placeholder"),props:{decorations:function(t){var n=t.doc;if(!e)return!1;if(1!==n.childCount||!n.firstChild.isTextblock)return!1;var i=[];return n.descendants((function(t,n){return t.type.isBlock&&0==t.childCount&&i.push(r.Decoration.node(n,n+t.nodeSize,{class:"tui-weka__placeholder","data-placeholder":e})),!0})),r.DecorationSet.create(n,i)}}})}},"+89I":function(e,t,n){"use strict";n.r(t),n.d(t,{createSchema:function(){return l}});var i=n("cXde"),r=n("51FK");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s={paragraph:{group:"block",content:"inline*",attrs:{align:{default:void 0}},parseDOM:[{tag:"p"}],toDOM:function(e){var t=e.attrs.align,n={};return t&&(n.style="text-align: ".concat(t,";")),["p",n,0]}},text:{group:"inline"},unknown_block:{group:"block",toDOM:function(){return["div",{class:"tui-editor_weka-unknownBlock"}]},attrs:{type:{},attrs:{default:void 0},content:{default:void 0}}},unknown_inline:{group:"inline",inline:!0,toDOM:function(){return["span",{class:"tui-editor_weka-unknownInline"}]},attrs:{type:{},attrs:{default:void 0},content:{default:void 0}}}},u={unknown:{attrs:{type:{},attrs:{default:void 0}},toDOM:function(){return["span",0]},inclusive:!1}};function l(e){var t=e.nodes,n=e.marks,i=Object.values(t).some((function(e){return"rootblock"===e.group}));return new r.Schema({nodes:a(a({doc:{content:"(paragraph | block"+(i?" | rootblock":"")+")+"}},s),t),marks:a(a({},u),n)})}},HXa6:function(e,t,n){"use strict";n.r(t),n.d(t,{ToolbarItem:function(){return a},blockTypeItem:function(){return l},cmdItem:function(){return s},markItem:function(){return u}});var i=n("rRkQ"),r=n("IkkI"),o=n("wQtR"),a=function(){function e(t){var n=this;(0,i.Z)(this,e),this._opts=t,this._editor=null,this._def={type:t.type,group:t.group,label:t.label,iconComponent:t.iconComponent,enabled:!0,active:null,children:t.children&&t.children.map((function(e){return e.getDef()})),popover:t.popover,execute:function(){return t.execute(n._editor)},reset:function(){return t.reset(n._editor)}}}return(0,r.Z)(e,[{key:"update",value:function(e){var t=this._def,n=this._opts;return this._editor=e,this._editor.view.editable?t.enabled=void 0===n.enabled||n.enabled(e):t.enabled=!1,t.iconComponent=void 0!==n.getIconComponent?n.getIconComponent(e):t.iconComponent,t.active=null!=n.active?n.active(e):null,n.children&&n.children.forEach((function(t){return t.update(e)})),Object.assign({},t)}},{key:"getDef",value:function(){return this._def}}]),e}();function s(e,t){return new a(Object.assign({enabled:function(t){return t.canExecute(e)},execute:function(t){t.view.focus(),t.execute(e)}},t))}function u(e,t){return t=Object.assign({active:function(t){return n=t.state,i=e,o=(r=n.selection).from,a=r.$from,s=r.to,r.empty?!!i.isInSet(n.storedMarks||a.marks()):!!n.doc.rangeHasMark(o,s,i);var n,i,r,o,a,s}},t),s((0,o.toggleMark)(e),t)}function l(e,t,n){return n=Object.assign({active:function(n){var i=n.state.selection,r=i.$from,o=i.to,a=i.node,s=r.parent;return t.ignoreAttrs&&t.ignoreAttrs.forEach((function(e){a&&!(e in a.attrs)||e in s.attrs&&(t.attrs||(t.attrs={}),t.attrs[e]=a?a.attrs[e]:s.attrs[e])})),a&&a.isTextblock?a.hasMarkup(e,t.attrs):o<=r.end()&&s.hasMarkup(e,t.attrs)}},n),s((0,o.setBlockType)(e,t.attrs),n)}},"1ahB":function(e,t,n){"use strict";n.r(t),n.d(t,{SetAttrsStep:function(){return d},setAttrs:function(){return p}});var i=n("GggH"),r=n("rRkQ"),o=n("IkkI"),a=n("vWPu"),s=n("F2vq"),u=n("thZj"),l=n("51FK"),c=n("lqu/");var d=function(e){(0,a.Z)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var r=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function p(e,t){var n;return(0,r.Z)(this,p),(n=d.call(this)).pos=e,n.attrs=t,n}return(0,o.Z)(p,[{key:"apply",value:function(e){var t=e.nodeAt(this.pos);if(!t)return c.StepResult.fail("No node at given position");var n=t.type.create(this.attrs,l.Fragment.empty,t.marks),i=new l.Slice(l.Fragment.from(n),0,t.isLeaf?0:1);return c.StepResult.fromReplace(e,this.pos,this.pos+t.nodeSize,i)}},{key:"invert",value:function(e){var t=e.nodeAt(this.pos);return new p(this.pos,t?t.attrs:null)}},{key:"map",value:function(e){var t=e.mapResult(this.pos,1);return t.deleted?null:new p(t.pos,this.attrs)}},{key:"toJSON",value:function(){return{stepType:"setAttrs",pos:this.pos,attrs:this.attrs}}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.pos||null!=t.attrs&&"object"!=(0,i.Z)(t.attrs))throw new RangeError("Invalid input for SetAttrsStep.fromJSON");return new p(t.pos,t.attrs)}}]),p}(c.Step);c.Step.jsonID("setAttrs",d);var p=function(e,t){return function(n){return n.step(new d(e,t))}}},bIqi:function(e,t,n){"use strict";n.r(t),n.d(t,{ResolvedRange:function(){return l},expandContentResolvedRange:function(){return s},getInsertedPos:function(){return p},getMark:function(){return u},getMarkRange:function(){return a}});var i=n("rRkQ"),r=n("IkkI"),o=n("lqu/");function a(e,t){var n=c(e);if(!n.node)return!1;var i=n.node.marks.find((function(e){return e.type===t}));if(!i)return!1;var r=e.index(),o=e.start()+n.offset,a=o+n.node.nodeSize;return{from:d(e.parent,i,r,o,-1),to:d(e.parent,i,r,a,1)}}function s(e){if(e&&e.$from.parent!=e.$from.doc&&e.$from.sameParent(e.$to)&&0===e.$from.parentOffset&&e.$to.parentOffset===e.$to.parent.nodeSize-2){var t=e.$from.doc;return new l(t.resolve(e.$from.pos-1),t.resolve(e.$to.pos+1))}return e}function u(e,t){return c(e).node.marks.find((function(e){return e.type===t}))}var l=function(){function e(t,n){(0,i.Z)(this,e),this.$from=t,this.$to=n}return(0,r.Z)(e,null,[{key:"resolve",value:function(t,n){return new e(t.resolve(n.from),t.resolve(n.to))}}]),e}();function c(e){return e.parent.childAfter(e.parentOffset)}function d(e,t,n,i,r){for(var o=e.childCount-1;!((n+=r)<0||n>o);){var a=e.child(n);if(!t.isInSet(a.marks))break;i+=e.child(n).nodeSize*r}return i}function p(e){var t=e.steps[e.steps.length-1];return t instanceof o.ReplaceStep||t instanceof o.ReplaceAroundStep?t.to+t.slice.openStart:null}},swIM:function(e,t,n){"use strict";n.r(t),n.d(t,{isListActive:function(){return a},toggleList:function(){return o}});var i=n("fLDo"),r=n("2l2b");function o(e,t,n){var o=(0,i.liftListItem)(t),a=(0,i.wrapInList)(e);return function(t,i,s){var u=t.selection,l=u.$from.blockRange(u.$to);if(!l)return!1;var c=function(e,t){return(0,r.findParentNode)((function(e){return t.includes(e.type)}))(e)}(u,n),d=c&&l.depth-c.depth<=1;if(l.depth>=1&&d){if(c.node.type===e)return o(t,i,s);if(e.validContent(c.node.content))return i&&i(t.tr.setNodeMarkup(c.pos,e)),!0}return a(t,i,s)}}function a(e,t){var n=e.selection,i=n.$from.blockRange(n.$to);if(!i)return!1;var o=(0,r.findParentNode)((function(e){return e.type==t}))(n);return i.depth>=1&&o&&i.depth-o.depth<=1}n("51FK"),n("Xz/0")},NWA4:function(e,t,n){"use strict";n.r(t),n.d(t,{UploadError:function(){return b},parseFiles:function(){return x},pickFiles:function(){return S},upload:function(){return N}});var i=n("37Fk"),r=n("IkkI"),o=n("rRkQ"),a=n("vWPu"),s=n("F2vq"),u=n("thZj"),l=n("n/Nu");function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t,n){return d=c()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&(0,l.Z)(r,n.prototype),r},d.apply(null,arguments)}function p(e){var t="function"==typeof Map?new Map:void 0;return p=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return d(e,arguments,(0,u.Z)(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),(0,l.Z)(i,e)},p(e)}var f=n("KCiO"),m=n.n(f),h=tui.require("tui/config"),v=n("yQz/"),_=n.n(v),k=tui.require("editor_weka/components/upload/FilePicker"),g=n.n(k),y=n("Aely"),w=n.n(y);n("i77D");var b=function(e){(0,a.Z)(l,e);var t,n,i=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var r=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function l(e){var t;return(0,o.Z)(this,l),(t=i.call(this,e)).name="UploadError",t}return(0,r.Z)(l)}(p(Error));function x(e){return Array.isArray(e)?e:Array.prototype.slice.call(e).filter((function(e){return e instanceof File}))}function N(e){return I.apply(this,arguments)}function I(){return(I=(0,i.Z)(m().mark((function e(t){var n,i,r,o,a,s;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.file,i=t.repositoryId,r=t.itemId,o=t.contextId,a=t.acceptTypes,s=t.url,e.abrupt("return",new Promise((function(e,t){var u=new FormData,l=new XMLHttpRequest;u.append("repo_upload_file",n),u.append("title",n.name),u.append("sesskey",h.config.sesskey),u.append("repo_id",String(i)),u.append("itemid",String(r)),null!=o&&u.append("ctx_id",String(o)),a.forEach((function(e){return u.append("accepted_types[]",e)})),l.addEventListener("readystatechange",(function(){if(4===l.readyState){if(200!==l.status)return void t(new Error("Response is not a 200 response"));var n=JSON.parse(l.responseText);if(n.error)return void t(new b(n.error));e(n)}})),l.open("POST",s,!0),l.send(u)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return O.apply(this,arguments)}function O(){return(O=(0,i.Z)(m().mark((function e(t){var n,i,r;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=w().extend(g()),i=new n({parent:t.getParent(),propsData:{autoTrigger:!0}}),r=_()("weka-file-picker"),setTimeout((function(){r();var e=document.createElement("span");t.viewExtrasEl.appendChild(e),i.$mount(e)}),0),e.abrupt("return",new Promise((function(e){i.$on("picked-files",(function(t){e(t)})),i.$on("dismiss",(function(){i.$destroy(),t.viewExtrasEl.removeChild(i.$el)}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},HtfT:function(){},wWJ2:function(e,t,n){"use strict";function i(e,t,n,i,r,o,a,s){var u,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=n,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),a?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},l._ssrRegister=u):r&&(u=s?function(){r.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:r),u)if(l.functional){l._injectStyles=u;var c=l.render;l.render=function(e,t){return u.call(t),c(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,u):[u]}return{exports:e,options:l}}n.d(t,{Z:function(){return i}})},x4c5:function(e){"use strict";e.exports=tui.require("editor_weka/components/Weka")},xZv7:function(e){"use strict";e.exports=tui.require("editor_weka/components/editing/ActionDropdown")},"hd/h":function(e){"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol1")},KTPV:function(e){"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol2NarrowLeft")},Pspb:function(e){"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol2NarrowRight")},"5TpV":function(e){"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol2")},PWfy:function(e){"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutCol3")},"6tNc":function(e){"use strict";e.exports=tui.require("editor_weka/components/editing/graphics/layout_icons_24/LayoutIconBase")},lhYX:function(e){"use strict";e.exports=tui.require("editor_weka/components/node_menu/NodeMenuActionDropdown")},oXL3:function(e){"use strict";e.exports=tui.require("editor_weka/components/node_menu/NodeMenuButton")},nIqm:function(e){"use strict";e.exports=tui.require("editor_weka/components/node_menu")},TVjX:function(e){"use strict";e.exports=tui.require("editor_weka/components/nodes/BaseNode")},oFnQ:function(e){"use strict";e.exports=tui.require("editor_weka/components/toolbar/NodeBar")},"9lfe":function(e){"use strict";e.exports=tui.require("editor_weka/components/upload/ExtraFileUploadModal")},MERh:function(e){"use strict";e.exports=tui.require("editor_weka/lib/prosemirror_utils/selection")},VmD8:function(e){"use strict";e.exports=tui.require("editor_weka/mixins/attachment_mixin")},ASUJ:function(e){"use strict";e.exports=tui.require("editor_weka/util")},wQtR:function(e){"use strict";e.exports=tui.require("ext_prosemirror/commands")},sqie:function(e){"use strict";e.exports=tui.require("ext_prosemirror/history")},R3Ws:function(e){"use strict";e.exports=tui.require("ext_prosemirror/inputrules")},"51FK":function(e){"use strict";e.exports=tui.require("ext_prosemirror/model")},"Xz/0":function(e){"use strict";e.exports=tui.require("ext_prosemirror/state")},"lqu/":function(e){"use strict";e.exports=tui.require("ext_prosemirror/transform")},QxjF:function(e){"use strict";e.exports=tui.require("ext_prosemirror/view")},eHBv:function(e){"use strict";e.exports=tui.require("tui/components/buttons/ButtonGroup")},"1+j7":function(e){"use strict";e.exports=tui.require("tui/components/buttons/ButtonIcon")},IpiT:function(e){"use strict";e.exports=tui.require("tui/components/buttons/Button")},ddQy:function(e){"use strict";e.exports=tui.require("tui/components/buttons/Cancel")},DS3U:function(e){"use strict";e.exports=tui.require("tui/components/dropdown/DropdownButton")},"6e83":function(e){"use strict";e.exports=tui.require("tui/components/dropdown/DropdownItem")},"3NWB":function(e){"use strict";e.exports=tui.require("tui/components/dropdown/Dropdown")},"2XTD":function(e){"use strict";e.exports=tui.require("tui/components/form/FormRow")},ApK1:function(e){"use strict";e.exports=tui.require("tui/components/form/Form")},IgBQ:function(e){"use strict";e.exports=tui.require("tui/components/form/InputText")},vujW:function(e){"use strict";e.exports=tui.require("tui/components/icons/Image")},AQw4:function(e){"use strict";e.exports=tui.require("tui/components/icons/Layout")},"/g0d":function(e){"use strict";e.exports=tui.require("tui/components/icons/Loading")},x7h9:function(e){"use strict";e.exports=tui.require("tui/components/icons/More")},jGtd:function(e){"use strict";e.exports=tui.require("tui/components/images/ResponsiveImage")},ZkHI:function(e){"use strict";e.exports=tui.require("tui/components/json_editor/nodes/AttachmentNode")},"+Hsq":function(e){"use strict";e.exports=tui.require("tui/components/json_editor/nodes/Emoji")},GLpC:function(e){"use strict";e.exports=tui.require("tui/components/modal/ModalContent")},EJOt:function(e){"use strict";e.exports=tui.require("tui/components/modal/ModalPresenter")},IACo:function(e){"use strict";e.exports=tui.require("tui/components/modal/Modal")},eQKp:function(e){"use strict";e.exports=tui.require("tui/dom/position")},IjKw:function(e){"use strict";e.exports=tui.require("tui/dom/scroll")},dMpG:function(e){"use strict";e.exports=tui.require("tui/geometry")},xIDV:function(e){"use strict";e.exports=tui.require("tui/i18n")},x7Rm:function(e){"use strict";e.exports=tui.require("tui/notifications")},"yQz/":function(e){"use strict";e.exports=tui.require("tui/pending")},KJgz:function(e){"use strict";e.exports=tui.require("tui/polyfills/ResizeObserver")},"7mX8":function(e){"use strict";e.exports=tui.require("tui/tui")},U0bO:function(e){"use strict";e.exports=tui.require("tui/util")},Aely:function(e){"use strict";e.exports=tui.require("vue")},gnxZ:function(e,t,n){var i=n("uy/F").default;function r(){"use strict";e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function d(e,t,n,i){var r=t&&t.prototype instanceof m?t:m,o=Object.create(r.prototype),a=new S(i||[]);return o._invoke=function(e,t,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=p(e,t,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var f={};function m(){}function h(){}function v(){}var _={};c(_,s,(function(){return this}));var k=Object.getPrototypeOf,g=k&&k(k(O([])));g&&g!==n&&o.call(g,s)&&(_=g);var y=v.prototype=m.prototype=Object.create(_);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function n(r,a,s,u){var l=p(e[r],e,a);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==i(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,u)}))}u(l.arg)}var r;this._invoke=function(e,i){function o(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(o,o):o()}}function x(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var i=p(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function O(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return h.prototype=v,c(y,"constructor",v),c(v,"constructor",h),h.displayName=c(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},w(b.prototype),c(b.prototype,u,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new b(d(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(y),c(y,l,"Generator"),c(y,s,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var s=o.call(r,"catchLoc"),u=o.call(r,"finallyLoc");if(s&&u){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},"uy/F":function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},KCiO:function(e,t,n){var i=n("gnxZ")();e.exports=i;try{regeneratorRuntime=i}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},L2Id:function(e,t,n){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,{Z:function(){return i}})},SiDh:function(e,t,n){"use strict";function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return i}})},"37Fk":function(e,t,n){"use strict";function i(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,u,"next",e)}function u(e){i(a,r,o,s,u,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return r}})},rRkQ:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return i}})},IkkI:function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{Z:function(){return r}})},cXde:function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return i}})},thZj:function(e,t,n){"use strict";function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}n.d(t,{Z:function(){return i}})},vWPu:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n("n/Nu");function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,i.Z)(e,t)}},F2vq:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n("GggH"),r=n("SiDh");function o(e,t){if(t&&("object"===(0,i.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,r.Z)(e)}},"n/Nu":function(e,t,n){"use strict";function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}n.d(t,{Z:function(){return i}})},"5EKS":function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n("cVfm");function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||(0,i.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},GggH:function(e,t,n){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}n.d(t,{Z:function(){return i}})},cVfm:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n("L2Id");function r(e,t){if(e){if("string"==typeof e)return(0,i.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,i.Z)(e,t):void 0}}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("editor_weka")?console.warn('[tui bundle] The bundle "editor_weka" is already loaded, skipping initialisation.'):(n("HtfT"),tui._bundle.register("editor_weka"),tui._bundle.addModulesFromContext("editor_weka",n("fC82")),tui._bundle.addModulesFromContext("editor_weka/components",n("nHbi")),tui._bundle.addModulesFromContext("editor_weka/pages",n("B9Lp")))}()}();