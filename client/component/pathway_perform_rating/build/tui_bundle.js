(()=>{var e={"/kJN":(e,t,i)=>{var a={"./Rating":"1OLq","./Rating.vue":"1OLq","./RatingForm":"CE13","./RatingForm.vue":"CE13","./RatingFormPreview":"esSt","./RatingFormPreview.vue":"esSt","./achievements/AchievementDisplay":"ltgG","./achievements/AchievementDisplay.vue":"ltgG","./achievements/AchievementDisplayRater":"IN1M","./achievements/AchievementDisplayRater.vue":"IN1M"};function n(e){var t=r(e);return i(t)}function r(e){if(!i.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id="/kJN"},"1OLq":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});const a=tui.require("tui/components/form/HelpIcon"),n={components:{HelpIcon:i.n(a)()},props:{fromPrint:Boolean,rating:Object,required:Boolean}},r=function(e){e.options.__langStrings={core:["required"],pathway_perform_rating:["rating_only_one_rating_submitted","rating_to_be_submitted"]}};var s=(0,i("wWJ2").Z)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-competencyLinkedReviewRating",class:{"tui-competencyLinkedReviewRating--print":e.fromPrint}},[i("h3",{staticClass:"tui-competencyLinkedReviewRating__title"},[i("span",{staticClass:"tui-competencyLinkedReviewRating__title-text",attrs:{id:e.$id("rating_title")}},[e._v("\n      "+e._s(e.$str("rating_to_be_submitted","pathway_perform_rating"))+"\n    ")]),e._v(" "),e.required?i("span",{staticClass:"tui-competencyLinkedReviewRating__title-required"},[i("span",{attrs:{"aria-hidden":"true"}},[e._v("*")]),e._v(" "),i("span",{staticClass:"sr-only"},[e._v(e._s(e.$str("required","core")))])]):e._e(),e._v(" "),e.rating||e.fromPrint?e._e():i("HelpIcon",{staticClass:"tui-competencyLinkedReviewRating__title-help",attrs:{"desc-id":e.$id("activation-help"),helpmsg:e.$str("rating_only_one_rating_submitted","pathway_perform_rating")}})],1),e._v(" "),e.rating?i("div",{staticClass:"tui-competencyLinkedReviewRating__response"},[e._t("display")],2):i("div",{staticClass:"tui-competencyLinkedReviewRating__form"},[e._t("form",null,{titleId:e.$id("rating_title")})],2)])}),[],!1,null,null,null);r(s),s.options.__hasBlocks={script:!0,template:!0};const o=s.exports},CE13:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>F});const a=tui.require("tui/components/buttons/Button");var n=i.n(a);const r=tui.require("tui/components/modal/ConfirmationModal");var s=i.n(r);const o=tui.require("tui/components/reform/Field");var l=i.n(o);const u=tui.require("tui/components/uniform");var d=i("z1IF"),m=i.n(d),_=i("5Nvt"),c=i.n(_);const p=tui.require("tui/components/form/InputSet");var v=i.n(p);const g=tui.require("tui/components/form/Radio");var f=i.n(g),h=i("qvx2"),y=i.n(h);const k=tui.require("tui/notifications"),w=tui.require("tui/validation"),b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"pathway_perform_rating_linked_competencies_rate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"pathway_perform_rating_linked_competencies_rate_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pathway_perform_rating_linked_competencies_rate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"rating"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"rater_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"scale_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"proficient"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"DATE"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"already_exists"},arguments:[],directives:[]}]}}]}}]},R={components:{Button:n(),ConfirmationModal:s(),Field:l(),FormRadioGroup:u.FormRadioGroup,FormRow:u.FormRow,FormSelect:u.FormSelect,Grid:m(),GridItem:c(),InputSet:v(),Radio:f(),Rating:y(),Uniform:u.Uniform},props:{content:{type:Object,required:!0},elementData:Object,fromPrint:Boolean,isDraft:Boolean,participantInstanceId:{type:[String,Number],required:!1},required:Boolean,sectionElementId:{type:[String,Number],required:!0},subjectUser:{required:!0,type:Object}},data(){return{data:this.content,initialValues:{scaleValue:0},isSaving:!1,modalOpen:!1,selectedScaleValueId:0}},computed:{isRatingEnabled(){return this.elementData.content_type_settings.enable_rating},ratingRelationship(){return this.elementData.content_type_settings.rating_relationship_name},selectedScaleValueName(){return 0===this.selectedScaleValueId?null:null===this.selectedScaleValueId?this.$str("rating_no_rating","pathway_perform_rating"):this.data.scale_values.find((e=>e.id===this.selectedScaleValueId)).name},ratingLabel(){return this.$str("rating_relationship_label","pathway_perform_rating",this.ratingRelationship||"")},scaleValueOptions(){const e=this.data.scale_values?this.data.scale_values:[];return(this.fromPrint?[]:[{id:0,label:this.$str("rating_select","pathway_perform_rating")}]).concat(e.map((e=>({id:e.id,label:e.name})))).concat([{id:null,label:this.$str("rating_set_to_none","pathway_perform_rating")}])}},methods:{validations(){return!this.required||this.isDraft?[]:[w.v.required()]},confirmRating(e){this.selectedScaleValueId=e.scaleValue,this.modalOpen=!0},cancelRating(){this.selectedScaleValueId=0,this.modalOpen=!1},async saveRating(){this.isSaving=!0;try{const{data:e}=await this.$apollo.mutate({mutation:b,variables:{input:{competency_id:this.data.competency.id,participant_instance_id:this.participantInstanceId,scale_value_id:this.selectedScaleValueId,section_element_id:this.sectionElementId}}}),t=e.pathway_perform_rating_linked_competencies_rate;this.data=Object.assign({},this.data,{rating:t.rating}),!0===t.already_exists?this.$emit("show-banner",this.$str("rating_already_made_message","pathway_perform_rating")):(0,k.notify)({message:this.$str("rating_saved","pathway_perform_rating"),type:"success"})}finally{this.isSaving=!1,this.cancelRating()}}}},S=function(e){e.options.__langStrings={pathway_perform_rating:["rater_and_relationship","rating_already_made_message","rating_by_colon","rating_by_relationship","rating_confirmation_body_1","rating_confirmation_body_2","rating_confirmation_title","rating_final","rating_no_rating","rating_on","rating_relationship_label","rating_saved","rating_select","rating_set_to_none","rating_who","rating_submit"]}};var N=(0,i("wWJ2").Z)(R,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isRatingEnabled&&e.data&&e.data.can_view_rating?i("Rating",{staticClass:"tui-competencyLinkedReviewRatingForm",attrs:{"from-print":e.fromPrint,rating:e.data.rating,required:e.required},scopedSlots:e._u([{key:"display",fn:function(){return[i("Grid",{staticClass:"tui-competencyLinkedReviewRatingForm__summary",attrs:{"stack-at":700}},[i("GridItem",{attrs:{units:4}},[e.data.rating.rater_user?[i("span",[e._v("\n              "+e._s(e.$str("rating_by_colon","pathway_perform_rating"))+"\n            ")]),e._v("\n            "+e._s(e.$str("rater_and_relationship","pathway_perform_rating",{rater:e.data.rating.rater_user.fullname,relationship:e.ratingRelationship}))+"\n          ")]:[e._v("\n            "+e._s(e.$str("rating_by_relationship","pathway_perform_rating",e.ratingRelationship))+"\n          ")]],2),e._v(" "),i("GridItem",{attrs:{units:3}},[i("span",{staticClass:"sr-only"},[e._v("\n            "+e._s(e.$str("rating_on","pathway_perform_rating"))+"\n          ")]),e._v("\n          "+e._s(e.data.rating.created_at)+"\n        ")]),e._v(" "),i("GridItem",{staticClass:"tui-competencyLinkedReviewRatingForm__summary-rating",attrs:{units:5}},[i("span",[e._v("\n            "+e._s(e.$str("rating_final","pathway_perform_rating"))+"\n          ")]),e._v(" "),e.data.rating.scale_value?[e._v("\n            "+e._s(e.data.rating.scale_value.name)+"\n          ")]:[e._v("\n            "+e._s(e.$str("rating_no_rating","pathway_perform_rating"))+"\n          ")]],2)],1)]},proxy:!0},{key:"form",fn:function(){return[e.data.can_rate&&e.participantInstanceId?i("Uniform",{attrs:{"initial-values":e.initialValues,validate:e.validations},on:{submit:e.confirmRating}},[e.data.can_rate&&!e.fromPrint?i("FormRow",{attrs:{label:e.ratingLabel}},[i("InputSet",{attrs:{"char-length":"full"}},[i("FormSelect",{attrs:{id:e.$id("scaleValue"),name:"scaleValue","aria-label":e.$str("rating_select","pathway_perform_rating"),options:e.scaleValueOptions,"char-length":"15"}}),e._v(" "),i("Field",{attrs:{name:"scaleValue"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.value;return[i("Button",{attrs:{styleclass:{primary:!0,small:!0},text:e.$str("rating_submit","pathway_perform_rating"),type:"submit",disabled:0===a}})]}}],null,!1,1287574445)})],1)],1):i("FormRow",{attrs:{label:e.ratingLabel}},[i("FormRadioGroup",{attrs:{name:"scaleValue"}},e._l(e.scaleValueOptions,(function(t){return i("Radio",{key:t.id,attrs:{value:t.id}},[e._v("\n              "+e._s(t.label)+"\n            ")])})),1)],1)],1):i("div",[e._v("\n        "+e._s(e.$str("rating_who","pathway_perform_rating",e.ratingRelationship))+"\n      ")])]},proxy:!0}],null,!1,492157947)}):e._e(),e._v(" "),i("ConfirmationModal",{attrs:{open:e.modalOpen,title:e.$str("rating_confirmation_title","pathway_perform_rating"),"confirm-button-text":e.$str("rating_submit","pathway_perform_rating"),loading:e.isSaving},on:{confirm:e.saveRating,cancel:e.cancelRating}},[i("p",{domProps:{innerHTML:e._s(e.$str("rating_confirmation_body_1","pathway_perform_rating",{user:e.subjectUser.fullname,scale_value:e.selectedScaleValueName}))}}),e._v(" "),i("p",[e._v(e._s(e.$str("rating_confirmation_body_2","pathway_perform_rating")))])])],1)}),[],!1,null,null,null);S(N),N.options.__hasBlocks={script:!0,template:!0};const F=N.exports},esSt:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>_});const a=tui.require("tui/components/form/Form");var n=i.n(a);const r=tui.require("tui/components/form/Select");var s=i.n(r),o=i("qvx2"),l=i.n(o);const u={components:{Form:n(),FormSelect:s(),Rating:l()},props:{settings:Object},computed:{scaleValueOptions(){return[{id:null,label:this.$str("rating_select","pathway_perform_rating")}]}}},d=function(e){e.options.__langStrings={pathway_perform_rating:["rating_select"]}};var m=(0,i("wWJ2").Z)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.settings.enable_rating,expression:"settings.enable_rating"}],staticClass:"tui-linkedReviewRatingFormPreview"},[e.settings.enable_rating?i("Rating",{attrs:{required:!0},scopedSlots:e._u([{key:"form",fn:function(t){var a=t.titleId;return[i("div",{staticClass:"tui-linkedReviewRatingFormPreview__form"},[i("Form",{attrs:{"input-width":"full",vertical:!0}},[i("FormSelect",{attrs:{"aria-labelledby":a,options:e.scaleValueOptions,"char-length":"15",value:null}})],1)],1)]}}],null,!1,3529840272)}):e._e()],1)}),[],!1,null,null,null);d(m),m.options.__hasBlocks={script:!0,template:!0};const _=m.exports},ltgG:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>d});const a=tui.require("pathway_perform_rating/components/achievements/AchievementDisplayRater");var n=i.n(a);const r=tui.require("tui/components/collapsible/Collapsible");var s=i.n(r);const o={components:{AchievementDisplayRater:n(),Collapsible:s()},inheritAttrs:!1,props:{competencyId:{required:!0,type:Number},userId:{required:!0,type:Number}},data:function(){return{activityName:null,ratings:null}},apollo:{ratings:{query:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"pathway_perform_rating_linked_competencies_rating"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"pathway_perform_rating_linked_competencies_rating_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pathway_perform_rating_linked_competencies_rating"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"rating"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"rater_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"rater_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"rater_role"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"scale_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"proficient"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"DATE"}}],directives:[]}]}}]}}]}}]},context:{batch:!0},variables(){return{input:{competency_id:this.competencyId,user_id:this.userId}}},update({pathway_perform_rating_linked_competencies_rating:e}){return this.activityName=e.rating&&e.rating.activity&&e.rating.activity.name?e.rating.activity.name:this.$str("activity_removed","pathway_perform_rating"),this.$emit("loaded"),e.rating}}}},l=function(e){e.options.__langStrings={pathway_perform_rating:["activity_removed","no_rating_given"]}};var u=(0,i("wWJ2").Z)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-pathwayPerformRatingAchievement"},[e.ratings?[i("Collapsible",{attrs:{label:e.activityName,"initial-state":!0}},[i("AchievementDisplayRater",{attrs:{rating:e.ratings}})],1)]:[e._v("\n    "+e._s(e.$str("no_rating_given","pathway_perform_rating"))+"\n  ")]],2)}),[],!1,null,null,null);l(u),u.options.__hasBlocks={script:!0,template:!0};const d=u.exports},IN1M:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>p});const a=tui.require("totara_competency/components/achievements/AchievementLayout");var n=i.n(a),r=i("z1IF"),s=i.n(r),o=i("5Nvt"),l=i.n(o);const u=tui.require("tui/components/profile/MiniProfileCard");var d=i.n(u);const m={components:{AchievementLayout:n(),Grid:s(),GridItem:l(),MiniProfileCard:d()},inheritAttrs:!1,props:{rating:{required:!0,type:Object}},methods:{raterPurged:e=>null==e,getUserDetails(e){let t=e.rater_user,i=this.raterPurged(t)?this.$str("rater_details_removed","pathway_perform_rating"):t.fullname;return{profile_picture_alt:null,profile_picture_url:this.raterPurged(t)?e.defaultImageurl:t.profileimageurl,profile_url:null,display_fields:[{value:i,associate_url:null}]}}}},_=function(e){e.options.__langStrings={core:["date"],pathway_perform_rating:["rater","rater_details_removed","rating","rating_by","rating_set_to_none","your_rating"]}};var c=(0,i("wWJ2").Z)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-pathwayPerformRatingAchievementRater"},[i("AchievementLayout",{scopedSlots:e._u([{key:"left",fn:function(){return[i("div",{staticClass:"tui-pathwayPerformRatingAchievementRater__overview"},[i("h4",{staticClass:"tui-pathwayPerformRatingAchievementRater__overview-text"},[e._v("\n          "+e._s(e.$str("rating_by","pathway_perform_rating"))+"\n        ")]),e._v(" "),i("div",{staticClass:"tui-pathwayPerformRatingAchievementRater__overview-relationship"},[e._v("\n          "+e._s(e.rating.rater_role)+"\n        ")])])]},proxy:!0},{key:"right",fn:function(){return[i("Grid",{attrs:{"stack-at":750}},[i("GridItem",{staticClass:"tui-pathwayPerformRatingAchievementRater__item",attrs:{units:3}},[i("h4",{staticClass:"tui-pathwayPerformRatingAchievementRater__item-header"},[e._v("\n            "+e._s(e.$str("rater","pathway_perform_rating"))+"\n          ")]),e._v(" "),i("div",[i("MiniProfileCard",{attrs:{display:e.getUserDetails(e.rating),"no-border":"","no-padding":""}})],1)]),e._v(" "),i("GridItem",{staticClass:"tui-pathwayPerformRatingAchievementRater__item",attrs:{units:3}},[i("h4",{staticClass:"tui-pathwayPerformRatingAchievementRater__item-header"},[e._v("\n            "+e._s(e.$str("date"))+"\n          ")]),e._v(" "),i("div",[e._v("\n            "+e._s(e.rating.created_at)+"\n          ")])]),e._v(" "),i("GridItem",{staticClass:"tui-pathwayPerformRatingAchievementRater__item",attrs:{units:6}},[i("h4",{staticClass:"tui-pathwayPerformRatingAchievementRater__item-header"},[e._v("\n            "+e._s(e.$str("rating","pathway_perform_rating"))+"\n          ")]),e._v(" "),i("div",[e.rating.scale_value?[e._v("\n              "+e._s(e.rating.scale_value.name)+"\n            ")]:[e._v("\n              "+e._s(e.$str("rating_set_to_none","pathway_perform_rating"))+"\n            ")]],2)])],1)]},proxy:!0}])})],1)}),[],!1,null,null,null);_(c),c.options.__hasBlocks={script:!0,template:!0};const p=c.exports},wWJ2:(e,t,i)=>{"use strict";function a(e,t,i,a,n,r,s,o){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=i,u._compiled=!0),a&&(u.functional=!0),r&&(u._scopeId="data-v-"+r),s?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=l):n&&(l=o?function(){n.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(u.functional){u._injectStyles=l;var d=u.render;u.render=function(e,t){return l.call(t),d(e,t)}}else{var m=u.beforeCreate;u.beforeCreate=m?[].concat(m,l):[l]}return{exports:e,options:u}}i.d(t,{Z:()=>a})},qvx2:e=>{"use strict";e.exports=tui.require("pathway_perform_rating/components/Rating")},"5Nvt":e=>{"use strict";e.exports=tui.require("tui/components/grid/GridItem")},z1IF:e=>{"use strict";e.exports=tui.require("tui/components/grid/Grid")}},t={};function i(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("pathway_perform_rating")?console.warn('[tui bundle] The bundle "pathway_perform_rating" is already loaded, skipping initialisation.'):(tui._bundle.register("pathway_perform_rating"),tui._bundle.addModulesFromContext("pathway_perform_rating/components",i("/kJN")))}()})();