(()=>{var e={"2xMK":(e,t,i)=>{var n={"./action/CommentAction":"iVWb","./action/CommentAction.vue":"iVWb","./action/CommentActionDropDown":"G0te","./action/CommentActionDropDown.vue":"G0te","./action/CommentActionLink":"5qLA","./action/CommentActionLink.vue":"5qLA","./box/CommentBox":"LYRV","./box/CommentBox.vue":"LYRV","./box/CommentThread":"IIU4","./box/CommentThread.vue":"IIU4","./box/ReplyBox":"/jPl","./box/ReplyBox.vue":"/jPl","./box/SidePanelCommentBox":"kqGd","./box/SidePanelCommentBox.vue":"kqGd","./buttons/ReplyButtonIcon":"oD+Z","./buttons/ReplyButtonIcon.vue":"oD+Z","./card/CommentCard":"083I","./card/CommentCard.vue":"083I","./card/CommentReplyHeader":"Dl2Q","./card/CommentReplyHeader.vue":"Dl2Q","./card/ReplyCard":"p3B9","./card/ReplyCard.vue":"p3B9","./comment/Comment":"oO7j","./comment/Comment.vue":"oO7j","./content/CommentReplyContent":"3hgO","./content/CommentReplyContent.vue":"3hgO","./form/CommentForm":"k+vB","./form/CommentForm.vue":"k+vB","./form/EditCommentReplyForm":"pSl3","./form/EditCommentReplyForm.vue":"pSl3","./form/ReplyForm":"Hund","./form/ReplyForm.vue":"Hund","./form/box/ResponseBox":"Elh8","./form/box/ResponseBox.vue":"Elh8","./form/group/SubmitCancelButtonsGroup":"hnd7","./form/group/SubmitCancelButtonsGroup.vue":"hnd7","./modal/ConfirmDeleteCommentReplyModal":"Ouyl","./modal/ConfirmDeleteCommentReplyModal.vue":"Ouyl","./profile/CommentAvatar":"95mf","./profile/CommentAvatar.vue":"95mf","./profile/CommentUserLink":"uLcy","./profile/CommentUserLink.vue":"uLcy","./reply/Reply":"iGQB","./reply/Reply.vue":"iGQB"};function a(e){var t=r(e);return i(t)}function r(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=r,e.exports=a,a.id="2xMK"},VLfo:(e,t,i)=>{var n={".":"v/ui","./":"v/ui","./index":"v/ui","./index.js":"v/ui","./size":"qdAr","./size.js":"qdAr"};function a(e){var t=r(e);return i(t)}function r(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=r,e.exports=a,a.id="VLfo"},zs9s:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"core_file_unused_draft_item_id"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"item_id"},name:{kind:"Name",value:"core_file_unused_draft_item_id"},arguments:[],directives:[]}]}}]}},djWi:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_comments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instanceid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"cursor"},name:{kind:"Name",value:"totara_comment_comment_cursor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instanceid"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"next"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"comments"},name:{kind:"Name",value:"totara_comment_comments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instanceid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceid"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreplies"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_author"},arguments:[],directives:[]}]}}]}}]}}]}},"17w5":(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_reportedcontent_create_review"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"item_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_url"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"review"},name:{kind:"Name",value:"totara_reportedcontent_create_review"},arguments:[{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"item_id"},value:{kind:"Variable",name:{kind:"Name",value:"item_id"}}},{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]}},iVWb:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>u});const n=tui.require("totara_comment/components/buttons/ReplyButtonIcon");var a=i.n(n),r=i("TPml");const o=tui.require("totara_reaction/components/SimpleLike");var l=i.n(o);const m={components:{ReplyButtonIcon:a(),SimpleLike:l()},props:{commentId:{type:[Number,String],required:!0},area:{type:String,required:!0,validator:e=>["comment","reply"].includes(e)},size:{type:String,default:()=>r.SIZE_SMALL,validator:e=>(0,r.isValid)(e)},totalReplies:{type:[Number,String],default:0},totalReactions:[Number,String],reacted:Boolean,reactAble:{type:Boolean,default:!0},replyAble:{type:Boolean,default:!0},showLikeButton:{type:Boolean,default:!0},showLikeButtonText:Boolean,showReplyButtonText:Boolean},computed:{isSmall(){return r.SIZE_SMALL===this.size},likeButtonAriaLabel(){return this.reacted?this.$str("removelikeforcomment","totara_comment"):this.$str("likecomment","totara_comment")}}},d=function(e){e.options.__langStrings={totara_comment:["bracketnumber","likecomment","removelikeforcomment"]}};var s=(0,i("wWJ2").Z)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentAction"},[e.showLikeButton?i("SimpleLike",{staticClass:"tui-commentAction__likeButton",attrs:{"instance-id":e.commentId,component:"totara_comment",area:e.area,"total-likes":e.totalReactions,liked:e.reacted,"button-aria-label":e.likeButtonAriaLabel,disabled:!e.reactAble,"show-text":e.showLikeButtonText},on:{"update-like-status":function(t){return e.$emit("update-react-status",t)},"created-like":function(t){return e.$emit("update-react-status",!0)},"removed-like":function(t){return e.$emit("update-react-status",!1)}}}):e._e(),e._v(" "),i("div",{staticClass:"tui-commentAction__replyBox"},[i("ReplyButtonIcon",{attrs:{"show-text":e.showReplyButtonText,disabled:!e.replyAble},on:{click:function(t){return e.$emit("click-reply")}}}),e._v(" "),e.totalReplies?i("span",{staticClass:"tui-commentAction__replyBox-text",class:{"tui-commentAction__replyBox-text--small":e.isSmall}},[e._v("\n      "+e._s(e.$str("bracketnumber","totara_comment",e.totalReplies))+"\n    ")]):e._e()],1)],1)}),[],!1,null,null,null);d(s),s.options.__hasBlocks={script:!0,template:!0};const u=s.exports},G0te:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>p});const n=tui.require("tui/components/dropdown/Dropdown");var a=i.n(n);const r=tui.require("tui/components/icons/More");var o=i.n(r);const l=tui.require("tui/components/dropdown/DropdownItem");var m=i.n(l),d=i("1+j7");const s={components:{ButtonIcon:i.n(d)(),Dropdown:a(),More:o(),DropdownItem:m()},props:{showDeleteAction:{type:Boolean,default:!0},showUpdateAction:{type:Boolean,default:!0},showReportAction:{type:Boolean,default:!0}},computed:{showActions(){return this.showDeleteAction||this.showUpdateAction||this.showReportAction}}},u=function(e){e.options.__langStrings={core:["delete","edit"],totara_comment:["triggermenu","reportcontent"]}};var c=(0,i("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Dropdown",{staticClass:"tui-commentActionDropDown",attrs:{position:"bottom-right"},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle,a=t.isOpen;return[e.showActions?i("ButtonIcon",{attrs:{"aria-expanded":a?"true":"false","aria-label":e.$str("triggermenu","totara_comment"),styleclass:{transparentNoPadding:!0}},on:{click:function(e){return e.preventDefault(),n.apply(null,arguments)}}},[i("More",{attrs:{size:"300"}})],1):e._e()]}}])},[e._v(" "),e.showUpdateAction?i("DropdownItem",{on:{click:function(t){return e.$emit("click-edit")}}},[e._v("\n    "+e._s(e.$str("edit","core"))+"\n  ")]):e._e(),e._v(" "),e.showDeleteAction?i("DropdownItem",{on:{click:function(t){return e.$emit("click-delete")}}},[e._v("\n    "+e._s(e.$str("delete","core"))+"\n  ")]):e._e(),e._v(" "),e.showReportAction?i("DropdownItem",{on:{click:function(t){return e.$emit("click-report-content")}}},[e._v("\n    "+e._s(e.$str("reportcontent","totara_comment"))+"\n  ")]):e._e()],1)}),[],!1,null,null,null);u(c),c.options.__hasBlocks={script:!0,template:!0};const p=c.exports},"5qLA":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});const n=tui.require("totara_comment/index"),a={props:{loading:{type:Boolean,default:!1},showLoadMore:{type:Boolean,default:!1},size:{type:String,default:()=>n.SIZE_SMALL,validator:e=>(0,n.isValid)(e)}},computed:{isSmall(){return n.SIZE_SMALL===this.size},linkText(){return this.showLoadMore?this.$str("loadmorecomments","totara_comment"):""}},methods:{handleClick(){this.loading||this.showLoadMore&&this.$emit("load-more")}}},r=function(e){e.options.__langStrings={totara_comment:["loadmorecomments"]}};var o=(0,i("wWJ2").Z)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentActionLink"},[e.linkText?i("a",{staticClass:"tui-commentActionLink__link",class:{"tui-commentActionLink__link--small":e.isSmall,"tui-commentActionLink__link--disabled":e.loading||!e.showLoadMore},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.handleClick.apply(null,arguments)}}},[i("span",[e._v(e._s(e.linkText))])]):e._e()])}),[],!1,null,null,null);r(o),o.options.__hasBlocks={script:!0,template:!0};const l=o.exports},LYRV:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>v});const n=tui.require("totara_comment/components/form/CommentForm");var a=i.n(n),r=i("TPml");const o=tui.require("totara_comment/components/box/CommentThread");var l=i.n(o),m=i("djWi");const d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_create_comment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instanceid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"comment"},name:{kind:"Name",value:"totara_comment_create_comment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instanceid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceid"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreplies"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_author"},arguments:[],directives:[]}]}}]}}]}}]},s={components:{CommentThread:l(),CommentForm:a()},apollo:{totalComments:{query:m.Z,context:{batch:!0},watchLoading(e){this.$emit("fetch-comments",e)},variables(){return{component:this.component,area:this.area,instanceid:this.instanceId,cursor:this.firstCursor}},update:({cursor:{total:e}})=>parseInt(e,10),result({data:{cursor:{total:e}}}){this.$emit("update-total-comments",e)}}},props:{firstCursor:{type:String,default:null},size:{type:String,required:!0,validator:e=>(0,r.isValid)(e)},component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0},editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({compact:!0,variant:void 0,contextId:void 0})},submitting:Boolean,showLikeButtonText:Boolean,showReplyButtonText:Boolean,submitFormButtonText:String,withBorder:Boolean,showCommentForm:{type:Boolean,default:!0},showLikeButton:{type:Boolean,default:!0},commentAble:{type:Boolean,default:!0},commentInlineHead:Boolean},data(){return{totalComments:0,innerSubmitting:this.Boolean,commentsLoaded:!1,hasError:!1}},watch:{submitting(e){e!==this.innerSubmitting&&(this.innerSubmitting=e)},innerSubmitting(e){e!==this.submitting&&this.$emit("update-submitting",e)}},methods:{$_scrollCollectionToBottom(){this.$nextTick().then((()=>{let e=this.$refs["comment-thread"];e&&(e.$el.scrollTop=e.$el.scrollHeight)}))},async formReady(){await this.$nextTick();let e=this.$refs["comment-form"];e&&(e.$el&&(e=e.$el),this.$emit("form-ready",e))},async createComment({content:e,format:t,itemId:i}){if(!this.innerSubmitting){this.innerSubmitting=!0;try{let{data:{comment:n}}=await this.$apollo.mutate({mutation:d,refetchAll:!1,variables:{content:e,format:t,component:this.component,area:this.area,instanceid:this.instanceId,draft_id:i},update:(e,{data:{comment:t}})=>{const i={component:this.component,area:this.area,instanceid:this.instanceId,cursor:this.firstCursor};let{cursor:n,comments:a}=e.readQuery({query:m.Z,variables:i});n=Object.assign({},n),n.total+=1,e.writeQuery({query:m.Z,variables:i,data:{cursor:n,comments:Array.prototype.concat.call(a,[t])}})}});this.$_scrollCollectionToBottom(),this.$emit("create-comment",n),this.hasError=!1}catch(e){throw this.hasError=!0,e}finally{this.innerSubmitting=!1}}}}},u=s,c=function(e){e.options.__langStrings={totara_comment:["comments"]}};var p=(0,i("wWJ2").Z)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentBox",class:{"tui-commentBox--withBorder":e.withBorder,"tui-commentBox--noForm":!e.commentAble||!e.showCommentForm}},[i("CommentThread",{ref:"comment-thread",staticClass:"tui-commentBox__comments",attrs:{size:e.size,component:e.component,area:e.area,"instance-id":e.instanceId,submitting:e.innerSubmitting,"show-like-button":e.showLikeButton,"show-like-button-text":e.showLikeButtonText,"show-reply-button-text":e.showReplyButtonText,"with-border":e.withBorder,"first-cursor":e.firstCursor,"comment-inline-head":e.commentInlineHead,editor:e.editor},on:{"update-submitting":function(t){return e.$emit("update-submitting",t)},"fetch-comments":function(t){return e.$emit("fetch-comments",t)},"update-comment":function(t){return e.$emit("update-comment",t)},"delete-comment":function(t){return e.$emit("delete-comment",t)},"add-reply":function(t){return e.$emit("add-reply",t)},"update-react-status":function(t){return e.$emit("update-react-status",t)}}}),e._v(" "),e.commentAble?[!e.$apollo.queries.totalComments.loading&&e.showCommentForm?i("CommentForm",{ref:"comment-form",staticClass:"tui-commentBox__commentForm",class:{"tui-commentBox__commentForm--withBorder":e.withBorder},attrs:{size:e.size,editor:e.editor,"has-error":e.hasError,submitting:e.innerSubmitting,"submit-button-text":e.submitFormButtonText},on:{"form-ready":e.formReady,submit:e.createComment}}):e._e()]:e._e()],2)}),[],!1,null,null,null);c(p),p.options.__hasBlocks={script:!0,template:!0};const v=p.exports},IIU4:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>k});const n=tui.require("totara_comment/components/comment/Comment");var a=i.n(n),r=i("/g0d"),o=i.n(r),l=i("TPml");const m=tui.require("totara_comment/components/action/CommentActionLink");var d=i.n(m),s=i("0AlR"),u=i.n(s),c=i("djWi");const p={components:{Comment:a(),CommentActionLink:d(),Loading:o()},props:{firstCursor:{type:String,default:null},size:{type:String,required:!0,validator:e=>(0,l.isValid)(e)},component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0},submitting:Boolean,showLikeButtonText:Boolean,showReplyButtonText:Boolean,withBorder:Boolean,commentInlineHead:Boolean,showLikeButton:{type:Boolean,default:!0},editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({compact:!0,variant:void 0,contextId:void 0})}},apollo:{thread:{query:c.Z,context:{batch:!0},watchLoading(e){this.$emit("fetch-comments",e)},variables(){return{component:this.component,area:this.area,instanceid:this.instanceId,cursor:this.firstCursor}},update:({cursor:e,comments:t})=>({cursor:e,comments:t}),result({data:{comments:e,cursor:t}}){this.hasMoreComments=e.length<t.total,this.$emit("update-total-comments",t.total)}}},data:()=>({loading:0,hasMoreComments:!1,thread:{comments:[],cursor:null}}),computed:{isLarge(){return l.SIZE_LARGE===this.size}},methods:{async loadMore(){await this.$apollo.queries.thread.fetchMore({variables:{component:this.component,area:this.area,instanceid:this.instanceId,cursor:this.thread.cursor.next},updateQuery:(e,{fetchMoreResult:{comments:t,cursor:i}})=>{let n=Array.prototype.slice.call(e.comments);return t=Array.prototype.filter.call(t,(e=>void 0===Array.prototype.find.call(n,(t=>e.id==t.id)))),t=Array.prototype.concat.call(t,n),this.hasMoreComments=t.length<i.total,{comments:t,cursor:i}}})},addReplyToComment(e){const t={instanceid:this.instanceId,component:this.component,area:this.area,cursor:this.firstCursor};let{comments:i,cursor:n}=u().readQuery({query:c.Z,variables:t});u().writeQuery({query:c.Z,variables:t,data:{cursor:n,comments:Array.prototype.map.call(i,(t=>{if(e==t.id){let e=Object.assign({},t);return e.totalreplies+=1,e}return t}))}}),this.$emit("add-reply",e)},updateReactStatus({id:e,status:t}){const i={instanceid:this.instanceId,component:this.component,area:this.area,cursor:this.firstCursor};let{comments:n,cursor:a}=u().readQuery({query:c.Z,variables:i});u().writeQuery({query:c.Z,variables:i,data:{cursor:a,comments:Array.prototype.map.call(n,(i=>{if(i.id==e){let e=Object.assign({},i),n=Object.assign({},e.interactor);return n.reacted=t,e.interactor=n,t?e.totalreactions+=1:0!=e.totalreactions&&(e.totalreactions-=1),e}return i}))}}),this.$emit("update-react-status",{id:e,status:t})}}};var v=(0,i("wWJ2").Z)(p,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"comments",staticClass:"tui-commentThread"},[i("CommentActionLink",{staticClass:"tui-commentThread__actionLink",class:{"tui-commentThread__actionLink--withBorder":e.withBorder},attrs:{size:e.size,"show-load-more":e.hasMoreComments,loading:e.$apollo.queries.thread.loading},on:{"load-more":e.loadMore}}),e._v(" "),i("div",{staticClass:"tui-commentThread__comments"},[e.$apollo.queries.thread.loading?i("div",{staticClass:"tui-commentThread__loading"},[i("Loading")],1):e._e(),e._v(" "),e._l(e.thread.comments,(function(t,n){return[i("Comment",{key:t.id,staticClass:"tui-commentThread__comment",class:{"tui-commentThread__comment--large":e.isLarge,"tui-commentThread__comment--withBorderBottom":e.withBorder},attrs:{"data-counter":n,content:t.content,"comment-id":t.id,"user-full-name":t.user.fullname,"user-id":t.user.id,"user-profile-image-url":t.user.profileimageurl,"user-profile-image-alt":t.user.profileimagealt,"time-description":t.timedescription,"total-replies":t.totalreplies,"delete-able":t.interactor.can_delete,"update-able":t.interactor.can_update,"report-able":t.interactor.can_report,"reply-able":t.interactor.can_reply,"react-able":t.interactor.can_react,edited:t.edited,deleted:t.deleted,component:e.component,area:e.area,size:e.size,"instance-id":e.instanceId,submitting:e.submitting,"total-reactions":t.totalreactions,reacted:t.interactor.reacted,"show-like-button":e.showLikeButton,"show-like-button-text":e.showLikeButtonText,"show-reply-button-text":e.showReplyButtonText,"inline-head":e.commentInlineHead,"can-view-author":t.interactor.can_view_author,editor:e.editor},on:{"update-submitting":function(t){return e.$emit("update-submitting",t)},"update-comment":function(t){return e.$emit("update-comment",t)},"delete-comment":function(t){return e.$emit("delete-comment",t)},"add-reply":e.addReplyToComment,"update-react-status":e.updateReactStatus}})]}))],2)],1)}),[],!1,null,null,null);v.options.__hasBlocks={script:!0,template:!0};const k=v.exports},"/jPl":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>y});const n=tui.require("totara_comment/components/form/ReplyForm");var a=i.n(n),r=i("TPml"),o=i("/g0d"),l=i.n(o);const m=tui.require("totara_comment/components/reply/Reply");var d=i.n(m),s=i("0AlR"),u=i.n(s);const c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_replies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"page"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"replies"},name:{kind:"Name",value:"totara_comment_replies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"commentid"},value:{kind:"Variable",name:{kind:"Name",value:"commentid"}}},{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"Variable",name:{kind:"Name",value:"page"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_follow_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_author"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_create_reply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"reply"},name:{kind:"Name",value:"totara_comment_create_reply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"commentid"},value:{kind:"Variable",name:{kind:"Name",value:"commentid"}}},{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_follow_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_author"},arguments:[],directives:[]}]}}]}}]}}]},v={components:{ReplyForm:a(),Loading:l(),Reply:d()},props:{component:{type:String,required:!0},area:{type:String,required:!0},commentId:{type:[Number,String],required:!0},totalReplies:{type:[Number,String],required:!0},size:{type:String,default:()=>r.SIZE_SMALL,validator:e=>(0,r.isValid)(e)},showReplyForm:{type:Boolean,required:!0},replyAble:{type:Boolean,required:!0},submitting:Boolean,showLikeButton:{type:Boolean,default:!0},showLikeButtonText:Boolean,showReplyButtonText:Boolean,replyTo:null,replyHeadInline:Boolean,editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({compact:!0,variant:void 0})}},apollo:{replies:{query:c,watchLoading(e){this.$emit("fetch-replies",e)},variables(){return{commentid:this.commentId}},result({data:{replies:e}}){this.hasMoreReplies=e.length<this.totalReplies},skip(){return!this.loadRepliesStatus}}},data(){return{replies:[],page:1,loadRepliesStatus:!1,hasMoreReplies:!1,innerSubmitting:this.submitting,innerShowReplyForm:this.showReplyForm,innerReplyTo:this.replyTo,hasError:!1}},computed:{isLarge(){return r.SIZE_LARGE===this.size},hasReplies(){return 0<parseInt(this.totalReplies,10)},showLoadRepliesLink(){return!(!this.$apollo.queries.replies.loading||1!=this.page)||this.hasReplies&&!this.loadRepliesStatus},showLineSeparator(){return this.showLoadRepliesLink||this.hasMoreReplies}},watch:{innerSubmitting(e){e!==this.submitting&&this.$emit("update-submitting",e)},submitting(e){e!==this.innerSubmitting&&(this.innerSubmitting=e)},innerShowReplyForm(e){e&&(this.loadRepliesStatus||(this.loadRepliesStatus=!0)),e!==this.showReplyForm&&this.$emit("update-show-reply-form",e),e&&this.$_scrollToForm()},showReplyForm(e){e!==this.innerShowReplyForm&&(this.innerShowReplyForm=e,this.innerReplyTo=null)},replyTo(e){this.innerReplyTo=e},innerReplyTo(e){e!==this.replyTo&&this.$emit("update-reply-to",e)}},methods:{handleFormReady(){let e=this.$refs["reply-form"];e&&(e.$el&&(e=e.$el),this.$emit("form-ready",e))},$_scrollToForm(){this.$emit("scroll-to-reply-form")},async loadReplies(){this.loadRepliesStatus?(this.page+=1,await this.$apollo.queries.replies.fetchMore({variables:{page:this.page,commentid:this.commentId},updateQuery:(e,{fetchMoreResult:{replies:t}})=>(t=Array.prototype.concat.call(t,e.replies),this.hasMoreReplies=t.length<this.totalReplies,{replies:t})})):this.loadRepliesStatus=!0},updateRepliesCache(e){const t={commentid:this.commentId};let{replies:i}=u().readQuery({query:c,variables:t});u().writeQuery({query:c,variables:t,data:{replies:Array.prototype.map.call(i,(t=>t.id==e.id?e:t))}}),this.$emit("update-reply",e)},async createReply({content:e,format:t,commentId:i,itemId:n}){if(!this.innerSubmitting){this.innerSubmitting=!0;try{let{data:{reply:a}}=await this.$apollo.mutate({mutation:p,refetchAll:!1,variables:{commentid:i,content:e,format:t,draft_id:n},update:(e,{data:t})=>{let{replies:i}=e.readQuery({query:c,variables:{commentid:this.commentId}});e.writeQuery({query:c,variables:{commentid:this.commentId},data:{replies:Array.prototype.concat.call(i,[t.reply])}})}});this.innerShowReplyForm=!1,this.$emit("create-reply",a),this.hasError=!1}catch(e){throw this.hasError=!0,e}finally{this.innerSubmitting=!1}}},handleReplyTo(e){this.innerReplyTo=e,this.innerShowReplyForm&&this.$_scrollToForm(),this.innerShowReplyForm=!0},updateReactStatus({id:e,status:t}){let{replies:i}=u().readQuery({query:c,variables:{commentid:this.commentId}});u().writeQuery({query:c,variables:{commentid:this.commentId},data:{replies:Array.prototype.map.call(i,(i=>{if(i.id==e){let e=Object.assign({},i),n=Object.assign({},i.interactor);return n.reacted=t,e.interactor=n,t?e.totalreactions+=1:0!=e.totalreactions&&(e.totalreactions-=1),e}return i}))}})}}},k=function(e){e.options.__langStrings={totara_comment:["viewreplies"]}};var _=(0,i("wWJ2").Z)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentReplyBox"},[e.showLoadRepliesLink||e.loadRepliesStatus&&e.hasMoreReplies?i("div",{staticClass:"tui-commentReplyBox__replyLinkBox",class:{"tui-commentReplyBox__replyLinkBox--withSeparator":e.showLineSeparator,"tui-commentReplyBox__replyLinkBox--withoutSeparator":!e.showLineSeparator}},[i("a",{staticClass:"tui-commentReplyBox__replyLinkBox-link",class:{"tui-commentReplyBox__replyLinkBox-link--disabled":e.$apollo.queries.replies.loading},attrs:{href:"#",role:"button"},on:{click:function(t){return t.preventDefault(),e.loadReplies.apply(null,arguments)}}},[i("span",[e._v(e._s(e.$str("viewreplies","totara_comment")))]),e._v(" "),e.$apollo.queries.replies.loading?i("Loading"):e._e()],1)]):e._e(),e._v(" "),0<e.replies.length?[e._l(e.replies,(function(t,n){return[i("Reply",{key:t.id,staticClass:"tui-commentReplyBox__reply",class:{"tui-commentReplyBox__reply--large":e.isLarge},attrs:{"data-counter":n,"reply-id":t.id,content:t.content,"comment-id":t.commentid,component:e.component,"time-description":t.timedescription,"user-full-name":t.user.fullname,"user-profile-image-url":t.user.profileimageurl,"user-profile-image-alt":t.user.profileimagealt||t.user.fullname,"user-id":t.user.id,"update-able":t.interactor.can_update,"delete-able":t.interactor.can_delete,"report-able":t.interactor.can_report,"reply-able":t.interactor.can_follow_reply,"react-able":t.interactor.can_react,"can-view-author":t.interactor.can_view_author,"total-reactions":t.totalreactions,reacted:t.interactor.reacted,edited:t.edited,deleted:t.deleted,"reason-deleted":t.reasondeleted,size:e.size,submitting:e.innerSubmitting,"show-reply-button-text":e.showReplyButtonText,"show-like-button-text":e.showLikeButtonText,"show-like-button":e.showLikeButton,"inline-head":e.replyHeadInline,editor:e.editor},on:{"update-submitting":function(t){return e.$emit("update-submitting",t)},"update-reply":e.updateRepliesCache,"delete-reply":e.updateRepliesCache,"reply-to":e.handleReplyTo,"update-react-status":e.updateReactStatus}})]}))]:e._e(),e._v(" "),e.replyAble?[e.innerShowReplyForm?i("ReplyForm",{ref:"reply-form",staticClass:"tui-commentReplyBox__replyForm",attrs:{"comment-id":e.commentId,size:e.size,editor:e.editor,"reply-to":e.innerReplyTo,"has-error":e.hasError},on:{cancel:function(t){return e.$emit("update-show-reply-form",!1)},submit:e.createReply,"form-ready":e.handleFormReady}}):e._e()]:e._e()],2)}),[],!1,null,null,null);k(_),_.options.__hasBlocks={script:!0,template:!0};const y=_.exports},kqGd:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>u});const n=tui.require("totara_comment/components/box/CommentBox");var a=i.n(n),r=i("TPml"),o=i("/g0d"),l=i.n(o);const m={components:{CommentBox:a(),Loading:l()},props:{component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0},editorVariant:{type:String,default:"basic"},editorContextId:[String,Number],showCommentForm:{type:Boolean,default:!0},showComment:{type:Boolean,default:!0},showLikeButton:{type:Boolean,default:!0},extraExtensions:Array,interactor:{type:Object}},data:()=>({size:r.SIZE_SMALL,totalComments:0,submitting:!1,commentsLoading:!1}),computed:{reallyCommentAble(){return Boolean(this.interactor?this.interactor.can_comment:this.showComment)}}},d=function(e){e.options.__langStrings={totara_comment:["comments"],totara_engage:["comments"]}};var s=(0,i("wWJ2").Z)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-sidePanelCommentBox"},[i("h4",{staticClass:"tui-sidePanelCommentBox__header"},[e.commentsLoading?i("span",[e._v(e._s(e.$str("comments","totara_engage")))]):i("span",[e._v("\n      "+e._s(e.$str("comments","totara_comment",e.totalComments)))]),e._v(" "),e.submitting?i("Loading"):e._e()],1),e._v(" "),i("CommentBox",{staticClass:"tui-sidePanelCommentBox__box",attrs:{"instance-id":e.instanceId,component:e.component,area:e.area,size:e.size,submitting:e.submitting,editor:{compact:!0,variant:e.editorVariant,extraExtensions:e.extraExtensions,contextId:e.editorContextId},"show-comment-form":e.showCommentForm,"show-like-button":e.showLikeButton,"comment-able":e.reallyCommentAble},on:{"fetch-comments":function(t){e.commentsLoading=t},"update-total-comments":function(t){e.totalComments=t},"update-submitting":function(t){e.submitting=t},"create-comment":function(t){return e.$emit("create-comment",t)},"update-comment":function(t){return e.$emit("update-comment",t)},"delete-comment":function(t){return e.$emit("delete-comment",t)},"add-reply":function(t){return e.$emit("add-reply",t)},"update-react-status":function(t){return e.$emit("update-react-status",t)}}})],1)}),[],!1,null,null,null);d(s),s.options.__hasBlocks={script:!0,template:!0};const u=s.exports},"oD+Z":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var n=i("1+j7"),a=i.n(n);const r=tui.require("tui/components/icons/Reply");var o=i.n(r);const l={components:{ButtonIcon:a(),ReplyIcon:o()},props:{iconSize:[String,Number],showText:Boolean,transparent:{type:Boolean,default:!0},disabled:Boolean,small:{type:Boolean,default:!0}},computed:{buttonText(){return this.showText?this.$str("reply","totara_comment"):""},buttonStyleClass(){return{transparentNoPadding:this.transparent,small:this.small}}}},m=function(e){e.options.__langStrings={totara_comment:["reply"]}};var d=(0,i("wWJ2").Z)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ButtonIcon",{staticClass:"tui-commentReplyButtonIcon",attrs:{"aria-label":e.$str("reply","totara_comment"),text:e.buttonText,styleclass:e.buttonStyleClass,disabled:e.disabled},on:{click:function(t){return e.$emit("click",t)}}},[i("ReplyIcon",{attrs:{size:e.iconSize}})],1)}),[],!1,null,null,null);m(d),d.options.__hasBlocks={script:!0,template:!0};const s=d.exports},"083I":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=(0,i("wWJ2").Z)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentCard"},[i("div",{staticClass:"tui-commentCard__comment"},[i("div",{staticClass:"tui-commentCard__profilePicture"},[e._t("profile-picture")],2),e._v(" "),i("div",{staticClass:"tui-commentCard__body"},[i("div",{staticClass:"tui-commentCard__header"},[e._t("body-header")],2),e._v(" "),i("div",{staticClass:"tui-commentCard__content"},[e._t("body-content")],2),e._v(" "),i("div",{staticClass:"tui-commentCard__footer"},[e._t("body-footer")],2)])]),e._v(" "),i("div",{staticClass:"tui-commentCard__replyBox"},[e._t("reply-box")],2)])}),[],!1,null,null,null);n.options.__hasBlocks={script:!1,template:!0};const a=n.exports},Dl2Q:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>p});const n=tui.require("totara_comment/components/profile/CommentUserLink");var a=i.n(n);const r=tui.require("totara_comment/components/action/CommentActionDropDown");var o=i.n(r),l=i("TPml");const m=tui.require("tui/components/modal/ConfirmationModal");var d=i.n(m);const s={components:{CommentUserLink:a(),CommentActionDropDown:o(),ConfirmationModal:d()},props:{size:{type:String,default:()=>l.SIZE_SMALL,validator:e=>(0,l.isValid)(e)},userFullName:{type:String,required:!0},timeDescription:{type:String,required:!0},deleteAble:{type:Boolean,default:!1},updateAble:{type:Boolean,default:!1},reportAble:{type:Boolean,default:!1},edited:{type:Boolean,required:!0},profileUrl:String,inlineHead:Boolean,submitting:Boolean,openModal:Boolean}},u=function(e){e.options.__langStrings={totara_comment:["edited","delete_comment_confirm_1","delete_comment_confirm_2","delete_comment_confirm_title"],core:["delete"]}};var c=(0,i("wWJ2").Z)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentReplyHeader"},[i("ConfirmationModal",{attrs:{open:e.openModal,title:e.$str("delete_comment_confirm_title","totara_comment"),"confirm-button-text":e.$str("delete","core"),loading:e.submitting},on:{"close-complete":function(t){return e.$emit("close-complete")},confirm:function(t){return e.$emit("confirm-delete")},cancel:function(t){return e.$emit("close-delete-modal")}}},[i("p",[e._v(e._s(e.$str("delete_comment_confirm_1","totara_comment")))]),e._v(" "),i("p",[e._v(e._s(e.$str("delete_comment_confirm_2","totara_comment")))])]),e._v(" "),i("div",{staticClass:"tui-commentReplyHeader__content",class:{"tui-commentReplyHeader__content--inline":e.inlineHead}},[i("CommentUserLink",{staticClass:"tui-commentReplyHeader__link",class:{"tui-commentReplyHeader__link--inline":e.inlineHead},attrs:{size:e.size,"profile-url":e.profileUrl,"user-full-name":e.userFullName}}),e._v(" "),i("p",{staticClass:"tui-commentReplyHeader__timeDescription",class:{"tui-commentReplyHeader__timeDescription--inline":e.inlineHead}},[i("span",[e._v(e._s(e.timeDescription))]),e._v(" "),e.edited?i("span",[e._v(e._s(e.$str("edited","totara_comment")))]):e._e()])],1),e._v(" "),i("CommentActionDropDown",{staticClass:"tui-commentReplyHeader__menu",attrs:{"show-delete-action":e.deleteAble,"show-update-action":e.updateAble,"show-report-action":e.reportAble},on:{"click-edit":function(t){return e.$emit("click-edit")},"click-report-content":function(t){return e.$emit("click-report-content")},"click-delete":function(t){return e.$emit("open-delete-modal")}}})],1)}),[],!1,null,null,null);u(c),c.options.__hasBlocks={script:!0,template:!0};const p=c.exports},p3B9:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=(0,i("wWJ2").Z)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentReplyCard"},[i("div",{staticClass:"tui-commentReplyCard__profilePicture"},[e._t("profile-picture")],2),e._v(" "),i("div",{staticClass:"tui-commentReplyCard__body"},[i("div",{staticClass:"tui-commentReplyCard__header"},[e._t("body-header")],2),e._v(" "),i("div",{staticClass:"tui-commentReplyCard__content"},[e._t("body-content")],2),e._v(" "),i("div",{staticClass:"tui-commentReplyCard__footer"},[e._t("body-footer")],2)])])}),[],!1,null,null,null);n.options.__hasBlocks={script:!1,template:!0};const a=n.exports},oO7j:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>B});const n=tui.require("totara_comment/components/card/CommentCard");var a=i.n(n),r=i("NB1G"),o=i.n(r),l=i("UuZO"),m=i.n(l),d=i("TPml"),s=i("VPrV"),u=i.n(s),c=i("t1Yu"),p=i.n(c);const v=tui.require("totara_comment/components/box/ReplyBox");var k=i.n(v),_=i("x7Rm");const y=tui.require("tui/dom/transitions"),g=tui.require("tui/pending");var f=i.n(g);const h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_update_comment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"comment"},name:{kind:"Name",value:"totara_comment_update_comment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreplies"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_author"},arguments:[],directives:[]}]}}]}}]}}]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_delete_comment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"comment"},name:{kind:"Name",value:"totara_comment_delete_comment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreplies"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]};var N=i("17w5");const S={components:{ReplyBox:k(),CommentHeader:u(),CommentAction:m(),CommentCard:a(),Avatar:o(),CommentContent:p()},props:{commentId:{required:!0,type:[String,Number]},component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0},submitting:Boolean,totalReplies:{type:[Number,String],required:!0},totalReactions:[Number,String],reacted:Boolean,timeDescription:{type:String,required:!0},reportAble:{type:Boolean,required:!0},content:{type:String,required:!0},deleteAble:{type:Boolean,required:!0},updateAble:{type:Boolean,required:!0},replyAble:{type:Boolean,default:!0},reactAble:{type:Boolean,default:!0},userFullName:{type:String,required:!0},userId:{type:[String,Number],required:!0},userProfileImageUrl:{type:String,required:!0},userProfileImageAlt:{type:String},size:{type:String,default:()=>d.SIZE_SMALL,validator:e=>(0,d.isValid)(e)},edited:{type:Boolean,required:!0},deleted:{type:Boolean,required:!0},showLikeButton:{type:Boolean,default:!0},editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({compact:!0,variant:void 0,contextId:void 0})},showLikeButtonText:Boolean,showReplyButtonText:Boolean,inlineHead:Boolean,canViewAuthor:Boolean},data(){return{showForm:{reply:!1,comment:!1},innerSubmitting:this.submitting,replyTo:null,replyForm:null,fetchingReplies:!1,deleteModalOpen:!1,updateError:!1}},computed:{canInteract(){return this.replyAble||this.reactAble},profileUrl(){if(this.canViewAuthor)return this.$url("/user/profile.php",{id:this.userId})}},watch:{innerSubmitting(e){e!==this.submitting&&this.$emit("update-submitting",e)},submitting(e){this.innerSubmitting=e}},methods:{async $_completeFetchingReplies(){if(!this.fetchingReplies)return;let e=f()("totara_comment_fetching_replies"),t=i=>{setTimeout((()=>{this.fetchingReplies?t(i):(e(),i())}),100)};return new Promise(t)},async updateComment({content:e,id:t,format:i,itemId:n}){if(!this.innerSubmitting){this.innerSubmitting=!0;try{let{data:{comment:a}}=await this.$apollo.mutate({mutation:h,refetchAll:!1,variables:{id:t,content:e,format:i,draft_id:n}});this.$emit("update-comment",a),this.showForm.comment=!1,this.updateError=!1}catch(e){throw this.updateError=!0,e}finally{this.innerSubmitting=!1}}},async deleteComment(){if(!this.innerSubmitting){this.innerSubmitting=!0;try{let{data:{comment:e}}=await this.$apollo.mutate({mutation:b,refetchAll:!1,variables:{id:this.commentId}});this.$emit("delete-comment",e)}finally{this.deleteModalOpen=!1}}},async reportComment(){if(!this.innerSubmitting){this.innerSubmitting=!0;try{(await this.$apollo.mutate({mutation:N.Z,refetchAll:!1,variables:{component:this.component,area:"comment",item_id:this.commentId,url:window.location.href}}).then((e=>e.data.review))).success?await(0,_.notify)({message:this.$str("reported","totara_reportedcontent"),type:"success"}):await(0,_.notify)({message:this.$str("reported_failed","totara_reportedcontent"),type:"error"})}catch(e){await(0,_.notify)({message:this.$str("error:reportcomment","totara_comment"),type:"error"})}finally{this.innerSubmitting=!1}}},updateReactStatus(e){this.$emit("update-react-status",{status:e,id:this.commentId})},replyFormReady(e){let t=this.$refs["reply-box"];this.replyForm=e,t.$el.lastChild.scrollIntoView({block:"nearest",behavior:(0,y.shouldAnimate)()?"smooth":"auto"})},async handleReply(){this.showForm.reply=!0,null!==this.replyTo&&(this.replyTo=null),await this.scrollToReplyForm()},async scrollToReplyForm(){let e=this.$refs["reply-box"];e&&(await e.$nextTick(),this.fetchingReplies&&(await this.$_completeFetchingReplies(),await e.$nextTick()),e.$el.lastChild.scrollIntoView({block:"nearest",behavior:(0,y.shouldAnimate)()?"smooth":"auto"}))}}},F=function(e){e.options.__langStrings={totara_comment:["error:reportcomment"],totara_reportedcontent:["reported","reported_failed"]}};var C=(0,i("wWJ2").Z)(S,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("CommentCard",{staticClass:"tui-comment",attrs:{"data-id":e.commentId}},[i("Avatar",{attrs:{slot:"profile-picture","image-src":e.userProfileImageUrl,"image-alt":e.userProfileImageAlt||e.userFullName,"profile-url":e.profileUrl},slot:"profile-picture"}),e._v(" "),i("CommentHeader",{attrs:{slot:"body-header",size:e.size,"profile-url":e.profileUrl,"user-full-name":e.userFullName,"time-description":e.timeDescription,"update-able":e.updateAble,"delete-able":e.deleteAble,"report-able":e.reportAble,edited:e.edited,"inline-head":e.inlineHead,submitting:e.innerSubmitting,"open-modal":e.deleteModalOpen},on:{"close-complete":function(t){e.innerSubmitting=!1},"open-delete-modal":function(t){e.deleteModalOpen=!0},"close-delete-modal":function(t){e.deleteModalOpen=!1},"click-edit":function(t){e.showForm.comment=!0},"confirm-delete":e.deleteComment,"click-report-content":e.reportComment},slot:"body-header"}),e._v(" "),i("CommentContent",{attrs:{slot:"body-content",deleted:e.deleted,"item-id":e.commentId,content:e.content,"on-edit":e.showForm.comment,"is-reply":!1,size:e.size,editor:e.editor,"has-error":e.updateError},on:{"cancel-editing":function(t){e.showForm.comment=!1},"update-item":e.updateComment},slot:"body-content"}),e._v(" "),e.canInteract?i("CommentAction",{staticClass:"tui-comment__footer",attrs:{slot:"body-footer","total-replies":e.totalReplies,size:e.size,"comment-id":e.commentId,"total-reactions":e.totalReactions,reacted:e.reacted,"react-able":e.reactAble,"reply-able":e.replyAble,"show-like-button":e.showLikeButton,"show-like-button-text":e.showLikeButtonText,"show-reply-button-text":e.showReplyButtonText,area:"comment"},on:{"click-reply":e.handleReply,"update-react-status":e.updateReactStatus},slot:"body-footer"}):e._e(),e._v(" "),i("ReplyBox",{ref:"reply-box",staticClass:"tui-comment__replyBox",attrs:{slot:"reply-box","reply-able":e.replyAble,"comment-id":e.commentId,area:e.area,component:e.component,"show-reply-form":e.showForm.reply,"total-replies":e.totalReplies,submitting:e.innerSubmitting,size:e.size,"show-like-button":e.showLikeButton,"show-like-button-text":e.showLikeButtonText,"show-reply-button-text":e.showReplyButtonText,"reply-to":e.replyTo,"reply-head-inline":e.inlineHead,editor:e.editor,"open-modal":e.deleteModalOpen},on:{"close-complete":function(t){e.innerSubmitting=!1},"open-delete-modal":function(t){e.deleteModalOpen=!0},"close-delete-modal":function(t){e.deleteModalOpen=!1},"update-show-reply-form":function(t){e.showForm.reply=t},"create-reply":function(t){return e.$emit("add-reply",e.commentId)},"update-submitting":function(t){return e.$emit("update-submitting",t)},"form-ready":e.replyFormReady,"update-reply-to":function(t){e.replyTo=t},"scroll-to-reply-form":e.scrollToReplyForm,"fetch-replies":function(t){e.fetchingReplies=t}},slot:"reply-box"})],1)}),[],!1,null,null,null);F(C),C.options.__hasBlocks={script:!0,template:!0};const B=C.exports},"3hgO":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});const n=tui.require("tui/tui");var a=i.n(n);const r=tui.require("totara_comment/components/form/EditCommentReplyForm");var o=i.n(r),l=i("TPml");const m={components:{EditForm:o()},props:{content:{type:String,required:!0},onEdit:{type:Boolean,default:!1},itemId:{type:[Number,String],required:!0,validator:e=>!isNaN(e)},isReply:{type:Boolean,default:!1},deleted:{type:Boolean,required:!0},size:{type:String,default:()=>l.SIZE_SMALL,validator:e=>(0,l.isValid)(e)},editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({compact:!0,variant:void 0,contextId:void 0})},hasError:Boolean},mounted(){this.$_scan()},updated(){this.$_scan()},methods:{$_scan(){let e=this.$refs.content;e&&a().scan(e)}}};var d=(0,i("wWJ2").Z)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentReplyContent"},[e.onEdit?i("EditForm",{staticClass:"tui-commentReplyContent__editForm",attrs:{"item-id":e.itemId,size:e.size,editor:e.editor,"has-error":e.hasError},on:{cancel:function(t){return e.$emit("cancel-editing")},"update-item":function(t){return e.$emit("update-item",t)}}}):i("div",{ref:"content",staticClass:"tui-commentReplyContent__content",class:{"tui-commentReplyContent__content--reply":e.isReply,"tui-commentReplyContent__content--deleted":e.deleted},domProps:{innerHTML:e._s(e.content)}})],1)}),[],!1,null,null,null);d.options.__hasBlocks={script:!0,template:!0};const s=d.exports},"k+vB":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>F});var n=i("x4c5"),a=i.n(n),r=i("Srla"),o=i.n(r),l=i("ApK1"),m=i.n(l);const d=tui.require("tui/util");var s=i("eHBv"),u=i.n(s),c=i("IpiT"),p=i.n(c),v=i("UYjc"),k=i("TPml"),_=i("d9f6"),y=i.n(_),g=i("byAl"),f=i.n(g),h=i("zs9s");const b={components:{Weka:a(),Form:m(),ButtonGroup:u(),Button:p(),ResponseBox:y(),UnsavedChangesWarning:f()},props:{size:{type:String,default:()=>k.SIZE_SMALL,validator:e=>(0,k.isValid)(e)},component:String,area:String,instanceId:[String,Number],editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({compact:!0,variant:void 0,contextId:void 0})},submitting:Boolean,hasError:Boolean,submitButtonText:{type:String,default(){return this.$str("post","totara_comment")}}},data:()=>({editorKey:`totara_comment_editor_weka_${(0,d.uniqueId)()}`,editorOption:null,draftId:null,content:o().empty()}),computed:{isSmall(){return k.SIZE_SMALL===this.size}},watch:{editorOption(){console.warn("The attribute 'editorOption' had been deprecated, please do not use it")},async submitting(e){!1!==e||this.hasError||(this.content=o().empty(),await this.$_loadDraftId(),this.editorKey=`totara_comment_editor_weka_${(0,d.uniqueId)()}`,this.$forceUpdate())}},async mounted(){this.component&&console.warn("The prop 'component' had been deprecated and no longer used, please update all call"),this.area&&console.warn("The prop 'area' had been deprecated and no longer used, please update all call"),this.instanceId&&console.warn("The prop 'instanceId' had been deprecated and no longer used, please update all call"),await this.$_loadDraftId()},methods:{async $_loadDraftId(){const{data:{item_id:e}}=await this.$apollo.mutate({mutation:h.Z});this.draftId=e},submit(){this.submitting||this.$emit("submit",{content:JSON.stringify(this.content.getDoc()),format:v.FORMAT_JSON_EDITOR,itemId:this.draftId})}}},N=function(e){e.options.__langStrings={totara_comment:["post","entercomment"]}};var S=(0,i("wWJ2").Z)(b,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ResponseBox",{staticClass:"tui-commentForm"},[i("Form",{staticClass:"tui-commentForm__form"},[e.content.isEmpty||e.submitting?e._e():i("UnsavedChangesWarning",{attrs:{value:e.content}}),e._v(" "),i("div",{staticClass:"tui-commentForm__input"},[e.draftId?i("Weka",{key:e.editorKey,staticClass:"tui-commentForm__editor",attrs:{"data-key":e.editorKey,"usage-identifier":{component:"totara_comment",area:"comment"},variant:e.editor.variant,compact:e.editor.compact,"extra-extensions":e.editor.extraExtensions,"file-item-id":e.draftId,placeholder:e.$str("entercomment","totara_comment"),"data-file-item-id":e.draftId,"context-id":e.editor.contextId},on:{ready:function(t){return e.$emit("form-ready")}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}):e._e()],1),e._v(" "),i("ButtonGroup",{staticClass:"tui-commentForm__buttonGroup"},[i("Button",{staticClass:"tui-commentForm__button",attrs:{text:e.submitButtonText,"aria-label":e.submitButtonText,disabled:e.content.isEmpty||e.submitting,styleclass:{primary:!0,small:e.isSmall}},on:{click:e.submit}})],1)],1)],1)}),[],!1,null,null,null);N(S),S.options.__hasBlocks={script:!0,template:!0};const F=S.exports},pSl3:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>y});var n=i("x4c5"),a=i.n(n),r=i("Srla"),o=i.n(r),l=i("ApK1"),m=i.n(l),d=i("TPml"),s=i("z8od"),u=i.n(s),c=i("byAl"),p=i.n(c);const v={components:{Weka:a(),Form:m(),SubmitCancelButtonsGroup:u(),UnsavedChangesWarning:p()},apollo:{item:{query:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_draft_item"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"draftitem"},name:{kind:"Name",value:"totara_comment_draft_item"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"comment_area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file_draft_id"},arguments:[],directives:[]}]}}]}}]},fetchPolicy:"network-only",variables(){return{id:this.itemId}},result({data:{draftitem:e}}){this.content=o().fromDoc(JSON.parse(e.content))},update:({draftitem:e})=>e}},props:{size:{type:String,default:()=>d.SIZE_SMALL,validator:e=>(0,d.isValid)(e)},itemId:{type:[String,Number],required:!0},editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({contextId:void 0,variant:void 0,compact:!0})},submitting:Boolean,hasError:Boolean},data:()=>({editorOption:null,item:{},content:o().empty()}),computed:{commentArea(){return this.item.comment_area?this.item.comment_area.toLowerCase():"comment"}},watch:{editorOption(){console.warn("The data attribute 'editorOption' had been deprecated and no longer used")}},methods:{submit(){const e={id:this.itemId,content:JSON.stringify(this.content.getDoc()),format:this.item.format,itemId:this.content.fileStorageItemId};this.$emit("update-item",e)}}},k=function(e){e.options.__langStrings={totara_comment:["done"]}};var _=(0,i("wWJ2").Z)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Form",{staticClass:"tui-editCommentReplyForm"},[e.$apollo.loading?e._e():[e.content.isEmpty||e.submitting?e._e():i("UnsavedChangesWarning",{attrs:{value:e.content}}),e._v(" "),e.$apollo.queries.item.loading?e._e():i("Weka",{staticClass:"tui-editCommentReplyForm__editor",attrs:{"file-item-id":e.item.file_draft_id,"usage-identifier":{component:"totara_comment",area:e.commentArea,instanceId:e.itemId},compact:e.editor.compact,"context-id":e.editor.contextId,variant:e.editor.variant,"extra-extensions":e.editor.extraExtensions,disabled:e.submitting},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e._v(" "),i("SubmitCancelButtonsGroup",{attrs:{"submit-text":e.$str("done","totara_comment"),"disable-submit":e.content.isEmpty||e.submitting,size:e.size},on:{"click-submit":e.submit,"click-cancel":function(t){return e.$emit("cancel")}}})]],2)}),[],!1,null,null,null);k(_),_.options.__hasBlocks={script:!0,template:!0};const y=_.exports},Hund:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>N});var n=i("x4c5"),a=i.n(n),r=i("Srla"),o=i.n(r),l=i("ApK1"),m=i.n(l),d=i("z8od"),s=i.n(d),u=i("UYjc");const c=tui.require("editor_weka/helpers/mention");var p=i("TPml"),v=i("d9f6"),k=i.n(v),_=i("byAl"),y=i.n(_),g=i("zs9s");const f={components:{Weka:a(),Form:m(),SubmitCancelButtonsGroup:s(),ResponseBox:k(),UnsavedChangesWarning:y()},props:{size:{type:String,default:()=>p.SIZE_SMALL,validator:e=>(0,p.isValid)(e)},component:String,area:String,commentId:{type:[String,Number],required:!0},editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({compact:!0,variant:void 0,contextId:void 0})},submitting:Boolean,hasError:Boolean,replyTo:{type:Object,default:()=>null}},data:()=>({draftId:null,editorOption:null,content:o().empty(),isMounted:!1}),computed:{isSmall(){return p.SIZE_SMALL===this.size}},watch:{replyTo:{deep:!0,immediate:!0,handler(e){this.content=e?o().fromDoc((0,c.createMentionContent)(e)):o().empty()}},editorOption(){console.warn("The data attribute 'editorOption' had been deprecated and no longer used, please update all calls")},submitting(e){!1!==e||this.hasError||(this.content=o().empty(),this.$_loadDraftId())}},async mounted(){await this.$_loadDraftId(),this.component&&console.warn('The prop "component" has been deprecated, please do not use.'),this.area&&console.warn('The prop "area" has been deprecated, please do not use.'),this.isMounted=!0},methods:{async $_loadDraftId(){const{data:{item_id:e}}=await this.$apollo.mutate({mutation:g.Z});this.draftId=e},submit(){this.submitting||this.$emit("submit",{content:JSON.stringify(this.content.getDoc()),format:u.FORMAT_JSON_EDITOR,commentId:this.commentId,itemId:this.draftId})}}},h=function(e){e.options.__langStrings={totara_comment:["enterreply","reply"]}};var b=(0,i("wWJ2").Z)(f,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ResponseBox",{staticClass:"tui-commentReplyForm"},[i("Form",{staticClass:"tui-commentReplyForm__form"},[e.content.isEmpty||e.submitting?e._e():i("UnsavedChangesWarning",{attrs:{value:e.content}}),e._v(" "),e.draftId?i("Weka",{staticClass:"tui-commentReplyForm__editor",attrs:{compact:e.editor.compact,variant:e.editor.variant,"extra-extensions":e.editor.extraExtensions,"usage-identifier":{component:"totara_comment",area:"reply"},placeholder:e.$str("enterreply","totara_comment"),"file-item-id":e.draftId,"data-file-item-id":e.draftId,"context-id":e.editor.contextId,disabled:e.submitting},on:{ready:function(t){return e.$emit("form-ready")}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}):e._e(),e._v(" "),i("SubmitCancelButtonsGroup",{attrs:{"submit-text":e.$str("reply","totara_comment"),size:e.size,"disable-submit":e.content.isEmpty||e.submitting||!e.isMounted,"disable-cancel":e.submitting},on:{"click-submit":e.submit,"click-cancel":function(t){return e.$emit("cancel")}}})],1)],1)}),[],!1,null,null,null);h(b),b.options.__hasBlocks={script:!0,template:!0};const N=b.exports},Elh8:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i("NB1G");const a={components:{Avatar:i.n(n)()},apollo:{user:{query:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_actor"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"user"},name:{kind:"Name",value:"totara_comment_actor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]}]}}]}}]}}},data:()=>({user:{}})};var r=(0,i("wWJ2").Z)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-commentResponseBox"},[e.$apollo.loading?e._e():i("div",{staticClass:"tui-commentResponseBox__profilePicture"},[i("Avatar",{attrs:{"image-alt":e.user.profileimagealt||"","image-src":e.user.profileimageurl,"profile-url":e.$url("/user/profile.php",{id:e.user.id})}})],1),e._v(" "),i("div",{staticClass:"tui-commentResponseBox__formBox"},[e._t("default")],2)])}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};const o=r.exports},hnd7:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>u});var n=i("eHBv"),a=i.n(n),r=i("IpiT"),o=i.n(r),l=i("TPml");const m={components:{ButtonGroup:a(),Button:o()},props:{disableSubmit:{type:Boolean,default:!1},disableCancel:{type:Boolean,default:!1},submitText:{type:String,required:!0},size:{type:String,default:()=>l.SIZE_SMALL,validator:e=>(0,l.isValid)(e)}},computed:{isSmall(){return l.SIZE_SMALL==this.size}}},d=function(e){e.options.__langStrings={core:["cancel"]}};var s=(0,i("wWJ2").Z)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ButtonGroup",{staticClass:"tui-commentSubmitCancelButtonGroup"},[i("Button",{staticClass:"tui-commentSubmitCancelButtonGroup__submit",attrs:{text:e.submitText,styleclass:{primary:!0,small:e.isSmall},disabled:e.disableSubmit},on:{click:function(t){return t.preventDefault(),e.$emit("click-submit")}}}),e._v(" "),i("Button",{staticClass:"tui-commentSubmitCancelButtonGroup__cancel",attrs:{text:e.$str("cancel","core"),styleclass:{small:e.isSmall},disabled:e.disableCancel},on:{click:function(t){return t.preventDefault(),e.$emit("click-cancel")}}})],1)}),[],!1,null,null,null);d(s),s.options.__hasBlocks={script:!0,template:!0};const u=s.exports},Ouyl:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>_});const n=tui.require("tui/components/modal/Modal");var a=i.n(n);const r=tui.require("tui/components/modal/ModalContent");var o=i.n(r),l=i("eHBv"),m=i.n(l),d=i("IpiT"),s=i.n(d);const u=tui.require("tui/components/icons/Warning");var c=i.n(u);const p={components:{Modal:a(),ModalContent:o(),ButtonGroup:m(),Button:s(),Warning:c()},props:{title:{type:String,default:""}},computed:{id(){return this.$id(this.title)}}},v=function(e){e.options.__langStrings={core:["cancel","confirm"],totara_comment:["deletecommentconfirm"]}};var k=(0,i("wWJ2").Z)(p,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{staticClass:"tui-confirmDeleteCommentReplyModal",attrs:{size:"small","aria-labelledby":e.id}},[i("ModalContent",{staticClass:"tui-confirmDeleteCommentReplyModal__content",attrs:{"close-button":!0,title:e.title,"title-id":e.id},on:{dismiss:function(t){return e.$emit("request-close")}}},[i("div",{staticClass:"tui-confirmDeleteCommentReplyModal__textBox"},[i("Warning",{attrs:{size:700,"custom-class":["tui-icon--warning","tui-confirmDeleteCommentReplyModal__icon"]}}),e._v(" "),i("p",{staticClass:"tui-confirmDeleteCommentReplyModal__textBox-text"},[e._v("\n        "+e._s(e.$str("deletecommentconfirm","totara_comment"))+"\n      ")])],1),e._v(" "),i("ButtonGroup",{staticClass:"tui-confirmDeleteCommentReplyModal__buttons",attrs:{slot:"buttons"},slot:"buttons"},[i("Button",{attrs:{text:e.$str("confirm","core"),styleclass:{primary:!0,small:!0}},on:{click:function(t){return t.preventDefault(),e.$emit("confirm-delete")}}}),e._v(" "),i("Button",{attrs:{text:e.$str("cancel","core"),styleclass:{small:!0}},on:{click:function(t){return t.preventDefault(),e.$emit("request-close")}}})],1)],1)],1)}),[],!1,null,null,null);v(k),k.options.__hasBlocks={script:!0,template:!0};const _=k.exports},"95mf":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});const n=tui.require("tui/components/avatar/Avatar"),a={components:{CoreAvatar:i.n(n)()},props:{imageSrc:{required:!0,type:String},imageAlt:{required:!0,type:String},profileUrl:String}};var r=(0,i("wWJ2").Z)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.profileUrl?i("a",{attrs:{href:e.profileUrl}},[i("CoreAvatar",{attrs:{src:e.imageSrc,alt:e.imageAlt,size:"xxsmall"}})],1):i("CoreAvatar",{attrs:{src:e.imageSrc,alt:e.imageAlt,size:"xxsmall"}})}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};const o=r.exports},uLcy:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i("TPml");const a={props:{userFullName:{type:String,required:!0},size:{type:String,default:()=>n.SIZE_SMALL,validator:e=>(0,n.isValid)(e)},profileUrl:String},computed:{isSmall(){return n.SIZE_SMALL===this.size},isLarge(){return n.SIZE_LARGE===this.size}}};var r=(0,i("wWJ2").Z)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.profileUrl?i("a",{staticClass:"tui-commentUserLink",class:{"tui-commentUserLink--smallLink":e.isSmall,"tui-commentUserLink--largeLink":e.isLarge},attrs:{href:e.profileUrl}},[e._v("\n  "+e._s(e.userFullName)+"\n")]):i("span",{staticClass:"tui-commentUserLink",class:{"tui-commentUserLink--smallText":e.isSmall,"tui-commentUserLink--largeText":e.isLarge}},[e._v("\n  "+e._s(e.userFullName)+"\n")])}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};const o=r.exports},iGQB:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>b});var n=i("NB1G"),a=i.n(n);const r=tui.require("totara_comment/components/card/ReplyCard");var o=i.n(r),l=i("UuZO"),m=i.n(l),d=i("TPml"),s=i("VPrV"),u=i.n(s),c=i("t1Yu"),p=i.n(c),v=i("x7Rm");const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_update_reply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"reply"},name:{kind:"Name",value:"totara_comment_update_reply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_follow_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_author"},arguments:[],directives:[]}]}}]}}]}}]},_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_delete_reply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"reply"},name:{kind:"Name",value:"totara_comment_delete_reply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_follow_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]};var y=i("17w5");const g={components:{ReplyHeader:u(),CommentAction:m(),ReplyCard:o(),Avatar:a(),ReplyContent:p()},props:{replyId:{type:[Number,String],required:!0},commentId:{type:[String,Number],required:!0},component:{type:String,required:!0},submitting:Boolean,userFullName:{type:String,required:!0},userId:{type:[String,Number],required:!0},userProfileImageUrl:{type:String,required:!0},userProfileImageAlt:{type:String,default:""},timeDescription:{type:String,required:!0},reportAble:{type:Boolean,required:!0},content:{type:String,required:!0},deleteAble:{type:Boolean,required:!0},updateAble:{type:Boolean,required:!0},size:{type:String,default:()=>d.SIZE_SMALL,validator:e=>(0,d.isValid)(e)},edited:{type:Boolean,required:!0},deleted:{type:Boolean,required:!0},totalReactions:[Number,String],reacted:Boolean,replyAble:{type:Boolean,default:!0},reactAble:{type:Boolean,default:!0},showLikeButton:{type:Boolean,default:!0},showLikeButtonText:Boolean,showReplyButtonText:Boolean,inlineHead:Boolean,canViewAuthor:Boolean,editor:{type:Object,validator:e=>"compact"in e&&"variant"in e,default:()=>({compact:!0,variant:void 0,contextId:void 0})}},data(){return{editting:!1,innerSubmitting:this.submitting,deleteModalOpen:!1}},computed:{profileUrl(){if(this.canViewAuthor)return this.$url("/user/profile.php",{id:this.userId})},canInteract(){return this.replyAble||this.reactAble}},watch:{innerSubmitting(e){e!==this.submitting&&this.$emit("update-submitting",e)},submitting(e){this.innerSubmitting=e}},methods:{handleReply(){const e={fullname:this.userFullName,userId:this.userId};this.$emit("reply-to",e)},async updateReply({id:e,content:t,format:i,itemId:n}){if(!this.innerSubmitting){this.innerSubmitting=!0;try{let{data:{reply:a}}=await this.$apollo.mutate({mutation:k,refetchAll:!1,variables:{id:e,content:t,format:i,draft_id:n}});this.editting=!1,this.$emit("update-reply",a)}finally{this.innerSubmitting=!1}}},async deleteReply(){if(!this.innerSubmitting){this.innerSubmitting=!0;try{let{data:{reply:e}}=await this.$apollo.mutate({mutation:_,refetchAll:!1,variables:{id:this.replyId}});this.$emit("delete-reply",e)}finally{this.deleteModalOpen=!1}}},async reportReply(){if(!this.innerSubmitting){this.innerSubmitting=!0;try{(await this.$apollo.mutate({mutation:y.Z,refetchAll:!1,variables:{component:this.component,area:"reply",item_id:this.replyId,url:window.location.href}}).then((e=>e.data.review))).success?await(0,v.notify)({message:this.$str("reported","totara_reportedcontent"),type:"success"}):await(0,v.notify)({message:this.$str("reported_failed","totara_reportedcontent"),type:"error"})}catch(e){await(0,v.notify)({message:this.$str("error:reportreply","totara_comment"),type:"error"})}finally{this.innerSubmitting=!1}}},updateReactStatus(e){this.$emit("update-react-status",{id:this.replyId,status:e})}}},f=function(e){e.options.__langStrings={totara_comment:["error:reportreply"],totara_reportedcontent:["reported","reported_failed"]}};var h=(0,i("wWJ2").Z)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ReplyCard",{staticClass:"tui-commentReply",attrs:{"data-id":e.replyId}},[i("Avatar",{attrs:{slot:"profile-picture","image-src":e.userProfileImageUrl,"image-alt":e.userProfileImageAlt,"profile-url":e.profileUrl},slot:"profile-picture"}),e._v(" "),i("ReplyHeader",{attrs:{slot:"body-header",size:e.size,"user-full-name":e.userFullName,"profile-url":e.profileUrl,"time-description":e.timeDescription,edited:e.edited,"update-able":e.updateAble,"delete-able":e.deleteAble,"report-able":e.reportAble,"inline-head":e.inlineHead,submitting:e.innerSubmitting,"open-modal":e.deleteModalOpen},on:{"close-complete":function(t){e.innerSubmitting=!1},"open-delete-modal":function(t){e.deleteModalOpen=!0},"close-delete-modal":function(t){e.deleteModalOpen=!1},"confirm-delete":e.deleteReply,"click-report-content":e.reportReply,"click-edit":function(t){e.editting=!0}},slot:"body-header"}),e._v(" "),i("ReplyContent",{attrs:{slot:"body-content","item-id":e.replyId,deleted:e.deleted,"on-edit":e.editting,content:e.content,"is-reply":!0,editor:e.editor,size:e.size},on:{"cancel-editing":function(t){e.editting=!1},"update-item":e.updateReply},slot:"body-content"}),e._v(" "),e.canInteract?i("CommentAction",{staticClass:"tui-commentReply__footer",attrs:{slot:"body-footer",size:e.size,"comment-id":e.replyId,"total-reactions":e.totalReactions,reacted:e.reacted,"react-able":e.reactAble,"reply-able":e.replyAble,"show-reply-button-text":e.showReplyButtonText,"show-like-button-text":e.showLikeButtonText,"show-like-button":e.showLikeButton,area:"reply"},on:{"click-reply":e.handleReply,"update-react-status":e.updateReactStatus},slot:"body-footer"}):e._e()],1)}),[],!1,null,null,null);f(h),h.options.__hasBlocks={script:!0,template:!0};const b=h.exports},"v/ui":(e,t,i)=>{"use strict";i.r(t),i.d(t,{SIZE_LARGE:()=>n.SIZE_LARGE,SIZE_SMALL:()=>n.SIZE_SMALL,isValid:()=>n.isValid});var n=i("qdAr")},qdAr:(e,t,i)=>{"use strict";i.r(t),i.d(t,{SIZE_LARGE:()=>n,SIZE_SMALL:()=>a,isValid:()=>r});const n="large",a="small";function r(e){return n===e||a===e}},wWJ2:(e,t,i)=>{"use strict";function n(e,t,i,n,a,r,o,l){var m,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=i,d._compiled=!0),n&&(d.functional=!0),r&&(d._scopeId="data-v-"+r),o?(m=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},d._ssrRegister=m):a&&(m=l?function(){a.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:a),m)if(d.functional){d._injectStyles=m;var s=d.render;d.render=function(e,t){return m.call(t),s(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,m):[m]}return{exports:e,options:d}}i.d(t,{Z:()=>n})},Srla:e=>{"use strict";e.exports=tui.require("editor_weka/WekaValue")},x4c5:e=>{"use strict";e.exports=tui.require("editor_weka/components/Weka")},UuZO:e=>{"use strict";e.exports=tui.require("totara_comment/components/action/CommentAction")},VPrV:e=>{"use strict";e.exports=tui.require("totara_comment/components/card/CommentReplyHeader")},t1Yu:e=>{"use strict";e.exports=tui.require("totara_comment/components/content/CommentReplyContent")},d9f6:e=>{"use strict";e.exports=tui.require("totara_comment/components/form/box/ResponseBox")},z8od:e=>{"use strict";e.exports=tui.require("totara_comment/components/form/group/SubmitCancelButtonsGroup")},NB1G:e=>{"use strict";e.exports=tui.require("totara_comment/components/profile/CommentAvatar")},TPml:e=>{"use strict";e.exports=tui.require("totara_comment/size")},byAl:e=>{"use strict";e.exports=tui.require("totara_engage/components/form/UnsavedChangesWarning")},"0AlR":e=>{"use strict";e.exports=tui.require("tui/apollo_client")},eHBv:e=>{"use strict";e.exports=tui.require("tui/components/buttons/ButtonGroup")},"1+j7":e=>{"use strict";e.exports=tui.require("tui/components/buttons/ButtonIcon")},IpiT:e=>{"use strict";e.exports=tui.require("tui/components/buttons/Button")},ApK1:e=>{"use strict";e.exports=tui.require("tui/components/form/Form")},"/g0d":e=>{"use strict";e.exports=tui.require("tui/components/icons/Loading")},UYjc:e=>{"use strict";e.exports=tui.require("tui/format")},x7Rm:e=>{"use strict";e.exports=tui.require("tui/notifications")}},t={};function i(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("totara_comment")?console.warn('[tui bundle] The bundle "totara_comment" is already loaded, skipping initialisation.'):(tui._bundle.register("totara_comment"),tui._bundle.addModulesFromContext("totara_comment",i("VLfo")),tui._bundle.addModulesFromContext("totara_comment/components",i("2xMK")))}()})();