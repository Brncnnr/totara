(()=>{var e={VV44:(e,i,n)=>{var t={"./Notifications":"mwyP","./Notifications.vue":"mwyP","./action/NotifiableEventAction":"zmis","./action/NotifiableEventAction.vue":"zmis","./action/NotificationAction":"NZE1","./action/NotificationAction.vue":"NZE1","./form/DeliveryPreferenceForm":"D67c","./form/DeliveryPreferenceForm.vue":"D67c","./form/NotificationPreferenceForm":"/iLc","./form/NotificationPreferenceForm.vue":"/iLc","./form/field/ForceDeliveryChannels":"JG7t","./form/field/ForceDeliveryChannels.vue":"JG7t","./json_editor/nodes/Placeholder":"aGEQ","./json_editor/nodes/Placeholder.vue":"aGEQ","./modal/DeliveryPreferenceModal":"eMCN","./modal/DeliveryPreferenceModal.vue":"eMCN","./modal/NotificationPreferenceModal":"i25Z","./modal/NotificationPreferenceModal.vue":"i25Z","./table/NotificationTable":"lAre","./table/NotificationTable.vue":"lAre","./table/UserPreferencesTable":"MMW8","./table/UserPreferencesTable.vue":"MMW8"};function a(e){var i=r(e);return n(i)}function r(e){if(!n.o(t,e)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t[e]}a.keys=function(){return Object.keys(t)},a.resolve=r,e.exports=a,a.id="VV44"},yYpj:(e,i,n)=>{var t={"./NotificationPage":"aGKH","./NotificationPage.vue":"aGKH","./UserPreferences":"/koY","./UserPreferences.vue":"/koY"};function a(e){var i=r(e);return n(i)}function r(e){if(!n.o(t,e)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t[e]}a.keys=function(){return Object.keys(t)},a.resolve=r,e.exports=a,a.id="yYpj"},mwyP:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>D});const t=tui.require("tui/components/loading/Loader");var a=n.n(t);const r=tui.require("totara_notification/components/table/NotificationTable");var l=n.n(r),d=n("EJOt"),o=n.n(d);const s=tui.require("totara_notification/components/modal/NotificationPreferenceModal");var c=n.n(s);const u=tui.require("tui/components/modal/ConfirmationModal");var m=n.n(u),v=n("Akzt"),_=n.n(v),k=n("x7Rm");const p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_notification_event_resolvers_v2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"totara_notification_extended_context_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"resolvers"},name:{kind:"Name",value:"totara_notification_event_resolvers_v2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"can_manage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_audit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"additional_criteria_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"notification_preferences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ancestor_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"body_content"},name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"subject_content"},name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_recipient"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_schedule"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"extended_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"valid_schedules"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"default_delivery_channels"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_sub_delivery_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_order"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"warnings"},arguments:[],directives:[]}]}}]}}]},f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_create_custom_notification_preference_v2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_component"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_item_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body_format"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_format"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"recipients"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notification_preference"},name:{kind:"Name",value:"totara_notification_create_notification_preference_v2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"extended_context"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_area"}}},{kind:"ObjectField",name:{kind:"Name",value:"item_id"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_item_id"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"ObjectField",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"ObjectField",name:{kind:"Name",value:"additional_criteria"},value:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}}},{kind:"ObjectField",name:{kind:"Name",value:"body"},value:{kind:"Variable",name:{kind:"Name",value:"body"}}},{kind:"ObjectField",name:{kind:"Name",value:"body_format"},value:{kind:"Variable",name:{kind:"Name",value:"body_format"}}},{kind:"ObjectField",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"ObjectField",name:{kind:"Name",value:"schedule_type"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}}},{kind:"ObjectField",name:{kind:"Name",value:"schedule_offset"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}}},{kind:"ObjectField",name:{kind:"Name",value:"subject_format"},value:{kind:"Variable",name:{kind:"Name",value:"subject_format"}}},{kind:"ObjectField",name:{kind:"Name",value:"recipients"},value:{kind:"Variable",name:{kind:"Name",value:"recipients"}}},{kind:"ObjectField",name:{kind:"Name",value:"enabled"},value:{kind:"Variable",name:{kind:"Name",value:"enabled"}}},{kind:"ObjectField",name:{kind:"Name",value:"forced_delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ancestor_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"body_content"},name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"subject_content"},name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_recipient"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_schedule"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"extended_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_override_notification_preference_v2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_component"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_item_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ancestor_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body_format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"recipients"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notification_preference"},name:{kind:"Name",value:"totara_notification_create_notification_preference_v2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"extended_context"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_area"}}},{kind:"ObjectField",name:{kind:"Name",value:"item_id"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_item_id"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"ObjectField",name:{kind:"Name",value:"ancestor_id"},value:{kind:"Variable",name:{kind:"Name",value:"ancestor_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"ObjectField",name:{kind:"Name",value:"additional_criteria"},value:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}}},{kind:"ObjectField",name:{kind:"Name",value:"body"},value:{kind:"Variable",name:{kind:"Name",value:"body"}}},{kind:"ObjectField",name:{kind:"Name",value:"body_format"},value:{kind:"Variable",name:{kind:"Name",value:"body_format"}}},{kind:"ObjectField",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"ObjectField",name:{kind:"Name",value:"schedule_type"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}}},{kind:"ObjectField",name:{kind:"Name",value:"schedule_offset"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}}},{kind:"ObjectField",name:{kind:"Name",value:"subject_format"},value:{kind:"Variable",name:{kind:"Name",value:"subject_format"}}},{kind:"ObjectField",name:{kind:"Name",value:"recipients"},value:{kind:"Variable",name:{kind:"Name",value:"recipients"}}},{kind:"ObjectField",name:{kind:"Name",value:"enabled"},value:{kind:"Variable",name:{kind:"Name",value:"enabled"}}},{kind:"ObjectField",name:{kind:"Name",value:"forced_delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ancestor_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"body_content"},name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"subject_content"},name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_recipient"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_schedule"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"extended_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_update_notification_preference_v2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body_format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"recipients"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notification_preference"},name:{kind:"Name",value:"totara_notification_update_notification_preference_v2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"body"},value:{kind:"Variable",name:{kind:"Name",value:"body"}}},{kind:"ObjectField",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"ObjectField",name:{kind:"Name",value:"body_format"},value:{kind:"Variable",name:{kind:"Name",value:"body_format"}}},{kind:"ObjectField",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"ObjectField",name:{kind:"Name",value:"additional_criteria"},value:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}}},{kind:"ObjectField",name:{kind:"Name",value:"schedule_type"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}}},{kind:"ObjectField",name:{kind:"Name",value:"schedule_offset"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}}},{kind:"ObjectField",name:{kind:"Name",value:"subject_format"},value:{kind:"Variable",name:{kind:"Name",value:"subject_format"}}},{kind:"ObjectField",name:{kind:"Name",value:"recipients"},value:{kind:"Variable",name:{kind:"Name",value:"recipients"}}},{kind:"ObjectField",name:{kind:"Name",value:"enabled"},value:{kind:"Variable",name:{kind:"Name",value:"enabled"}}},{kind:"ObjectField",name:{kind:"Name",value:"forced_delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ancestor_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"body_content"},name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"subject_content"},name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_recipient"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_schedule"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"extended_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_delete_notification_preference"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totara_notification_delete_notification_preference"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}]},h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_update_notifiable_event_default_delivery_channels"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"default_delivery_channels"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"default_delivery_channels"},name:{kind:"Name",value:"totara_notification_update_default_delivery_channels"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"default_delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"default_delivery_channels"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_sub_delivery_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_order"},arguments:[],directives:[]}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_toggle_notifiable_event_v2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_notification_extended_context_input"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"is_enabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notifiable_event"},name:{kind:"Name",value:"totara_notification_toggle_notifiable_event_v2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}},{kind:"Argument",name:{kind:"Name",value:"is_enabled"},value:{kind:"Variable",name:{kind:"Name",value:"is_enabled"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]}]}}]}}]},x="create",F="update",C={components:{Loader:a(),NotificationTable:l(),ModalPresenter:o(),NotificationPreferenceModal:c(),DeleteConfirmationModal:m(),DeliveryPreferenceModal:_()},props:{contextId:{type:[Number,String],required:!0},preferredEditorFormat:[Number,String],extendedContext:{type:Object,default:()=>({}),validate:e=>"component"in e&&"area"in e&&"itemId"in e&&(""===e.component&&""===e.area&&0==e.itemId||""!==e.component&&""!==e.area&&0!=e.itemId)},canChangeDeliveryChannelDefaults:Boolean},apollo:{eventResolvers:{query:p,variables(){return{extended_context:{context_id:this.contextId,component:this.extendedContext.component,area:this.extendedContext.area,item_id:this.extendedContext.itemId}}},update({resolvers:e}){let i={};return e.forEach((e=>{const{component:n,plugin_name:t,recipients:a}=e;i[t]||(i[t]={component:n,plugin_name:t,resolvers:[],recipients:a}),i[t].resolvers.push(e)})),Object.values(i)}}},data:()=>({modal:{open:!1,title:"",state:null},deleteModal:{open:!1},deliveryPreferenceModal:{open:!1},deleting:!1,targetResolverClassName:null,targetDeletePreference:null,targetPreference:null,targetScheduleTypes:[],targetAvailableRecipients:[],targetDefaultDeliveryChannels:[],targetadditionalCriteriaComponent:null,targetResolverLabel:null}),computed:{deleteNotificationTitle(){let e="";return this.targetDeletePreference&&(e=this.$str("delete_confirm_title","totara_notification",this.targetDeletePreference.title)),e},queryVariables(){return{extended_context:{context_id:this.contextId,component:this.extendedContext.component,area:this.extendedContext.area,item_id:this.extendedContext.itemId}}}},methods:{resetState(){this.targetResolverClassName=null,this.targetPreference=null,this.modal.title="",this.targetScheduleTypes=[],this.targetDefaultDeliveryChannels=[],this.targetadditionalCriteriaComponent=null,this.targetResolverLabel=null},handleCreateCustomNotification({resolverClassName:e,scheduleTypes:i,recipients:n,deliveryChannels:t,additionalCriteriaComponent:a}){this.modal.title=this.$str("create_custom_notification_title","totara_notification"),this.modal.open=!0,this.modal.state=x,this.targetResolverClassName=e,this.targetScheduleTypes=i,this.targetAvailableRecipients=n,this.targetDefaultDeliveryChannels=t,this.targetadditionalCriteriaComponent=a},async handleEditNotification(e,i,n,t,a){this.targetPreference=await this.getOverriddenPreference(e),this.targetResolverClassName=this.targetPreference.resolver_class_name,this.targetScheduleTypes=i,this.targetAvailableRecipients=n,this.targetDefaultDeliveryChannels=t,this.targetadditionalCriteriaComponent=a,this.modal.title=this.$str("edit_notification","totara_notification"),this.modal.open=!0,this.modal.state=F},async handleUpdateDeliveryPreferences({resolverClassName:e,resolverLabel:i,defaultDeliveryChannels:n}){this.targetResolverClassName=e,this.targetResolverLabel=i,this.targetDefaultDeliveryChannels=n,this.deliveryPreferenceModal.open=!0},async deleteNotification(){this.deleteModal.open&&(this.deleting=!0,await this.handleDeleteNotification(this.targetDeletePreference),this.deleteModal.open=!1,(0,k.notify)({type:"success",message:this.$str("delete_success","totara_notification")}),this.deleting=!1)},async handleDeleteNotification(e){await this.$apollo.mutate({mutation:y,variables:{id:e.id},update:i=>{let{resolvers:n}=i.readQuery({query:p,variables:this.queryVariables});const{extended_context:t,id:a,resolver_class_name:r}=e,{component:l}=t;n=Object.assign([],n),n=n.map((e=>{const{notification_preferences:i}=e;return i.map((e=>e.extended_context&&e.extended_context.component)).includes(l)&&e.class_name===r?((e=Object.assign({},e)).notification_preferences=i.filter((e=>e.id!==a)),e):e})),i.writeQuery({query:p,variables:this.queryVariables,data:{resolvers:n}})}})},confirmDeleteNotification(e){this.targetDeletePreference=e,this.deleteModal.open=!0},async handleFormSubmit(e){if(this.modal.state===x)await this.createCustomNotification(e);else{if(this.modal.state!==F)throw new Error("The modal state is invalid");await this.updateNotification(e)}this.modal.open=!1,(0,k.notify)({type:"success",message:this.modal.state===x?this.$str("saved_notification","totara_notification"):this.$str("updated_notification","totara_notification")})},async createCustomNotification({subject:e,body:i,title:n,additional_criteria:t,body_format:a,resolver_class_name:r,schedule_type:l,schedule_offset:d,subject_format:o,recipients:s,enabled:c,forced_delivery_channels:u}){const m={body:i,subject:e,title:n,additional_criteria:t,body_format:a,resolver_class_name:r,subject_format:o,context_id:this.contextId,schedule_type:l,schedule_offset:d,recipients:s,enabled:c,forced_delivery_channels:u};this.extendedContext.area&&this.extendedContext.component&&this.extendedContext.itemId&&(m.extended_context_area=this.extendedContext.area,m.extended_context_component=this.extendedContext.component,m.extended_context_item_id=this.extendedContext.itemId),await this.$apollo.mutate({mutation:f,variables:m,update:(e,{data:{notification_preference:i}})=>{const{resolvers:n}=e.readQuery({query:p,variables:this.queryVariables}),{resolver_plugin_name:t,resolver_class_name:a}=i;e.writeQuery({query:p,variables:this.queryVariables,data:{resolvers:n.map((e=>{if(e.plugin_name===t&&e.class_name===a){e=Object.assign({},e);const{notification_preferences:n}=e;e.notification_preferences=[i].concat(n)}return e}))}})}})},async getOverriddenPreference(e){if(e.extended_context.context_id==this.contextId)return e;const{data:{notification_preference:i}}=await this.$apollo.mutate({mutation:b,variables:{context_id:this.contextId,resolver_class_name:e.resolver_class_name,extended_context_component:this.extendedContext.component,extended_context_area:this.extendedContext.area,extended_context_item_id:this.extendedContext.itemId,ancestor_id:e.ancestor_id?e.ancestor_id:e.id},update:(e,{data:{notification_preference:i}})=>{const{resolvers:n}=e.readQuery({query:p,variables:this.queryVariables}),{resolver_plugin_name:t,resolver_class_name:a,parent_id:r}=i;e.writeQuery({query:p,variables:this.queryVariables,data:{resolvers:n.map((e=>{if(e.plugin_name===t&&e.class_name===a){e=Object.assign({},e);const{notification_preferences:n}=e;e.notification_preferences=n.map((e=>e.id==r?i:e))}return e}))}})}});return i},async updateNotification({subject:e,title:i,additional_criteria:n,body:t,body_format:a,schedule_type:r,schedule_offset:l,subject_format:d,recipients:o,enabled:s,forced_delivery_channels:c}){if(!this.targetPreference)throw new Error("Cannot run update while target preference is empty");await this.$apollo.mutate({mutation:N,variables:{id:this.targetPreference.id,additional_criteria:n,subject:e,body:t,body_format:a,subject_format:d,title:this.targetPreference.is_custom&&!this.targetPreference.parent_id?i:void 0,schedule_type:r,schedule_offset:l,recipients:o,enabled:s,forced_delivery_channels:c},update:(e,{data:{notification_preference:i}})=>{const{resolvers:n}=e.readQuery({query:p,variables:this.queryVariables}),{resolver_plugin_name:t,resolver_class_name:a}=i;e.writeQuery({query:p,variables:this.queryVariables,data:{resolvers:n.map((e=>{if(e.plugin_name===t&&e.class_name===a){e=Object.assign({},e);const{notification_preferences:n}=e;e.notification_preferences=n.map((e=>e.id==i.id?i:e))}return e}))}})}})},async handleNotificationPreferenceSubmit({delivery_channels:e,resolver_class_name:i}){await this.$apollo.mutate({mutation:h,variables:{resolver_class_name:i,default_delivery_channels:e},update:(e,{data:{default_delivery_channels:n}})=>{let{resolvers:t}=e.readQuery({query:p,variables:this.queryVariables});t=Object.assign([],t),t=t.map((e=>(e.class_name===i&&((e=Object.assign({},e)).default_delivery_channels=n),e))),e.writeQuery({query:p,variables:this.queryVariables,data:{resolvers:t}})}}),this.deliveryPreferenceModal.open=!1},async statusToggle({value:e,resolver:i}){await this.$apollo.mutate({mutation:g,variables:{resolver_class_name:i.class_name,extended_context:{context_id:this.contextId,component:this.extendedContext.component,area:this.extendedContext.area,item_id:this.extendedContext.itemId},is_enabled:e},update:(n,{data:{notifiable_event:t}})=>{const{resolvers:a}=n.readQuery({query:p,variables:this.queryVariables}),{notification_preferences:r}=i;n.writeQuery({query:p,variables:this.queryVariables,data:{resolvers:a.map((i=>(i.class_name===t.class_name&&((i=Object.assign({},i)).status=Object.assign({},i.status,{is_enabled:e,__typename:i.status.__typename}),i.notification_preferences=r.map((e=>e))),i)))}})}})}}},V=C,S=function(e){e.options.__langStrings={core:["delete"],totara_notification:["create_custom_notification_title","delete_confirm_title","delete_confirm_message","delete_success","edit_delivery_preferences","edit_notification","saved_notification","updated_notification"]}};var T=(0,n("wWJ2").Z)(V,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("Loader",{staticClass:"tui-notifications",attrs:{loading:e.$apollo.loading}},[e.$apollo.loading?e._e():n("div",[n("NotificationTable",{staticClass:"tui-notifications__table",attrs:{"event-resolvers":e.eventResolvers,"context-id":parseInt(e.contextId),"extended-context":e.extendedContext,"show-delivery-preference-option":e.canChangeDeliveryChannelDefaults},on:{"status-toggle":e.statusToggle,"create-custom-notification":e.handleCreateCustomNotification,"edit-notification":e.handleEditNotification,"delete-notification":e.confirmDeleteNotification,"update-delivery-preferences":e.handleUpdateDeliveryPreferences}})],1),e._v(" "),n("div",{staticClass:"tui-notifications__modals"},[n("ModalPresenter",{attrs:{open:e.modal.open},on:{"request-close":function(i){e.modal.open=!1},"close-complete":e.resetState}},[n("NotificationPreferenceModal",{attrs:{"context-id":e.contextId,"extended-context":e.extendedContext,"resolver-class-name":e.targetResolverClassName,preference:e.targetPreference||void 0,"parent-value":e.targetPreference?e.targetPreference.parent_value:null,title:e.modal.title,"valid-schedule-types":e.targetScheduleTypes,"available-recipients":e.targetAvailableRecipients,"default-delivery-channels":e.targetDefaultDeliveryChannels,"additional-criteria-component":e.targetadditionalCriteriaComponent,"preferred-editor-format":null!==e.preferredEditorFormat?Number(e.preferredEditorFormat):null},on:{"form-submit":e.handleFormSubmit}})],1),e._v(" "),n("DeleteConfirmationModal",{attrs:{open:e.deleteModal.open,title:e.deleteNotificationTitle,"confirm-button-text":e.$str("delete","core"),loading:e.deleting},on:{confirm:e.deleteNotification,cancel:function(i){e.deleteModal.open=!1}}},[[n("p",[e._v(e._s(e.$str("delete_confirm_message","totara_notification")))])]],2),e._v(" "),e.canChangeDeliveryChannelDefaults?n("ModalPresenter",{attrs:{open:e.deliveryPreferenceModal.open},on:{"request-close":function(i){e.deliveryPreferenceModal.open=!1},"close-complete":e.resetState}},[n("DeliveryPreferenceModal",{attrs:{"context-id":e.contextId,"resolver-class-name":e.targetResolverClassName,"resolver-label":e.targetResolverLabel,"default-delivery-channels":e.targetDefaultDeliveryChannels,"additional-criteria-component":e.targetadditionalCriteriaComponent,title:e.$str("edit_delivery_preferences","totara_notification")},on:{"form-submit":e.handleNotificationPreferenceSubmit}})],1):e._e()],1)])}),[],!1,null,null,null);S(T),T.options.__hasBlocks={script:!0,template:!0};const D=T.exports},zmis:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>m});var t=n("3NWB"),a=n.n(t),r=n("6e83"),l=n.n(r),d=n("uJnX"),o=n.n(d);const s={components:{DropdownItem:l(),Dropdown:a(),MoreIcon:o()},props:{resolverName:{type:String,required:!0},showDeliveryPreferenceOption:Boolean,showCreateNotificationOption:{type:Boolean,default:!0},canAudit:Boolean,canManage:Boolean,extendedContext:Object,contextId:Number,resolverClassName:String},computed:{auditParams(){let e={context_id:this.contextId};return this.extendedContext&&this.extendedContext.component&&this.extendedContext.area&&this.extendedContext.itemId&&(e.component=this.extendedContext.component,e.area=this.extendedContext.area,e.item_id=this.extendedContext.itemId),this.resolverClassName&&(e.resolver_class_name=this.resolverClassName),e}}},c=function(e){e.options.__langStrings={totara_notification:["actions_for_event","create_notification","create_notification_for_event","edit_delivery_preferences","delivery_preferences_for_event","viewnotificationlogs"]}};var u=(0,n("wWJ2").Z)(s,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("div",{staticClass:"tui-notifiableEventAction"},[n("Dropdown",{scopedSlots:e._u([{key:"trigger",fn:function(i){var t=i.toggle,a=i.isOpen;return[n("MoreIcon",{attrs:{"aria-expanded":a?"true":"false","aria-label":e.$str("actions_for_event","totara_notification",e.resolverName),"no-padding":!0,size:300},on:{click:t}})]}}])},[e._v(" "),e.showCreateNotificationOption&&e.canManage?n("DropdownItem",{attrs:{"aria-label":e.$str("create_notification_for_event","totara_notification",e.resolverName)},on:{click:function(i){return e.$emit("create-custom-notification")}}},[e._v("\n      "+e._s(e.$str("create_notification","totara_notification"))+"\n    ")]):e._e(),e._v(" "),e.showDeliveryPreferenceOption&&e.canManage?n("DropdownItem",{attrs:{"aria-label":e.$str("delivery_preferences_for_event","totara_notification",e.resolverName)},on:{click:function(i){return e.$emit("update-delivery-preferences")}}},[e._v("\n      "+e._s(e.$str("edit_delivery_preferences","totara_notification"))+"\n    ")]):e._e(),e._v(" "),e.canAudit?n("DropdownItem",{attrs:{href:e.$url("/totara/notification/notification_event_log.php",e.auditParams)}},[e._v("\n      "+e._s(e.$str("viewnotificationlogs","totara_notification"))+"\n    ")]):e._e()],1)],1)}),[],!1,null,null,null);c(u),u.options.__hasBlocks={script:!0,template:!0};const m=u.exports},NZE1:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>_});var t=n("3NWB"),a=n.n(t),r=n("1+j7"),l=n.n(r),d=n("uJnX"),o=n.n(d),s=n("6e83"),c=n.n(s);const u={components:{Dropdown:a(),ButtonIcon:l(),MoreIcon:o(),DropdownItem:c()},props:{preferenceTitle:{type:String,required:!0},isDeletable:{type:Boolean,required:!0}}},m=function(e){e.options.__langStrings={core:["edit","delete"],totara_notification:["edit_notification_name","actions_for","delete_notification_name"]}};var v=(0,n("wWJ2").Z)(u,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("div",{staticClass:"tui-notificationAction"},[n("Dropdown",{scopedSlots:e._u([{key:"trigger",fn:function(i){var t=i.toggle,a=i.isOpen;return[n("ButtonIcon",{attrs:{"aria-expanded":a?"true":"false","aria-label":e.$str("actions_for","totara_notification",e.preferenceTitle),styleclass:{small:!0,transparentNoPadding:!0}},on:{click:t}},[n("MoreIcon",{attrs:{size:300}})],1)]}}])},[e._v(" "),n("DropdownItem",{attrs:{title:e.$str("edit_notification_name","totara_notification",e.preferenceTitle),"aria-label":e.$str("edit_notification_name","totara_notification",e.preferenceTitle)},on:{click:function(i){return e.$emit("edit-notification")}}},[e._v("\n      "+e._s(e.$str("edit","core"))+"\n    ")]),e._v(" "),e.isDeletable?n("DropdownItem",{attrs:{title:e.$str("delete_notification_name","totara_notification",e.preferenceTitle),"aria-label":e.$str("delete_notification_name","totara_notification",e.preferenceTitle)},on:{click:function(i){return e.$emit("delete-notification")}}},[e._v("\n      "+e._s(e.$str("delete","core"))+"\n    ")]):e._e()],1)],1)}),[],!1,null,null,null);m(v),v.options.__hasBlocks={script:!0,template:!0};const _=v.exports},D67c:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>T});var t=n("RJ4J"),a=n.n(t),r=n("Lo/q"),l=n.n(r),d=n("BDBh"),o=n.n(d),s=n("hAGe"),c=n.n(s);const u=tui.require("tui/components/form/Form");var m=n.n(u),v=n("2XTD"),_=n.n(v),k=n("eHBv"),p=n.n(k),f=n("IpiT"),b=n.n(f),N=n("ddQy"),y=n.n(N),h=n("gu2O"),g=n.n(h),x=n("cBHR");function F(e){const i={};return e.map((({component:e,is_enabled:n})=>{i[e]=n})),i}const C={components:{Table:o(),HeaderCell:l(),Cell:a(),Checkbox:c(),Form:m(),FormRow:_(),ButtonGroup:p(),Button:b(),Cancel:y(),InfoIconButton:g()},props:{defaultDeliveryChannels:{type:Array,required:!0,validator:(0,x.ov)()},showOverride:Boolean,initialOverrideStatus:Boolean},data(){return{deliveryChannels:F(this.defaultDeliveryChannels),isCheckboxDisabled:this.selectionsDisabled(),isDeliveryPreferenceOverridden:this.initialOverrideStatus}},watch:{isDeliveryPreferenceOverridden(){this.isCheckboxDisabled=this.selectionsDisabled()}},methods:{handleFormSubmit(){const e=[];for(const i in this.deliveryChannels)this.deliveryChannels[i]&&e.push(i);this.$emit("form-submit",e,this.showOverride?this.isDeliveryPreferenceOverridden:null)},selectionsDisabled(){return!(!this.showOverride||(void 0!==this.isDeliveryPreferenceOverridden||this.initialOverrideStatus)&&(void 0===this.isDeliveryPreferenceOverridden||this.isDeliveryPreferenceOverridden))},overrideDeliveryPreference(e){this.isDeliveryPreferenceOverridden=e}}},V=function(e){e.options.__langStrings={totara_notification:["delivery_preferences_helptext","delivery_preferences_helptext_aria","notification_delivery_channels_label","unavailable","delivery_preferences_override_helptext","delivery_preferences_override_helptext_aria","override","override_delivery_channels_aria"],totara_core:["save"],core:["required"]}};var S=(0,n("wWJ2").Z)(C,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("Form",{staticClass:"tui-notificationDeliveryPreferenceForm",on:{submit:e.handleFormSubmit}},[e.showOverride?n("div",{staticClass:"tui-notificationDeliveryPreferenceForm__overrideWrapper"},[n("Checkbox",{attrs:{"aria-label":e.$str("override_delivery_channels_aria","totara_notification"),checked:e.isDeliveryPreferenceOverridden,value:e.isDeliveryPreferenceOverridden?"1":"0",name:"override_delivery_preferences"},on:{change:e.overrideDeliveryPreference}},[e._v("\n      "+e._s(e.$str("override","totara_notification"))+"\n    ")]),e._v(" "),n("InfoIconButton",{attrs:{"aria-label":e.$str("delivery_preferences_override_helptext_aria","totara_notification")}},[e._v("\n      "+e._s(e.$str("delivery_preferences_override_helptext","totara_notification"))+"\n    ")])],1):e._e(),e._v(" "),n("Table",{attrs:{data:e.defaultDeliveryChannels,"expandable-rows":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[n("HeaderCell",{staticClass:"tui-notificationDeliveryPreferenceForm__tableHeader",attrs:{size:"3"}},[e._v("\n        "+e._s(e.$str("notification_delivery_channels_label","totara_notification"))+"\n        "),e.showOverride?e._e():n("InfoIconButton",{attrs:{"aria-label":e.$str("delivery_preferences_helptext_aria","totara_notification")}},[e._v("\n          "+e._s(e.$str("delivery_preferences_helptext","totara_notification"))+"\n        ")])],1)]},proxy:!0},{key:"row",fn:function(i){var t=i.row;return[n("Cell",{attrs:{size:"3"}},[e._v("\n        "+e._s(t.label)+"\n      ")]),e._v(" "),n("Cell",[!t.parent_component||e.deliveryChannels[t.parent_component]?n("Checkbox",{attrs:{"aria-label":t.label,disabled:e.isCheckboxDisabled,name:"default_"+t.component},model:{value:e.deliveryChannels[t.component],callback:function(i){e.$set(e.deliveryChannels,t.component,i)},expression:"deliveryChannels[row.component]"}}):[e._v("\n          "+e._s(e.$str("unavailable","totara_notification"))+"\n        ")]],2)]}}])}),e._v(" "),n("FormRow",[n("ButtonGroup",{staticClass:"tui-notificationPreferenceForm__buttonGroup"},[n("Button",{attrs:{styleclass:{primary:!0},text:e.$str("save","totara_core"),type:"submit"}}),e._v(" "),n("Cancel",{on:{click:function(i){return e.$emit("cancel")}}})],1)],1)],1)}),[],!1,null,null,null);V(S),S.options.__hasBlocks={script:!0,template:!0};const T=S.exports},"/iLc":(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>E});const t=tui.require("tui/components/uniform");var a=n("2XTD"),r=n.n(a);const l=tui.require("tui/components/form/Radio");var d=n.n(l);const o=tui.require("tui/components/form/RadioNumberInput");var s=n.n(o);const c=tui.require("tui/editor"),u=tui.require("tui/components/editor/Editor");var m=n.n(u),v=n("eHBv"),_=n.n(v),k=n("IpiT"),p=n.n(k),f=n("ddQy"),b=n.n(f),N=n("cBHR");const y=tui.require("totara_notification/components/form/field/ForceDeliveryChannels");var h=n.n(y),g=n("hAGe"),x=n.n(g),F=n("oT0J"),C=n.n(F);const V={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_validate_notification_preference_input"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"totara_notification_validate_notification_preference_input"},arguments:[{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"Argument",name:{kind:"Name",value:"body"},value:{kind:"Variable",name:{kind:"Name",value:"body"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_type"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_offset"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"field_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error_message"},arguments:[],directives:[]}]}}]}}]};function S(e,i,n){const t={subject:{value:void 0,type:c.EditorContent},body:{value:void 0,type:c.EditorContent},title:{value:i&&i.title?i.title:e.title,type:"text"},additional_criteria:!i||e.overridden_additional_criteria?e.additional_criteria?JSON.parse(e.additional_criteria):null:i.additional_criteria?JSON.parse(i.additional_criteria):null,schedule_type:{value:!i||e.overridden_schedule?e.schedule_type:i.schedule_type,type:"text"},schedule_offset:{[N.Fp.BEFORE_EVENT]:1,[N.Fp.AFTER_EVENT]:1,[N.Fp.ON_EVENT]:0,type:"number"},recipients:!i||e.overridden_recipient?e.recipients?e.recipients.map((e=>e.class_name)):[]:i.recipients?i.recipients.map((e=>e.class_name)):[],enabled:{value:!i||e.overridden_enabled?e.enabled:i.enabled},forced_delivery_channels:{value:!i||e.forced_delivery_channels?e.forced_delivery_channels:i.forced_delivery_channels||[],type:"array"}};t.schedule_type.value!==N.Fp.ON_EVENT&&(t.schedule_offset[t.schedule_type.value]=null===i||e.overridden_schedule?e.schedule_offset:i.schedule_offset);let a=n,r=n;return!i||e.overridden_subject?(null!==e.subject_format&&(r=e.subject_format),t.subject.value=new c.EditorContent({format:r,content:e.subject})):(null!==i.subject_format&&(r=i.subject_format),t.subject.value=new c.EditorContent({format:r,content:i.subject})),!i||e.overridden_body?(null!==e.body_format&&(a=e.body_format),t.body.value=new c.EditorContent({format:a,content:e.body})):(null!==i.body_format&&(a=i.body_format),t.body.value=new c.EditorContent({format:a,content:i.body})),t}const T={components:{Uniform:t.Uniform,FormCheckbox:t.FormCheckbox,FormCheckboxGroup:t.FormCheckboxGroup,FormField:t.FormField,FormRow:r(),FormScope:t.FormScope,FormText:t.FormText,Editor:m(),ButtonGroup:_(),Button:p(),Cancel:b(),FormRadioGroup:t.FormRadioGroup,Radio:d(),RadioNumberInput:s(),FormRadioWithInput:t.FormRadioWithInput,FormSelect:t.FormSelect,ForceDeliveryChannels:h(),Checkbox:x(),ToggleSwitch:C()},props:{resolverClassName:{type:String,required:!0},contextId:{type:Number,required:!0},extendedContext:{type:Object,required:!1},parentValue:{type:Object,validator:(0,N.ku)(),default:()=>null},preference:{type:Object,validator:(0,N.ku)(["body_content","subject_content"]),default:(0,N.AG)({body_content:"",subject_content:""})},validScheduleTypes:{type:Array,required:!0},availableRecipients:{type:Array,required:!0,validator:(0,N._K)()},defaultDeliveryChannels:{type:Array,required:!0,validator:(0,N.ov)()},additionalCriteriaComponent:{type:String},preferredEditorFormat:Number},data(){return{customisation:{additional_criteria:this.preference.overridden_additional_criteria||Boolean(!this.parentValue),body:this.preference.overridden_body||Boolean(!this.parentValue),subject:this.preference.overridden_subject||Boolean(!this.parentValue),schedule:this.preference.overridden_schedule||Boolean(!this.parentValue),recipients:this.preference.overridden_recipient||Boolean(!this.parentValue),enabled:this.preference.overridden_enabled||Boolean(!this.parentValue),forcedDeliveryChannels:this.preference.overridden_forced_delivery_channels||Boolean(!this.parentValue)},errors:null,formInitialValues:S(this.preference,this.parentValue,this.preferredEditorFormat),saving:!1,scheduleTypes:N.Fp}},computed:{hasAdditionalCriteriaComponent(){return this.additionalCriteriaComponent&&""!==this.additionalCriteriaComponent},additionalCriteriaComponentResolved(){return tui.asyncComponent(this.additionalCriteriaComponent)},disableTitleField(){return!!this.parentValue&&this.parentValue.title&&""!==this.parentValue.title},requiredSubject(){return!this.parentValue||!this.parentValue.subject||""===this.parentValue.subject},requiredBody(){return!this.parentValue||!this.parentValue.body||""===this.parentValue.body},showCustomCheckBoxes(){return!!this.parentValue},showScheduleOnEvent(){return this.validScheduleTypes.indexOf(N.Fp.ON_EVENT)>=0},showScheduleBeforeEvent(){return this.validScheduleTypes.indexOf(N.Fp.BEFORE_EVENT)>=0},showScheduleAfterEvent(){return this.validScheduleTypes.indexOf(N.Fp.AFTER_EVENT)>=0},recipientOptions(){return this.availableRecipients.map((e=>({id:e.class_name,label:e.name})))}},watch:{customisation:{deep:!0,handler(e){if(!this.showCustomCheckBoxes||!this.$refs.preferenceForm)return;if(!this.parentValue)throw new Error("Cannot toggle the customisation when the parent preference is not passed down to the form");const{preferenceForm:i}=this.$refs;e.additional_criteria||i.update(["additional_criteria"],this.parentValue.additional_criteria?JSON.parse(this.parentValue.additional_criteria):null),e.recipients||i.update(["recipients"],this.parentValue.recipients.map((e=>e.class_name))),e.schedule||(i.update(["schedule_type","value"],this.parentValue.schedule_type),this.parentValue.schedule_type!=this.scheduleTypes.ON_EVENT&&i.update(["schedule_offset",this.parentValue.schedule_type],this.parentValue.schedule_offset)),e.subject||i.update(["subject","value"],new c.EditorContent({content:this.parentValue.subject,format:this.parentValue.subject_format?this.parentValue.subject_format:this.formInitialValues.subject.value.format})),e.body||i.update(["body","value"],new c.EditorContent({content:this.parentValue.body,format:this.parentValue.body_format?this.parentValue.body_format:this.formInitialValues.body.value.format})),e.forcedDeliveryChannels||i.update(["forced_delivery_channels","value"],this.parentValue.forced_delivery_channels||[]),e.enabled||i.update(["enabled","value"],this.parentValue.enabled)}}},methods:{validateBodyEditor(e){return!this.requiredBody||e&&!e.isEmpty?"":this.$str("required","core")},validateSubjectEditor(e){return!this.requiredSubject||e&&!e.isEmpty?"":this.$str("required","core")},async submitForm(e){this.saving=!0,this.errors||(this.errors=null);const{data:{result:i}}=await this.$apollo.mutate({mutation:V,variables:{title:e.title.value||"",subject:e.subject.value.getContent()||"",body:e.body.value.getContent()||"",schedule_type:e.schedule_type.value||"",schedule_offset:parseInt(e.schedule_offset[e.schedule_type.value])||0}});if(i.length)return this.errors={},i.forEach((({field_name:e,error_message:i})=>{this.errors[e]={value:i}})),void(this.saving=!1);const n={title:e.title.value,additional_criteria:this.customisation.additional_criteria?JSON.stringify(e.additional_criteria):null,subject:this.customisation.subject?e.subject.value.getContent():null,subject_format:this.customisation.subject?e.subject.value.format:null,body:this.customisation.body?e.body.value.getContent():null,body_format:this.customisation.body?e.body.value.format:null,schedule_type:this.customisation.schedule?e.schedule_type.value:null,schedule_offset:this.customisation.schedule?e.schedule_offset[e.schedule_type.value]:null,recipients:this.customisation.recipients?e.recipients:null,enabled:this.customisation.enabled?e.enabled.value:null,forced_delivery_channels:this.customisation.forcedDeliveryChannels?e.forced_delivery_channels.value:null};this.$emit("submit",n)},updateBodyEditor(e,i){this.errors&&this.errors.body&&(this.errors.body.value=""),i(e)},updateSchedule(e,i=null){this.errors&&this.errors.schedule_type&&(this.errors.schedule_type.value=""),i&&i(e)},updateSubjectEditor(e,i){this.errors&&this.errors.subject&&(this.errors.subject.value=""),i(e)},resetErrorFieldTitle(){this.errors&&this.errors.title&&(this.errors.title.value="")}}},D=function(e){e.options.__langStrings={totara_notification:["create_notification_select_placeholder","delivery_label","enable_custom_additional_criteria","enable_custom_body","enable_custom_forced_delivery_channels","enable_custom_recipient","enable_custom_schedule","enable_custom_status","enable_custom_subject","notification_body_label","notification_body_label_help","notification_schedule_label","notification_status","notification_status_label","notification_subject_label","notification_subject_label_help","notification_title_label","override","recipient","schedule_form_label_after_event","schedule_form_label_before_event","schedule_form_label_on_event","schedule_label_after_event","schedule_label_before_event"],totara_core:["enabled","save"],core:["required"]}};var j=(0,n("wWJ2").Z)(T,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return e.formInitialValues?n("Uniform",{ref:"preferenceForm",staticClass:"tui-notificationPreferenceForm",attrs:{"initial-values":e.formInitialValues,errors:e.errors,"input-width":"full"},on:{submit:e.submitForm}},[n("FormRow",{attrs:{label:e.$str("notification_title_label","totara_notification"),required:!e.parentValue||!e.parentValue.title||""===e.parentValue.title},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.id;return[n("FormText",{attrs:{id:t,name:["title","value"],disabled:e.disableTitleField,validations:function(e){return[e.required()]}},on:{input:e.resetErrorFieldTitle}})]}}],null,!1,2380982492)}),e._v(" "),e.hasAdditionalCriteriaComponent?n("FormScope",{attrs:{path:"additional_criteria"}},[n(e.additionalCriteriaComponentResolved,{tag:"component",attrs:{disabled:e.showCustomCheckBoxes&&!e.customisation.additional_criteria,required:!e.parentValue,"context-id":e.contextId,"extended-context":e.extendedContext}},[e.showCustomCheckBoxes?n("ToggleSwitch",{staticClass:"tui-notificationPreferenceForm__overide",attrs:{slot:"override-toggle","aria-label":e.$str("enable_custom_additional_criteria","totara_notification")},slot:"override-toggle",model:{value:e.customisation.additional_criteria,callback:function(i){e.$set(e.customisation,"additional_criteria",i)},expression:"customisation.additional_criteria"}}):e._e()],1)],1):e._e(),e._v(" "),n("FormRow",{attrs:{label:e.$str("recipient","totara_notification"),required:!e.parentValue,"is-stacked":!1},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.id;return[n("FormCheckboxGroup",{attrs:{"aria-labelledby":t,disabled:e.showCustomCheckBoxes&&!e.customisation.recipients,name:"recipients",validations:function(e){return[e.required()]}}},e._l(e.recipientOptions,(function(i){return n("Checkbox",{key:i.id,attrs:{id:i.id,disabled:e.showCustomCheckBoxes&&!e.customisation.recipients,value:i.id}},[e._v("\n          "+e._s(i.label)+"\n        ")])})),1),e._v(" "),e.showCustomCheckBoxes?n("ToggleSwitch",{staticClass:"tui-notificationPreferenceForm__overide",attrs:{"aria-label":e.$str("enable_custom_recipient","totara_notification")},model:{value:e.customisation.recipients,callback:function(i){e.$set(e.customisation,"recipients",i)},expression:"customisation.recipients"}}):e._e()]}}],null,!1,368860120)}),e._v(" "),n("FormRow",{attrs:{label:e.$str("notification_schedule_label","totara_notification"),required:!e.parentValue,"is-stacked":!1},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.id;return[n("FormRadioGroup",{attrs:{"aria-labelledby":t,disabled:e.showCustomCheckBoxes&&!e.customisation.schedule,validations:function(e){return[e.required()]},name:["schedule_type","value"]},on:{input:function(i){return e.updateSchedule(i)}}},[e.showScheduleOnEvent?n("Radio",{attrs:{value:e.scheduleTypes.ON_EVENT}},[e._v("\n          "+e._s(e.$str("schedule_form_label_on_event","totara_notification"))+"\n        ")]):e._e(),e._v(" "),e.showScheduleBeforeEvent?n("FormRadioWithInput",{attrs:{disabled:e.showCustomCheckBoxes&&!e.customisation.schedule,name:["schedule_offset",e.scheduleTypes.BEFORE_EVENT],value:e.scheduleTypes.BEFORE_EVENT,text:e.$str("schedule_form_label_before_event","totara_notification")},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.disabledRadio,a=i.nameLabel,r=i.setAccessibleLabel,l=i.update,d=i.value;return[n("RadioNumberInput",{attrs:{disabled:t,name:a,value:d},on:{input:function(i){return e.updateSchedule(i,l)},"accessible-change":function(i){return r(e.$str("schedule_label_before_event","totara_notification",i))}}})]}}],null,!0)}):e._e(),e._v(" "),e.showScheduleAfterEvent?n("FormRadioWithInput",{attrs:{disabled:e.showCustomCheckBoxes&&!e.customisation.schedule,name:["schedule_offset",e.scheduleTypes.AFTER_EVENT],value:e.scheduleTypes.AFTER_EVENT,text:e.$str("schedule_form_label_after_event","totara_notification")},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.disabledRadio,a=i.nameLabel,r=i.setAccessibleLabel,l=i.update,d=i.value;return[n("RadioNumberInput",{attrs:{disabled:t,name:a,value:d},on:{input:function(i){return e.updateSchedule(i,l)},"accessible-change":function(i){return r(e.$str("schedule_label_after_event","totara_notification",i))}}})]}}],null,!0)}):e._e()],1),e._v(" "),e.showCustomCheckBoxes?n("ToggleSwitch",{staticClass:"tui-notificationPreferenceForm__overide",attrs:{"aria-label":e.$str("enable_custom_schedule","totara_notification")},model:{value:e.customisation.schedule,callback:function(i){e.$set(e.customisation,"schedule",i)},expression:"customisation.schedule"}}):e._e()]}}],null,!1,906495918)}),e._v(" "),n("FormRow",{attrs:{label:e.$str("delivery_label","totara_notification"),"is-stacked":!1},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.id;return[n("FormField",{attrs:{name:["forced_delivery_channels","value"]},scopedSlots:e._u([{key:"default",fn:function(i){var a=i.value,r=i.update;return[n("ForceDeliveryChannels",{attrs:{"aria-labelledby":t,"default-delivery-channels":e.defaultDeliveryChannels,"forced-delivery-channels":a,disabled:e.showCustomCheckBoxes&&!e.customisation.forcedDeliveryChannels},on:{"update-forced-delivery-channels":r}})]}}],null,!0)}),e._v(" "),e.showCustomCheckBoxes?n("ToggleSwitch",{staticClass:"tui-notificationPreferenceForm__overide",attrs:{"aria-label":e.$str("enable_custom_forced_delivery_channels","totara_notification")},model:{value:e.customisation.forcedDeliveryChannels,callback:function(i){e.$set(e.customisation,"forcedDeliveryChannels",i)},expression:"customisation.forcedDeliveryChannels"}}):e._e()]}}],null,!1,874442933)}),e._v(" "),n("FormRow",{attrs:{label:e.$str("notification_subject_label","totara_notification"),required:e.requiredSubject,helpmsg:e.$str("notification_subject_label_help","totara_notification"),"is-stacked":!1},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.id;return[n("FormField",{attrs:{name:["subject","value"],validate:e.validateSubjectEditor,disabled:e.showCustomCheckBoxes&&!e.customisation.subject,"char-length":"full"},scopedSlots:e._u([{key:"default",fn:function(i){var a=i.value,r=i.update;return[n("Editor",{staticClass:"tui-notificationPreferenceForm__subjectEditor",attrs:{id:t,disabled:!e.customisation.subject,value:a,"context-id":e.contextId,"usage-identifier":{component:"totara_notification",area:"notification_subject"},"extra-extensions":[{name:"notification_placeholder_extension",options:{resolver_class_name:e.resolverClassName}},{name:"simple_multi_lang_extension",options:{context_id:e.contextId,placeholder_resolver_class_name:e.resolverClassName,compact:!0}}],variant:"simple",compact:!0},on:{input:function(i){return e.updateSubjectEditor(i,r)}}})]}}],null,!0)}),e._v(" "),e.showCustomCheckBoxes?n("ToggleSwitch",{staticClass:"tui-notificationPreferenceForm__overide",attrs:{"aria-label":e.$str("enable_custom_subject","totara_notification")},model:{value:e.customisation.subject,callback:function(i){e.$set(e.customisation,"subject",i)},expression:"customisation.subject"}}):e._e()]}}],null,!1,199319487)}),e._v(" "),n("FormRow",{attrs:{required:e.requiredBody,label:e.$str("notification_body_label","totara_notification"),helpmsg:e.$str("notification_body_label_help","totara_notification"),"is-stacked":!1},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.id;return[n("FormField",{attrs:{name:["body","value"],validate:e.validateBodyEditor,disabled:e.showCustomCheckBoxes&&!e.customisation.body,"char-length":"full"},scopedSlots:e._u([{key:"default",fn:function(i){var a=i.value,r=i.update;return[n("Editor",{staticClass:"tui-notificationPreferenceForm__bodyEditor",attrs:{id:t,value:a,"context-id":e.contextId,disabled:!e.customisation.body,"usage-identifier":{component:"totara_notification",area:"notification_body"},"extra-extensions":[{name:"weka_notification_placeholder_extension",options:{resolver_class_name:e.resolverClassName}},{name:"weka_simple_multi_lang_extension",options:{context_id:e.contextId,placeholder_resolver_class_name:e.resolverClassName}}],variant:"description"},on:{input:function(i){return e.updateBodyEditor(i,r)}}})]}}],null,!0)}),e._v(" "),e.showCustomCheckBoxes?n("ToggleSwitch",{staticClass:"tui-notificationPreferenceForm__overide",attrs:{"aria-label":e.$str("enable_custom_body","totara_notification")},model:{value:e.customisation.body,callback:function(i){e.$set(e.customisation,"body",i)},expression:"customisation.body"}}):e._e()]}}],null,!1,81757329)}),e._v(" "),n("FormRow",{attrs:{label:e.$str("notification_status_label","totara_notification"),"is-stacked":!1},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.id;return[n("FormCheckbox",{attrs:{id:t,"aria-label":e.$str("notification_status","totara_notification"),name:["enabled","value"],disabled:e.showCustomCheckBoxes&&!e.customisation.enabled}},[e._v("\n      "+e._s(e.$str("enabled","totara_core"))+"\n    ")]),e._v(" "),e.showCustomCheckBoxes?n("ToggleSwitch",{staticClass:"tui-notificationPreferenceForm__overide",attrs:{"aria-label":e.$str("enable_custom_status","totara_notification")},model:{value:e.customisation.enabled,callback:function(i){e.$set(e.customisation,"enabled",i)},expression:"customisation.enabled"}}):e._e()]}}],null,!1,4292030555)}),e._v(" "),n("FormRow",[n("ButtonGroup",{staticClass:"tui-notificationPreferenceForm__buttonGroup"},[n("Button",{attrs:{styleclass:{primary:!0},text:e.$str("save","totara_core"),"aria-label":e.$str("save","totara_core"),loading:e.saving,type:"submit"}}),e._v(" "),n("Cancel",{attrs:{disabled:e.saving},on:{click:function(i){return e.$emit("cancel")}}})],1)],1)],1):e._e()}),[],!1,null,null,null);D(j),j.options.__hasBlocks={script:!0,template:!0};const E=j.exports},JG7t:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>y});var t=n("BDBh"),a=n.n(t),r=n("Lo/q"),l=n.n(r),d=n("RJ4J"),o=n.n(d),s=n("cBHR");const c=tui.require("tui/components/icons/CheckSuccess");var u=n.n(c),m=n("hAGe"),v=n.n(m),_=n("gu2O"),k=n.n(_);const p={components:{Table:a(),HeaderCell:l(),Cell:o(),CheckSuccess:u(),Checkbox:v(),InfoIconButton:k()},props:{disabled:Boolean,defaultDeliveryChannels:{type:Array,required:!0,validator:(0,s.ov)()},forcedDeliveryChannels:{type:Array,default:()=>[],validator:e=>e.every((e=>"string"==typeof e))}},methods:{isForced({component:e}){return!!this.forcedDeliveryChannels.find((i=>e===i))},isChannelAvailable(e){if(!e)return!0;const i=this.defaultDeliveryChannels.find((({component:i})=>i===e));return!i||i.is_enabled||this.isForced({component:e})},updateForceDeliveryChannels(e,i){const n=this.forcedDeliveryChannels;if(i)return n.find((i=>e===i))?void this.$emit("update-forced-delivery-channels",n):void this.$emit("update-forced-delivery-channels",n.concat([e]));this.$emit("update-forced-delivery-channels",n.filter((i=>i!==e)))}}},f=p,b=function(e){e.options.__langStrings={totara_notification:["delivery_channel","force_channel_x","forced","forced_info","forced_delivery_help"],core:["default","notavailable"]}};var N=(0,n("wWJ2").Z)(f,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("Table",{staticClass:"tui-forceDeliveryChannels",attrs:{data:e.defaultDeliveryChannels,"stack-at":350},scopedSlots:e._u([{key:"header-row",fn:function(){return[n("HeaderCell",[e._v("\n      "+e._s(e.$str("delivery_channel","totara_notification"))+"\n    ")]),e._v(" "),n("HeaderCell",{attrs:{align:"center"}},[e._v("\n      "+e._s(e.$str("default","core"))+"\n    ")]),e._v(" "),n("HeaderCell",{attrs:{align:"center"}},[n("div",{staticClass:"tui-forceDeliveryChannels__forcedHeader"},[e._v("\n        "+e._s(e.$str("forced","totara_notification"))+"\n        "),n("InfoIconButton",{attrs:{"aria-label":e.$str("forced_info","totara_notification")}},[e._v("\n          "+e._s(e.$str("forced_delivery_help","totara_notification"))+"\n        ")])],1)])]},proxy:!0},{key:"row",fn:function(i){var t=i.row,a=t.label,r=t.is_enabled,l=t.component,d=t.is_sub_delivery_channel,o=t.parent_component;return[n("Cell",[e._v("\n      "+e._s(a)+"\n    ")]),e._v(" "),n("Cell",{attrs:{align:"center","column-header":e.$str("default","core")}},[r?n("CheckSuccess"):e._e()],1),e._v(" "),n("Cell",{attrs:{align:"center","column-header":e.$str("forced","totara_notification")}},[!d||e.isChannelAvailable(o)?[n("Checkbox",{attrs:{value:l,checked:e.isForced({component:l}),"aria-label":e.$str("force_channel_x","totara_notification",a),disabled:e.disabled,name:"force_"+l},on:{change:function(i){return e.updateForceDeliveryChannels(l,i)}}})]:[e._v("\n        "+e._s(e.$str("notavailable","core"))+"\n      ")]],2)]}}])})}),[],!1,null,null,null);b(N),N.options.__hasBlocks={script:!0,template:!0};const y=N.exports},aGEQ:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>l});var t=n("EHV6");const a={components:{Popover:n.n(t)()},props:{placeholderKey:{type:String,required:!0},displayName:{type:String,required:!0}}};var r=(0,n("wWJ2").Z)(a,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("Popover",{staticClass:"tui-placeholder",attrs:{"data-key":e.placeholderKey,"data-label":e.displayName,triggers:["hover"]},scopedSlots:e._u([{key:"trigger",fn:function(){return[n("span",{staticClass:"tui-placeholder__text",attrs:{slot:"trigger"},slot:"trigger"},[e._v("\n      "+e._s(e.displayName))])]},proxy:!0}])},[e._v(" "),[n("span",[e._v("\n      ["+e._s(e.placeholderKey)+"]\n    ")])]],2)}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};const l=r.exports},eMCN:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>v});var t=n("IACo"),a=n.n(t),r=n("GLpC"),l=n.n(r);const d=tui.require("totara_notification/components/form/DeliveryPreferenceForm");var o=n.n(d),s=n("cBHR");const c={components:{Modal:a(),ModalContent:l(),DeliveryPreferenceForm:o()},props:{title:{type:String,required:!0},showCloseButton:{type:Boolean,default:!0},defaultDeliveryChannels:{type:Array,required:!0,validator:(0,s.ov)()},resolverClassName:{type:String,required:!0},resolverLabel:{type:String,required:!0},showOverride:Boolean,initialOverrideStatus:Boolean},methods:{handleSubmit(e,i){const n={resolver_class_name:this.resolverClassName,delivery_channels:e};this.$emit("form-submit",n,i)}}},u=function(e){e.options.__langStrings={totara_notification:["notification_trigger"]}};var m=(0,n("wWJ2").Z)(c,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("Modal",{attrs:{size:"large","aria-labelledby":e.$id("title"),dismissable:{esc:!0,backdropClick:!0,overlayClose:!1}}},[n("ModalContent",{attrs:{title:e.title,"title-id":e.$id("title"),"close-button":e.showCloseButton}},[n("p",[e._v("\n      "+e._s(e.$str("notification_trigger","totara_notification",e.resolverLabel))+"\n    ")]),e._v(" "),n("DeliveryPreferenceForm",{attrs:{"default-delivery-channels":e.defaultDeliveryChannels,"show-override":e.showOverride,"initial-override-status":e.initialOverrideStatus},on:{"form-submit":e.handleSubmit,cancel:function(i){return e.$emit("request-close")}}})],1)],1)}),[],!1,null,null,null);u(m),m.options.__hasBlocks={script:!0,template:!0};const v=m.exports},i25Z:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>m});var t=n("IACo"),a=n.n(t),r=n("GLpC"),l=n.n(r);const d=tui.require("totara_notification/components/form/NotificationPreferenceForm");var o=n.n(d),s=n("cBHR");const c={components:{Modal:a(),ModalContent:l(),NotificationPreferenceForm:o()},props:{title:{type:String,required:!0},contextId:{type:Number,required:!0},extendedContext:{type:Object,required:!1},showCloseButton:{type:Boolean,default:!0},preference:{type:Object,validator:(0,s.ku)(),default:(0,s.AG)({body_content:"",subject_content:""})},parentValue:{type:Object,validator:(0,s.ku)(),default:()=>null},resolverClassName:{type:String,required:!0},validScheduleTypes:{type:Array,required:!0},availableRecipients:{type:Array,required:!0,validator:(0,s._K)()},defaultDeliveryChannels:{type:Array,required:!0,validator:(0,s.ov)()},additionalCriteriaComponent:{type:String},preferredEditorFormat:Number},methods:{handleSubmit(e){this.resolverClassName&&(e.resolver_class_name=this.resolverClassName),this.$emit("form-submit",e)}}};var u=(0,n("wWJ2").Z)(c,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("Modal",{attrs:{size:"large","aria-labelledby":e.$id("title"),dismissable:{esc:!0,backdropClick:!1,overlayClose:!1}}},[n("ModalContent",{attrs:{title:e.title,"title-id":e.$id("title"),"close-button":e.showCloseButton}},[n("NotificationPreferenceForm",{staticClass:"tui-notificationPreferenceModal__form",attrs:{"context-id":e.contextId,"extended-context":e.extendedContext,preference:e.preference,"parent-value":e.parentValue,"valid-schedule-types":e.validScheduleTypes,"resolver-class-name":e.resolverClassName,"available-recipients":e.availableRecipients,"default-delivery-channels":e.defaultDeliveryChannels,"additional-criteria-component":e.additionalCriteriaComponent,"preferred-editor-format":e.preferredEditorFormat},on:{submit:e.handleSubmit,cancel:function(i){return e.$emit("request-close")}}})],1)],1)}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};const m=u.exports},lAre:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>O});var t=n("IpiT"),a=n.n(t),r=n("bNBy"),l=n.n(r),d=n("j/Uj"),o=n.n(d),s=n("RJ4J"),c=n.n(s);const u=tui.require("tui/components/datatable/ExpandCell");var m=n.n(u),v=n("Lo/q"),_=n.n(v),k=n("BDBh"),p=n.n(k);const f=tui.require("totara_notification/components/action/NotificationAction");var b=n.n(f),N=n("Gies"),y=n.n(N),h=n("oT0J"),g=n.n(h),x=n("gu2O"),F=n.n(x),C=n("EHV6"),V=n.n(C),S=n("1+j7"),T=n.n(S);const D=tui.require("tui/components/icons/Warning");var j=n.n(D);const E={components:{Button:a(),Collapsible:l(),CollapsibleGroupToggle:o(),Cell:c(),ExpandCell:m(),HeaderCell:_(),Table:p(),NotificationAction:b(),NotifiableEventAction:y(),ToggleSwitch:g(),InfoIconButton:F(),Popover:V(),ButtonIcon:T(),WarningIcon:j()},props:{contextId:{type:Number,required:!0},eventResolvers:{type:Array,default:()=>[],validator:e=>e.every((e=>"component"in e&&"resolvers"in e&&"recipients"in e&&"plugin_name"in e))},extendedContext:{type:Object,default:()=>({}),validate:e=>"component"in e&&"area"in e&&"itemId"in e&&(""===e.component&&""===e.area&&0==e.itemId||""!==e.component&&""!==e.area&&0!=e.itemId)},showDeliveryPreferenceOption:Boolean},data(){const e=1===this.eventResolvers.length,i={};return e?i[this.eventResolvers[0].plugin_name]=!0:this.eventResolvers.forEach((e=>i[e.plugin_name]=!1)),{singleEventResolver:e,expanded:i}},computed:{isSystemContext(){return!(1!=this.contextId||this.extendedContext&&"component"in this.extendedContext&&""!=this.extendedContext.component)},canAudit(){return this.eventResolvers.some((e=>e.resolvers.some((e=>e.interactor.can_audit))))},auditParams(){let e={context_id:this.contextId};return this.extendedContext&&this.extendedContext.component&&this.extendedContext.area&&this.extendedContext.itemId&&(e.component=this.extendedContext.component,e.area=this.extendedContext.area,e.item_id=this.extendedContext.itemId),e}},methods:{display_delivery_channels:e=>e.filter((({is_enabled:e})=>e)).map((({label:e})=>e)).join("; "),onStatusToggle(e,i){const n={value:e,resolver:i};this.$emit("status-toggle",n)},isNaturalContext:e=>!e||!("component"in e)||""==e.component,isDefinedInThisContext(e){return e.extended_context.context_id==this.contextId&&(!(!this.isNaturalContext(e.extended_context)||!this.isNaturalContext(this.extendedContext))||!this.isNaturalContext(e.extended_context)&&!this.isNaturalContext(this.extendedContext)&&e.extended_context.component==this.extendedContext.component&&e.extended_context.area==this.extendedContext.area&&e.extended_context.item_id==this.extendedContext.itemId)},isOverride:e=>e.overridden_additional_criteria||e.overridden_body||e.overridden_enabled||e.overridden_forced_delivery_channels||e.overridden_recipient||e.overridden_schedule||e.overridden_subject,displayRecipients:e=>e.map((e=>e.name)).join(", ")}},w=function(e){e.options.__langStrings={totara_notification:["amended","notifiable_events","recipient","schedule","custom","delivery_channels","disable","disabled","delivery_preferences_helptext_aria","default_delivery_preferences_helptext","enabled","enabled_helptext","enabled_helptext_aria","enable_status","factory","inherited","notification","notifications","notification_warning","create_notification","create_notification_for_event","no_notifications","type","viewnotificationlogs"],core:["actions","status"]}};var $=(0,n("wWJ2").Z)(E,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("div",[n("div",{staticClass:"tui-notificationTable__actions"},[n("CollapsibleGroupToggle",{directives:[{name:"show",rawName:"v-show",value:!e.singleEventResolver,expression:"!singleEventResolver"}],staticClass:"tui-notificationTable__actionsExpand",attrs:{"align-end":!1,transparent:!1},model:{value:e.expanded,callback:function(i){e.expanded=i},expression:"expanded"}}),e._v(" "),e.canAudit?n("a",{staticClass:"tui-notificationTable__actionsAudit",attrs:{href:e.$url("/totara/notification/notification_event_log.php",e.auditParams)}},[e._v("\n      "+e._s(e.$str("viewnotificationlogs","totara_notification"))+"\n    ")]):e._e()],1),e._v(" "),n("div",{staticClass:"tui-notificationTable",class:{"tui-notificationTable--singleEventResolver":e.singleEventResolver}},e._l(e.eventResolvers,(function(i){return n(e.singleEventResolver?"passthrough":"Collapsible",{key:i.plugin_name,tag:"component",staticClass:"tui-notificationTable__collapsible",attrs:{label:i.plugin_name,"indent-contents":!e.singleEventResolver},model:{value:e.expanded[i.plugin_name],callback:function(n){e.$set(e.expanded,i.plugin_name,n)},expression:"expanded[eventResolver.plugin_name]"}},[n("Table",{attrs:{data:i.resolvers,"expandable-rows":!0,"expand-multiple-rows":!0,"border-bottom-hidden":!0,"hover-off":!0,"indent-expanded-contents":!0,"stealth-expanded":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[n("ExpandCell",{attrs:{hidden:!0,header:!0}}),e._v(" "),n("HeaderCell",{attrs:{size:"4"}},[e._v("\n            "+e._s(e.$str("notifiable_events","totara_notification"))+"\n          ")]),e._v(" "),n("HeaderCell",{attrs:{size:"4"}},[n("div",{staticClass:"tui-notificationTable__header"},[e._v("\n              "+e._s(e.$str("delivery_channels","totara_notification"))+"\n              "),n("InfoIconButton",{attrs:{"aria-label":e.$str("delivery_preferences_helptext_aria","totara_notification")}},[e._v("\n                "+e._s(e.$str("default_delivery_preferences_helptext","totara_notification"))+"\n              ")])],1)]),e._v(" "),n("HeaderCell",{attrs:{align:"start",size:"2"}},[n("div",{staticClass:"tui-notificationTable__header"},[e._v("\n              "+e._s(e.$str("enabled","totara_notification"))+"\n              "),n("InfoIconButton",{attrs:{"aria-label":e.$str("enabled_helptext_aria","totara_notification")}},[e._v("\n                "+e._s(e.$str("enabled_helptext","totara_notification"))+"\n              ")])],1)]),e._v(" "),n("HeaderCell",{attrs:{size:"1"}},[n("span",{staticClass:"sr-only"},[e._v("\n              "+e._s(e.$str("actions","core"))+"\n            ")])])]},proxy:!0},{key:"row",fn:function(i){var t=i.expand,a=i.expandState,r=i.row;return[n("ExpandCell",{attrs:{"aria-label":r.name,"expand-state":a,text:e.$str("notifications","totara_notification")},on:{click:function(e){return t()}}}),e._v(" "),n("Cell",{attrs:{size:"4","column-header":e.$str("notifiable_events","totara_notification")}},[e._v("\n            "+e._s(r.name)+"\n            "),r.warnings.length?n("Popover",{staticClass:"tui-notificationTable__trigger",attrs:{triggers:["click","focus"]},scopedSlots:e._u([{key:"trigger",fn:function(){return[n("ButtonIcon",{staticClass:"tui-notificationTable__triggerWarning",attrs:{styleclass:{transparentNoPadding:!0},"aria-label":e.$str("notification_warning","totara_notification")}},[n("WarningIcon")],1)]},proxy:!0}],null,!0)},[e._v(" "),n("ul",{staticClass:"tui-notificationTable__triggerWarnings"},e._l(r.warnings,(function(i,t){return n("li",{key:t},[e._v("\n                  "+e._s(i)+"\n                ")])})),0)]):e._e()],1),e._v(" "),n("Cell",{attrs:{size:"4","column-header":e.$str("delivery_channels","totara_notification")}},[e._v("\n            "+e._s(e.display_delivery_channels(r.default_delivery_channels))+"\n          ")]),e._v(" "),n("Cell",{attrs:{align:"start",size:"2","column-header":e.$str("enabled","totara_notification")}},[n("ToggleSwitch",{attrs:{"aria-label":e.$str("enable_status","totara_notification",r.name),value:r.status.is_enabled,"toggle-only":!0},on:{input:function(i){return e.onStatusToggle(i,r)}}})],1),e._v(" "),n("Cell",{attrs:{align:"end",size:"1"}},[n("NotifiableEventAction",{attrs:{"resolver-name":r.name,"show-delivery-preference-option":e.showDeliveryPreferenceOption,"can-audit":r.interactor.can_audit,"can-manage":r.interactor.can_manage,"resolver-class-name":r.class_name,"extended-context":e.extendedContext,"context-id":e.contextId},on:{"create-custom-notification":function(i){return e.$emit("create-custom-notification",{resolverClassName:r.class_name,scheduleTypes:r.valid_schedules,recipients:r.recipients,deliveryChannels:r.default_delivery_channels,additionalCriteriaComponent:r.additional_criteria_component})},"update-delivery-preferences":function(i){return e.$emit("update-delivery-preferences",{resolverClassName:r.class_name,resolverLabel:r.name,defaultDeliveryChannels:r.default_delivery_channels,additionalCriteriaComponent:r.additional_criteria_component})}}})],1)]}},{key:"expand-content",fn:function(i){var t=i.row;return[t.notification_preferences.length?e._l(t.notification_preferences,(function(i){return n("div",{key:i.id,staticClass:"tui-notificationTable__notification"},[n("div",{staticClass:"tui-notificationTable__notificationData"},[n("div",{staticClass:"tui-notificationTable__notificationUnit tui-notificationTable__notificationUnit--title"},[n("div",{staticClass:"tui-notificationTable__notificationLabel"},[e._v("\n                    "+e._s(e.$str("notification","totara_notification"))+"\n                  ")]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationContent"},[e._v("\n                    "+e._s(i.title)+"\n                  ")])]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationUnit tui-notificationTable__notificationUnit--type"},[n("div",{staticClass:"tui-notificationTable__notificationLabel"},[e._v("\n                    "+e._s(e.$str("type","totara_notification"))+"\n                  ")]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationContent"},[e.isDefinedInThisContext(i)&&i.is_custom&&null==i.parent_id?[e._v("\n                      "+e._s(e.$str("custom","totara_notification"))+"\n                    ")]:e.isDefinedInThisContext(i)&&e.isOverride(i)?[e._v("\n                      "+e._s(e.$str("amended","totara_notification"))+"\n                    ")]:e.isSystemContext?[e._v("\n                      "+e._s(e.$str("factory","totara_notification"))+"\n                    ")]:[e._v("\n                      "+e._s(e.$str("inherited","totara_notification"))+"\n                    ")]],2)]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationUnit tui-notificationTable__notificationUnit--recipient"},[n("div",{staticClass:"tui-notificationTable__notificationLabel"},[e._v("\n                    "+e._s(e.$str("recipient","totara_notification"))+"\n                  ")]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationContent"},[e._v("\n                    "+e._s(e.displayRecipients(i.recipients))+"\n                  ")])]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationUnit tui-notificationTable__notificationUnit--schedule"},[n("div",{staticClass:"tui-notificationTable__notificationLabel"},[e._v("\n                    "+e._s(e.$str("schedule","totara_notification"))+"\n                  ")]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationContent"},[e._v("\n                    "+e._s(i.schedule_label)+"\n                  ")])]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationUnit tui-notificationTable__notificationUnit--status"},[n("div",{staticClass:"tui-notificationTable__notificationLabel"},[e._v("\n                    "+e._s(e.$str("status","core"))+"\n                  ")]),e._v(" "),n("div",{staticClass:"tui-notificationTable__notificationContent"},[t.status.is_enabled?[i.enabled?[e._v("\n                        "+e._s(e.$str("enabled","totara_notification"))+"\n                      ")]:e._e(),e._v(" "),i.enabled?e._e():[e._v("\n                        "+e._s(e.$str("disabled","totara_notification"))+"\n                      ")]]:[i.enabled?[n("del",[e._v(e._s(e.$str("enabled","totara_notification")))])]:e._e(),e._v(" "),i.enabled?e._e():[n("del",[e._v(e._s(e.$str("disabled","totara_notification")))])]]],2)])]),e._v(" "),t.interactor.can_manage?n("div",{staticClass:"tui-notificationTable__notificationAction"},[n("div",{staticClass:"tui-notificationTable__notificationContent"},[n("NotificationAction",{attrs:{"preference-title":i.title,"is-deletable":e.isDefinedInThisContext(i)&&i.is_custom&&null==i.parent_id},on:{"edit-notification":function(n){return e.$emit("edit-notification",i,t.valid_schedules,t.recipients,t.default_delivery_channels,t.additional_criteria_component)},"delete-notification":function(n){return e.$emit("delete-notification",i)}}})],1)]):e._e()])})):[e._v("\n            "+e._s(e.$str("no_notifications","totara_notification"))+"\n\n            "),t.interactor.can_manage?n("Button",{attrs:{text:e.$str("create_notification","totara_notification"),"aria-label":e.$str("create_notification_for_event","totara_notification",t.name)},on:{click:function(i){return e.$emit("create-custom-notification",{resolverClassName:t.class_name,scheduleTypes:t.valid_schedules,recipients:t.recipients,deliveryChannels:t.default_delivery_channels,additionalCriteriaComponent:t.additional_criteria_component})}}}):e._e()]]}}],null,!0)})],1)})),1)])}),[],!1,null,null,null);w($),$.options.__hasBlocks={script:!0,template:!0};const O=$.exports},MMW8:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>y});var t=n("bNBy"),a=n.n(t),r=n("j/Uj"),l=n.n(r),d=n("RJ4J"),o=n.n(d),s=n("Lo/q"),c=n.n(s),u=n("BDBh"),m=n.n(u),v=n("oT0J"),_=n.n(v),k=n("Gies"),p=n.n(k);const f={components:{Collapsible:a(),CollapsibleGroupToggle:l(),Cell:o(),HeaderCell:c(),Table:m(),ToggleSwitch:_(),NotifiableEventAction:p()},props:{eventResolvers:{type:Array,default:()=>[],validator:e=>e.every((e=>"component"in e&&"plugin_name"in e&&"resolvers"in e))}},data:()=>({expanded:{}}),created(){const e={};this.eventResolvers.forEach((i=>e[i.plugin_name]=!1)),this.expanded=e},methods:{toggleEnabled(e,i){this.$emit("toggle-enabled",{userId:i.user_id,resolverClassname:i.resolver_class_name,isEnabled:e,userPreferenceId:i.user_preference_id})},display_delivery_channels:e=>e.filter((({is_enabled:e})=>e)).map((({label:e})=>e)).join("; "),updateDeliveryPreference(e){this.$emit("update-delivery-preferences",{resolverClassName:e.resolver_class_name,resolverLabel:e.name,defaultDeliveryChannels:e.delivery_channels,OverrideDeliveryChannels:e.overridden_delivery_channels,userPreferenceId:e.user_preference_id})}}},b=function(e){e.options.__langStrings={totara_notification:["delivery_channels","enabled","enable_status","notifiable_events"],core:["actions"]}};var N=(0,n("wWJ2").Z)(f,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("div",[n("CollapsibleGroupToggle",{attrs:{"align-end":!1,transparent:!1},model:{value:e.expanded,callback:function(i){e.expanded=i},expression:"expanded"}}),e._v(" "),n("div",{staticClass:"tui-userPreferencesTable"},e._l(e.eventResolvers,(function(i){return n("Collapsible",{key:i.plugin_name,attrs:{label:i.plugin_name,"indent-contents":!0},model:{value:e.expanded[i.plugin_name],callback:function(n){e.$set(e.expanded,i.plugin_name,n)},expression:"expanded[eventResolver.plugin_name]"}},[n("Table",{attrs:{data:i.resolvers,"expandable-rows":!0,"hover-off":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[n("HeaderCell",{attrs:{size:"4"}},[e._v("\n            "+e._s(e.$str("notifiable_events","totara_notification"))+"\n          ")]),e._v(" "),n("HeaderCell",{attrs:{size:"4"}},[e._v("\n            "+e._s(e.$str("delivery_channels","totara_notification"))+"\n          ")]),e._v(" "),n("HeaderCell",{attrs:{align:"start",size:"2"}},[e._v("\n            "+e._s(e.$str("enabled","totara_notification"))+"\n          ")]),e._v(" "),n("HeaderCell",[n("span",{staticClass:"sr-only"},[e._v("\n              "+e._s(e.$str("actions","core"))+"\n            ")])])]},proxy:!0},{key:"row",fn:function(i){var t=i.row;return[n("Cell",{attrs:{size:"4"}},[e._v("\n            "+e._s(t.name)+"\n          ")]),e._v(" "),n("Cell",{attrs:{size:"4"}},[e._v("\n            "+e._s(e.display_delivery_channels(t.delivery_channels))+"\n          ")]),e._v(" "),n("Cell",{attrs:{align:"start",size:"2"}},[n("ToggleSwitch",{attrs:{"aria-label":e.$str("enable_status","totara_notification",t.name),value:t.enabled,"toggle-only":!0},on:{input:function(i){return e.toggleEnabled(i,t)}}})],1),e._v(" "),n("Cell",{attrs:{align:"end",size:"1"}},[n("NotifiableEventAction",{attrs:{"resolver-name":t.name,"show-create-notification-option":!1,"show-delivery-preference-option":!0,"can-audit":!1,"can-manage":!0},on:{"update-delivery-preferences":function(i){return e.updateDeliveryPreference(t)}}})],1)]}}],null,!0)})],1)})),1)],1)}),[],!1,null,null,null);b(N),N.options.__hasBlocks={script:!0,template:!0};const y=N.exports},aGKH:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>s});var t=n("ijCJ"),a=n.n(t);const r=tui.require("totara_notification/components/Notifications");var l=n.n(r);const d={components:{Layout:a(),Notifications:l()},props:{canChangeDeliveryChannelDefaults:{type:Boolean},contextId:{type:[Number,String],required:!0},extendedContext:{type:Object,default:()=>({}),validate:e=>"component"in e&&"area"in e&&"itemId"in e&&(""===e.component&&""===e.area&&0==e.itemId||""!==e.component&&""!==e.area&&0!=e.itemId)},preferredEditorFormat:{type:[Number,String]},title:{type:String,required:!0}}};var o=(0,n("wWJ2").Z)(d,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("Layout",{staticClass:"tui-notificationPage",attrs:{title:e.title},scopedSlots:e._u([{key:"content",fn:function(){return[n("Notifications",{attrs:{"can-change-delivery-channel-defaults":e.canChangeDeliveryChannelDefaults,"context-id":e.contextId,"extended-context":e.extendedContext,"preferred-editor-format":e.preferredEditorFormat}})]},proxy:!0}])})}),[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0};const s=o.exports},"/koY":(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>b});var t=n("ijCJ"),a=n.n(t);const r=tui.require("totara_notification/components/table/UserPreferencesTable");var l=n.n(r),d=n("x7Rm"),o=n("EJOt"),s=n.n(o),c=n("Akzt"),u=n.n(c);const m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_update_notifiable_event_user_preference"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"is_enabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_notification_extended_context_input"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_preference_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notifiable_event_user_preference"},name:{kind:"Name",value:"totara_notification_update_notifiable_event_user_preference"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"is_enabled"},value:{kind:"Variable",name:{kind:"Name",value:"is_enabled"}}},{kind:"Argument",name:{kind:"Name",value:"user_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_id"}}},{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}},{kind:"Argument",name:{kind:"Name",value:"user_preference_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_preference_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_preference_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"delivery_channels"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_sub_delivery_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_order"},arguments:[],directives:[]}]}}]}}]}}]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_update_user_delivery_channels"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"delivery_channels"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_notification_extended_context_input"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_preference_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notifiable_event_user_preference"},name:{kind:"Name",value:"totara_notification_update_notifiable_event_user_delivery_channels"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"delivery_channels"}}},{kind:"Argument",name:{kind:"Name",value:"user_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_id"}}},{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}},{kind:"Argument",name:{kind:"Name",value:"user_preference_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_preference_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_preference_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"delivery_channels"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_sub_delivery_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_order"},arguments:[],directives:[]}]}}]}}]}}]},_={components:{Layout:a(),UserPreferencesTable:l(),ModalPresenter:s(),DeliveryPreferenceModal:u()},props:{resolverPreferences:{type:Array,required:!0},extendedContext:{type:Object,default:()=>({}),validate:e=>"component"in e&&"area"in e&&"itemId"in e&&(""===e.component&&""===e.area&&0==e.itemId||""!==e.component&&""!==e.area&&0!=e.itemId)}},data(){return{userPreferencesList:this.resolverPreferences,groupedPreferences:[],deliveryPreferenceModal:{open:!1},targetResolverClassName:null,targetResolverLabel:null,targetDefaultDeliveryChannels:null,userPreferenceId:null,OverrideDeliveryChannels:!1,showDeliveryChannelsOverride:!0,preferences:this.resolverPreferences}},computed:{groupPreferences(){let e={};return this.userPreferencesList.forEach((i=>{const{component:n,plugin_name:t}=i;e[t]||(e[t]={component:n,plugin_name:t,resolvers:[]}),e[t].resolvers.push(i)})),Object.values(e)}},watch:{groupPreferences:{immediate:!0,deep:!0,handler(e){this.groupedPreferences=e}}},methods:{resetState(){this.targetResolverClassName=null,this.targetDefaultDeliveryChannels=null,this.targetResolverLabel=null},async saveUserPreference({userId:e,resolverClassname:i,isEnabled:n,userPreferenceId:t}){try{const{data:a}=await this.$apollo.mutate({mutation:m,variables:{user_id:e,resolver_class_name:i,extended_context:this.extendedContext,is_enabled:n,user_preference_id:t}});this.updateResolverPreferenceList(a.notifiable_event_user_preference)}catch(e){await(0,d.notify)({type:"error",message:this.$str("error_user_preference_permission","totara_notification")})}},updateResolverPreferenceList(e){let i=Object.assign([],this.groupedPreferences).find((i=>i.plugin_name===e.plugin_name));i.resolvers=i.resolvers.map((i=>i.resolver_class_name===e.resolver_class_name&&i.component===e.component&&i.name===e.name&&i.plugin_name===e.plugin_name?e:i))},handleUpdateDeliveryPreferences({resolverClassName:e,resolverLabel:i,defaultDeliveryChannels:n,OverrideDeliveryChannels:t,userPreferenceId:a}){this.targetResolverClassName=e,this.targetResolverLabel=i,this.targetDefaultDeliveryChannels=n,this.OverrideDeliveryChannels=t,this.userPreferenceId=a,this.deliveryPreferenceModal.open=!0},async handleNotificationPreferenceSubmit({delivery_channels:e,resolver_class_name:i},n){let t=n?e:null;await this.$apollo.mutate({mutation:v,variables:{resolver_class_name:i,extended_context:this.extendedContext,delivery_channels:t,user_preference_id:this.userPreferenceId},update:(e,{data:{notifiable_event_user_preference:i}})=>{let n=Object.assign([],this.groupedPreferences).find((e=>e.plugin_name===i.plugin_name));n.resolvers=n.resolvers.map((e=>e.resolver_class_name===i.resolver_class_name&&e.name===i.name?i:e))}}),this.deliveryPreferenceModal.open=!1}}},k=_,p=function(e){e.options.__langStrings={totara_notification:["error_user_preference_permission","user_preferences_page_title","delivery_preferences"]}};var f=(0,n("wWJ2").Z)(k,(function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("Layout",{staticClass:"tui-userPreferences",attrs:{title:e.$str("user_preferences_page_title","totara_notification"),loading:e.$apollo.loading},scopedSlots:e._u([e.$apollo.loading?null:{key:"content",fn:function(){return[n("UserPreferencesTable",{staticClass:"tui-userPreferences__table",attrs:{"event-resolvers":e.groupedPreferences},on:{"toggle-enabled":e.saveUserPreference,"update-delivery-preferences":e.handleUpdateDeliveryPreferences}}),e._v(" "),n("ModalPresenter",{attrs:{open:e.deliveryPreferenceModal.open},on:{"request-close":function(i){e.deliveryPreferenceModal.open=!1},"close-complete":e.resetState}},[n("DeliveryPreferenceModal",{attrs:{title:e.$str("delivery_preferences","totara_notification"),"resolver-class-name":e.targetResolverClassName,"resolver-label":e.targetResolverLabel,"default-delivery-channels":e.targetDefaultDeliveryChannels,"show-override":e.showDeliveryChannelsOverride,"initial-override-status":e.OverrideDeliveryChannels},on:{"form-submit":e.handleNotificationPreferenceSubmit}})],1)]},proxy:!0}],null,!0)})}),[],!1,null,null,null);p(f),f.options.__hasBlocks={script:!0,template:!0};const b=f.exports},cBHR:(e,i,n)=>{"use strict";n.d(i,{AG:()=>o,Fp:()=>a,_K:()=>l,ku:()=>r,ov:()=>d});const t=["subject","body","body_format","title","schedule_type","schedule_offset","subject_format","recipients","enabled","forced_delivery_channels"],a={ON_EVENT:"ON_EVENT",BEFORE_EVENT:"BEFORE_EVENT",AFTER_EVENT:"AFTER_EVENT"};function r(e=[]){const i=e.concat(t);return e=>0===i.filter((i=>!(i in e))).length}function l(){return e=>e.every((e=>"class_name"in e&&"name"in e))}function d(){return e=>e.every((e=>"component"in e&&"label"in e&&"is_enabled"in e&&"is_sub_delivery_channel"in e&&"parent_component"in e))}function o(e={}){const i={additional_criteria:JSON.stringify({}),subject:"",body:"",body_format:null,subject_format:null,title:null,schedule_type:a.ON_EVENT,schedule_offset:null,recipients:null,enabled:!1,forced_delivery_channels:[]};return()=>Object.assign({},i,e)}},wWJ2:(e,i,n)=>{"use strict";function t(e,i,n,t,a,r,l,d){var o,s="function"==typeof e?e.options:e;if(i&&(s.render=i,s.staticRenderFns=n,s._compiled=!0),t&&(s.functional=!0),r&&(s._scopeId="data-v-"+r),l?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(l)},s._ssrRegister=o):a&&(o=d?function(){a.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:a),o)if(s.functional){s._injectStyles=o;var c=s.render;s.render=function(e,i){return o.call(i),c(e,i)}}else{var u=s.beforeCreate;s.beforeCreate=u?[].concat(u,o):[o]}return{exports:e,options:s}}n.d(i,{Z:()=>t})},Gies:e=>{"use strict";e.exports=tui.require("totara_notification/components/action/NotifiableEventAction")},Akzt:e=>{"use strict";e.exports=tui.require("totara_notification/components/modal/DeliveryPreferenceModal")},eHBv:e=>{"use strict";e.exports=tui.require("tui/components/buttons/ButtonGroup")},"1+j7":e=>{"use strict";e.exports=tui.require("tui/components/buttons/ButtonIcon")},IpiT:e=>{"use strict";e.exports=tui.require("tui/components/buttons/Button")},ddQy:e=>{"use strict";e.exports=tui.require("tui/components/buttons/Cancel")},gu2O:e=>{"use strict";e.exports=tui.require("tui/components/buttons/InfoIconButton")},uJnX:e=>{"use strict";e.exports=tui.require("tui/components/buttons/MoreIcon")},"j/Uj":e=>{"use strict";e.exports=tui.require("tui/components/collapsible/CollapsibleGroupToggle")},bNBy:e=>{"use strict";e.exports=tui.require("tui/components/collapsible/Collapsible")},RJ4J:e=>{"use strict";e.exports=tui.require("tui/components/datatable/Cell")},"Lo/q":e=>{"use strict";e.exports=tui.require("tui/components/datatable/HeaderCell")},BDBh:e=>{"use strict";e.exports=tui.require("tui/components/datatable/Table")},"6e83":e=>{"use strict";e.exports=tui.require("tui/components/dropdown/DropdownItem")},"3NWB":e=>{"use strict";e.exports=tui.require("tui/components/dropdown/Dropdown")},hAGe:e=>{"use strict";e.exports=tui.require("tui/components/form/Checkbox")},"2XTD":e=>{"use strict";e.exports=tui.require("tui/components/form/FormRow")},ijCJ:e=>{"use strict";e.exports=tui.require("tui/components/layouts/LayoutOneColumn")},GLpC:e=>{"use strict";e.exports=tui.require("tui/components/modal/ModalContent")},EJOt:e=>{"use strict";e.exports=tui.require("tui/components/modal/ModalPresenter")},IACo:e=>{"use strict";e.exports=tui.require("tui/components/modal/Modal")},EHV6:e=>{"use strict";e.exports=tui.require("tui/components/popover/Popover")},oT0J:e=>{"use strict";e.exports=tui.require("tui/components/toggle/ToggleSwitch")},x7Rm:e=>{"use strict";e.exports=tui.require("tui/notifications")}},i={};function n(t){var a=i[t];if(void 0!==a)return a.exports;var r=i[t]={exports:{}};return e[t](r,r.exports,n),r.exports}n.n=e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return n.d(i,{a:i}),i},n.d=(e,i)=>{for(var t in i)n.o(i,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:i[t]})},n.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("totara_notification")?console.warn('[tui bundle] The bundle "totara_notification" is already loaded, skipping initialisation.'):(tui._bundle.register("totara_notification"),tui._bundle.addModulesFromContext("totara_notification/components",n("VV44")),tui._bundle.addModulesFromContext("totara_notification/pages",n("yYpj")))}()})();